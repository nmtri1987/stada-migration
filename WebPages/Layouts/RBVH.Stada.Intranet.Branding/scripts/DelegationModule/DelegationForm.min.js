function ValidateBeforeDelegate(){var n=delegationFormInstance.IsValidForm();return n&&$(".se-pre-con").fadeIn(0),n}function validateBeforeSearch(){var n=delegationFormInstance.IsValidSearchingInformation();return n==!1?$(".se-pre-con").fadeOut(0):$(".se-pre-con").fadeIn(0),n}RBVH.Stada.javascript.common.NamespaceManager.register("RBVH.Stada.WebPages.pages");RBVH.Stada.WebPages.pages.DelegationForm=function(n){this.Settings={Controls:{},Today:{},Modules:[]};$.extend(!0,this.Settings,n);this.Initialize()};RBVH.Stada.WebPages.pages.DelegationForm.prototype={Initialize:function(){var n=this;$(document).ready(function(){SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){n.InitControls();n.EventsRegister();n.ShowErrorMessage()})})},InitControls:function(){var n=this,t,i,r;if(n.Settings.Modules=[],t=$(n.Settings.Controls.ddlModuleSelector+" option"),t)for(i=0;i<t.length;i++)r=$(t[i]).val(),r&&r!="All"&&n.Settings.Modules.push(r);n.PopulateData();$(n.Settings.Controls.ddlModuleSelector).select2({placeholder:n.Settings.Resources.DelegationModuleSelectText,width:"80%"});$(n.Settings.Controls.toEmployeeSelector).select2({placeholder:n.Settings.Resources.DelegationModuleSelectText,width:"80%"});$(n.Settings.Controls.fromDateSelector).keydown(function(n){return n.preventDefault(),!1});$(n.Settings.Controls.toDateSelector).keydown(function(n){return n.preventDefault(),!1})},FilterEmployee:function(n){var t=this,u,v,s,f,y,i,h,e,c,o,p,w,l,a,r;if($(t.Settings.Controls.toEmployeeSelector).val([]).trigger("change.select2"),u=$(t.Settings.Controls.fromEmployeeSelector+" option:selected"),u&&(v=[],s=$(u).attr("delegatedemployeepositions"),s&&s!=""&&(v=JSON.parse(s)),f=parseInt($(u).attr("employeeinfodepartment")),f=isNaN(f)?0:f,y=parseInt($(u).attr("value")),i=$(t.Settings.Controls.toEmployeeSelector+" option"),i)){for(h=0;h<i.length;h++)$(i[h]).hideOption();for(e=0;e<i.length;e++)c=$(i[e]),o=parseInt(c.attr("employeeinfodepartment")),o=isNaN(o)?0:o,p=parseInt(c.attr("position")),w=parseInt(c.attr("value")),t.FindObjectByValue(v,p)!=null&&o===f&&y!==w&&$(i[e]).showOption()}l=$(t.Settings.Controls.toEmployeeSelector+" option:not([disabled])");l&&l.length>0&&($(l[0]).removeAttr("disabled"),a=$(t.Settings.Controls.hdSelectedToEmployeeSelector).val(),a&&a!=""&&n==!0&&$(t.Settings.Controls.toEmployeeSelector).val(JSON.parse(a)).trigger("change.select2"));r=$(t.Settings.Controls.hdSelectedModulesSelector).val();r&&r!=""?r&&r!=""&&n==!0&&(t.ArraysEqual(t.Settings.Modules,JSON.parse(r))?($(t.Settings.Controls.ddlModuleSelector).val(["All"]).trigger("change.select2"),$(t.Settings.Controls.hdSelectedModulesSelector).val(JSON.stringify(t.Settings.Modules))):$(t.Settings.Controls.ddlModuleSelector).val(JSON.parse(r)).trigger("change.select2")):($(t.Settings.Controls.ddlModuleSelector).val(["All"]).trigger("change.select2"),$(t.Settings.Controls.hdSelectedModulesSelector).val(JSON.stringify(t.Settings.Modules)))},FindObjectByValue:function(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i].LookupId===t)return n[i];return null},PopulateData:function(){var t=this,n=new Date,i=new Date(n.getFullYear(),n.getMonth(),n.getDate());t.Settings.Today=i;t.FilterEmployee(!0)},EventsRegister:function(){var n=this;$(n.Settings.Controls.fromEmployeeSelector).change(function(){n.FilterEmployee(!1);n.DisableCheckboxes()});n.SetCheckAllCheckBox();$(n.Settings.Controls.btnCloseSelector).on("click",function(){$(".se-pre-con").fadeIn(0)});$(n.Settings.Controls.ddlModuleSelector).on("select2:select",function(t){var u="All",i=$(n.Settings.Controls.ddlModuleSelector).val(),e=t.params.data,f,r;if(e.id===u)i=[u],$(n.Settings.Controls.hdSelectedModulesSelector).val(JSON.stringify(n.Settings.Modules));else{if($.inArray(u,i)>-1){for(f=[],r=0;r<i.length;r++)i[r]!=u&&f.push(i[r]);i=f}$(n.Settings.Controls.hdSelectedModulesSelector).val(JSON.stringify(i))}$(n.Settings.Controls.ddlModuleSelector).val(i).trigger("change.select2")});$(n.Settings.Controls.ddlModuleSelector).on("select2:unselect",function(){var t=$(n.Settings.Controls.ddlModuleSelector).val();$(n.Settings.Controls.hdSelectedModulesSelector).val(JSON.stringify(t))});$(n.Settings.Controls.toEmployeeSelector).on("select2:select",function(){var t=$(n.Settings.Controls.toEmployeeSelector).val();$(n.Settings.Controls.hdSelectedToEmployeeSelector).val(JSON.stringify(t))});$(n.Settings.Controls.toEmployeeSelector).on("select2:unselect",function(){var t=$(n.Settings.Controls.toEmployeeSelector).val();$(n.Settings.Controls.hdSelectedToEmployeeSelector).val(JSON.stringify(t))})},SetCheckAllCheckBox:function(){var t=$("span[class='select-all-task'] input[type='checkbox']"),n=$("span[class='select-task'] input[type='checkbox']");t.change(function(){t.is(":checked")==!0?n.prop("checked",!0):n.removeAttr("checked")});n.change(function(){var i;t.removeAttr("checked");var r=0,u=0,f=n.length;if(n)for(i=0;i<f;i++)$(n[i]).is(":checked")==!0?r++:u++;r>0&&r===f&&t.prop("checked",!0);u>0&&u===f&&t.removeAttr("checked")})},DisableCheckboxes:function(){var n=this;$("span[class='select-task'] input[type='checkbox']").removeAttr("checked");$("span[class='select-task'] input[type='checkbox']").attr("disabled","true");$("span[class='select-all-task'] input[type='checkbox']").removeAttr("checked");$("span[class='select-all-task'] input[type='checkbox']").attr("disabled","true")},ShowErrorMessage:function(){try{var t=this,n=t.Settings.Controls.hdErrorMessageSelector;$(n).val()!=""&&alert($(n).val())}catch(i){}},IsValidForm:function(){var n=this,t=!1,u=n.ValidateRequiredField(),i,r;return u===!0&&(i=n.IsFromDateValid(),r=n.IsToDateValid(),i===!0&&r===!0&&(t=!0)),t},IsFromDateValid:function(){var n=this,i=0,r=$(n.Settings.Controls.fromDateSelector).val(),t=Functions.parseVietNameseDate(r);return t?(fromDateOnly=new Date(t.getFullYear(),t.getMonth(),t.getDate()),fromDateOnly<n.Settings.Today?($(n.Settings.Controls.dtFromDateSelector_Error).html(n.Settings.Resources.FromDateErrorMessage).show(),i++):$(n.Settings.Controls.dtFromDateSelector_Error).html("").hide()):i++,i==0},IsToDateValid:function(){var n=this,r=0,u=$(n.Settings.Controls.fromDateSelector).val(),f=$(n.Settings.Controls.toDateSelector).val(),t=Functions.parseVietNameseDate(u),i=Functions.parseVietNameseDate(f);return t&&i?(fromDateOnly=new Date(t.getFullYear(),t.getMonth(),t.getDate()),toDateOnly=new Date(i.getFullYear(),i.getMonth(),i.getDate()),toDateOnly<n.Settings.Today||fromDateOnly<n.Settings.Today||fromDateOnly>toDateOnly?($(n.Settings.Controls.dtToDateSelector_Error).html(n.Settings.Resources.ToDateErrorMessage).show(),r++):$(n.Settings.Controls.dtToDateSelector_Error).html("").hide()):r++,r==0},IsFromEmployeeEmpty:function(){var n=this,t=0;return t+=n.ValidateEmptyField($(n.Settings.Controls.fromEmployeeSelector+" option:selected").val(),n.Settings.Controls.ddlFromEmployeeSelector_Error,n.Settings.Resources.CantLeaveTheBlank)==!0?0:1,!(t==0)},IsToEmployeeEmpty:function(){var n=this,t=0;return t+=n.ValidateEmptyField($(n.Settings.Controls.toEmployeeSelector+" option:selected").val(),n.Settings.Controls.ddlToEmployeeSelector_Error,n.Settings.Resources.CantLeaveTheBlank)==!0?0:1,!(t==0)},ValidateRequiredField:function(){$("span[class='ms-formvalidation ms-csrformvalidation']").html("");var n=this,t=0;return t+=n.ValidateEmptyField($(n.Settings.Controls.fromDateSelector).val(),n.Settings.Controls.dtFromDateSelector_Error,n.Settings.Resources.CantLeaveTheBlank)==!0?0:1,t+=n.ValidateEmptyField($(n.Settings.Controls.toDateSelector).val(),n.Settings.Controls.dtToDateSelector_Error,n.Settings.Resources.CantLeaveTheBlank)==!0?0:1,t+=n.ValidateEmptyField($(n.Settings.Controls.ddlModuleSelector).val(),n.Settings.Controls.ddlModuleSelector_Error,n.Settings.Resources.CantLeaveTheBlank)==!0?0:1,t+=n.ValidateEmptyField($(n.Settings.Controls.fromEmployeeSelector+" option:selected").val(),n.Settings.Controls.ddlFromEmployeeSelector_Error,n.Settings.Resources.CantLeaveTheBlank)==!0?0:1,t+=n.ValidateEmptyField($(n.Settings.Controls.toEmployeeSelector+" option:selected:not([disabled])").val(),n.Settings.Controls.ddlToEmployeeSelector_Error,n.Settings.Resources.CantLeaveTheBlank)==!0?0:1,t==0},ValidateEmptyField:function(n,t,i){return n&&n!=""?($(t).hide(),!0):($(t).html(i),$(t).show(),!1)},IsValidSearchingInformation:function(){var n=this,t;return $(n.Settings.Controls.ddlModuleSelector_Error).html("").hide(),t=0,t+=n.ValidateEmptyField($(n.Settings.Controls.ddlModuleSelector).val(),n.Settings.Controls.ddlModuleSelector_Error,n.Settings.Resources.CantLeaveTheBlank)==!0?0:1,t===0},ArraysEqual:function(n,t){if(n.length!==t.length)return!1;for(var i=n.length;i--;)if(n[i]!==t[i])return!1;return!0}};