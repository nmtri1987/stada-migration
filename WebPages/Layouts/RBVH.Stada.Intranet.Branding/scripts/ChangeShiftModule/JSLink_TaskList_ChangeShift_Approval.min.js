function openDialogBox(n){var t={url:n,width:800,height:400,showClose:!0,allowMaximize:!1,title:ChangeShiftApprovalTaskConfig.ViewDetail};SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",t)}function PostRender(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){ChangeShiftApprovalTaskConfig.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(ChangeShiftApprovalTaskConfig.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+ChangeShiftApprovalTaskConfig.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(ChangeShiftApprovalTaskConfig.ListResourceFileName,"Res",OnListResourcesReady);SP.SOD.registerSod(ChangeShiftApprovalTaskConfig.PageResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+ChangeShiftApprovalTaskConfig.PageResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(ChangeShiftApprovalTaskConfig.PageResourceFileName,"Res",OnPageResourcesReady)},"strings.js");$(".approve-request").click(function(){$(this).prop("disabled",!0);DoApprove($(this).attr("data-id"))});$(".reject-request").click(function(){$(this).prop("disabled",!0);DoReject($(this).attr("data-id"))});$(".viewdetailapproval").click(function(){url=$(this).attr("data-url");openDialogBox(url)})}function OnListResourcesReady(){$("#requesterTH").text(Res.changeShiftList_Requester);$("#fromshift").text(Res.changeShiftList_FromShift);$("#toshift").text(Res.changeShiftList_ToShift);$("#from").text(Res.changeShiftList_FromDate);$("#to").text(Res.changeShiftList_ToDate);$("#created").text(Res.createdDate);$("#reason").text(Res.changeShiftManagement_Reason);$("#actionTH").text(Res.changeShiftManagement_ViewTitle);$("#comment").text(Res.commonComment);$(".label-success").text(Res.approvalStatus_Approved);$(".label-default").text(Res.approvalStatus_InProgress);$(".label-warning").text(Res.approvalStatus_Cancelled);$(".label-danger").text(Res.approvalStatus_Rejected);$(".cancel-request").text(Res.changeShiftManagement_CancelRequest)}function OnPageResourcesReady(){$(".approve-request").text(Res.approveButton);$(".reject-request").text(Res.rejectButton);ChangeShiftApprovalTaskConfig.ViewDetail=Res.viewDetail}function pad(n){return n<10?"0"+n:n}function CustomItem(n){var r="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",u="<td>"+n.CurrentItem.FromShift[0].lookupValue+"<\/td>",f="<td>"+n.CurrentItem.ToShift[0].lookupValue+"<\/td>",e="<td>"+n.CurrentItem.CommonFrom+"<\/td>",o="<td>"+n.CurrentItem.To+"<\/td>",s="<td>"+n.CurrentItem.Created+"<\/td>",h="<td>"+n.CurrentItem.Reason+"<\/td>",c='<td><input type="text" class="form-control comment'+n.CurrentItem.ID+'" ><\/input><\/td>',w=n.CurrentItem.ApprovalStatus,t=window.location.href.split("#")[0];t=Functions.removeParam("lang",t);t+="#tab2";t=encodeURIComponent(t);var l='<span><a data-url="/Lists/ChangeShiftManagement/DispForm.aspx?ID='+n.CurrentItem.ID+"&TextOnly=true&Source="+t+'"   class="table-action viewdetailapproval"><i class="fa fa-eye" aria-hidden="true"><\/i><\/a><\/span>',a="<td>"+l+"<\/td>",i="",v="<button type='button' class='btn btn-success btn-sm approve-request' data-approvalStatus='"+n.CurrentItem.ApprovalStatus+"'  data-id='"+n.CurrentItem.ID+"' data-emp-id='"+n.CurrentItem.Requester[0].lookupId+"' "+i+">Approve<\/button>",y="<button type='button' class='btn btn-default btn-sm reject-request'  data-id='"+n.CurrentItem.ID+"' "+i+">Reject<\/button>",p="<td>"+v+"   "+y+"<td>";return"<tr>"+r+u+f+e+o+s+h+a+c+p+"<\/tr>"}function pagingControl(n){return ViewUtilities.Paging.InstanceHtml(n)}function DoApprove(n){var t={},i;t.Id=n;t.Comment=$(".comment"+n).val();t.ApproverName=_rbvhContext.EmployeeInfo.FullName;t.ApproverId=_rbvhContext.EmployeeInfo.ADAccount.ID;i=RBVH.Stada.WebPages.Utilities.String.format(ChangeShiftApprovalTaskConfig.ApproveRequest,location.host);$.ajax({type:"POST",url:i,data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(n){n.Code===2&&alert(n.Message);Redirect()})}function DoReject(n){var t={},i;t.Id=n;t.Comment=$(".comment"+n).val();t.ApproverName=_rbvhContext.EmployeeInfo.FullName;t.ApproverId=_rbvhContext.EmployeeInfo.ADAccount.ID;i=RBVH.Stada.WebPages.Utilities.String.format(ChangeShiftApprovalTaskConfig.RejectRequest,location.host);$.ajax({type:"POST",url:i,data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(n){n.Code===3&&alert(n.Message);Redirect()})}function Redirect(){var n=Functions.getParameterByName("Source");n?Functions.redirectToSource():window.location.reload()}var ChangeShiftApprovalTaskConfig={ChangeShiftManagement_Requester:"Requester",ChangeShiftManagement_FromShift:"FromShift",ChangeShiftManagement_ToShift:"ToShift",ChangeShiftManagement_From:"From",ChangeShiftManagement_To:"To",ChangeShiftManagement_Created:"Created",ChangeShiftManagement_Reason:"Reason",Comment:"Comment",ItemID:"",ApprovalStatus:"",IsManager:!1,ChangeShiftManagement_ViewTitle:"View",ApproveRequest:"//{0}/_vti_bin/Services/ChangeShiftManagement/ChangeShiftManagementService.svc/Approve",RejectRequest:"//{0}/_vti_bin/Services/ChangeShiftManagement/ChangeShiftManagementService.svc/Reject",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Locale:"",ViewDetail:"View item detail"};(function(){var n={};n.Templates={};n.Templates.Item=CustomItem;n.OnPreRender=function(){$(".ms-menutoolbar").hide()};n.BaseViewID=3;n.ListTemplateType=10011;n.OnPostRender=PostRender;n.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='requesterTH'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_Requester+"<\/th><th id='fromshift'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_FromShift+"<\/th><th id='toshift'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_ToShift+"<\/th><th id='from'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_From+"<\/th><th id='to'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_To+"<\/th><th id='created'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_Created+"<\/th><th id='reason'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_Reason+"<\/th><th id='actionTH'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_ViewTitle+"<\/th><th id='comment'>"+ChangeShiftApprovalTaskConfig.Comment+"<\/th><th><\/th><\/tr><\/thead><tbody>";n.Templates.Footer=pagingControl;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(n)})();