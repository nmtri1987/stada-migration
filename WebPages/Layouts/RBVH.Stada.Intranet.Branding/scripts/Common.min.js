function updateUrlParameter(n,t,i){var r=n.indexOf("#"),e=r===-1?"":n.substr(r),u,f;return n=r===-1?n:n.substr(0,r),u=new RegExp("([?&])"+t+"=.*?(&|$)","i"),f=n.indexOf("?")!==-1?"&":"?",i?n=n.match(u)?n.replace(u,"$1"+t+"="+i+"$2"):n+f+t+"="+i:(n=n.replace(new RegExp("([?&]?)"+t+"=[^&]*","i"),""),n.slice(-1)==="?"&&(n=n.slice(0,-1)),n.indexOf("?")===-1&&(n=n.replace(/&/,"?"))),n+e}function getQueryStringParameter(n){for(var i,r=document.URL.split("?")[1].split("&"),t=0;t<r.length;t=t+1)if(i=r[t].split("="),i[0]==n)return i[1]}function openModalDialog(n,t,i,r){var u={title:n,url:t,allowMaximize:!1,showMaximized:!1,showClose:!1,autoSize:!0,dialogReturnValueCallback:i,args:r};SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",u)}function HideLeftMenu(n){$.each(displayUrls,function(t,i){n.indexOf(i)>=0&&n.indexOf("_layouts")<0&&($("#ContentDiv .ms-core-listMenu-verticalBox").css("display","block"),$("#ctl00_PlaceHolderLeftNavBar_QuickLaunchNavigationManager").css("display","block"),$("#contentBox").css("margin-left",""),$("#contentRow").css("margin-left",""),$("#contentRow").css("margin-right",""),$(".ms-core-sideNavBox-removeLeftMargin").css("border","solid 1px #e6e0e0"))});$.each(DisplayFullUrls,function(t,i){n.toLowerCase().indexOf(i.toLowerCase())>=0&&($("#ctl00_PlaceHolderLeftNavBar_QuickLaunchNavigationManager").css("display","block"),$("#ContentDiv .ms-core-listMenu-verticalBox").css("display","block"),$("#contentBox").css("margin-left",""),$("#contentRow").css("margin-left",""),$("#contentRow").css("margin-right",""),$(".ms-core-sideNavBox-removeLeftMargin").css("border","none"))});$.each(DisplayGroup,function(t,i){n.toLowerCase().indexOf(i.toLowerCase())>=0&&($("#ctl00_PlaceHolderLeftNavBar_QuickLaunchNavigationManager").css("display","none"),$("#ContentDiv .ms-core-listMenu-verticalBox").css("display","block"),$("#contentBox").css("margin-left",""),$("#contentRow").css("margin-left",""),$("#contentRow").css("margin-right",""),$(".ms-core-sideNavBox-removeLeftMargin").css("border","solid 1px #e6e0e0"))})}function ShowPolicyMenu(n){$(".default-leftmenu").hide();$(".ms-core-listMenu-verticalBox",".default-leftmenu").hide();n=n.toLowerCase();n.indexOf("/policies/pages/forms/")<0&&(n.indexOf("/policies/pages/")>=0||n.indexOf("/policies/sitepages/")>=0)&&($(".default-leftmenu").show(),$(".ms-core-listMenu-verticalBox",".default-leftmenu").show(),$("#contentRow").css("margin","0%"));n.indexOf("/sitepages/home.aspx")>0&&$("#contentRow").css("margin-left","2%")}function setNavigation(){var n=window.location.pathname;n=n.replace(/\/$/,"");n=decodeURIComponent(n);$("ul.nav li").each(function(){var t=$(this).find("a").attr("item-data");n.indexOf(t)>=0&&($(this).closest("li").css("background","rgb(226, 226, 226)"),setParent($(this)))})}function setParent(n){var t=n.parent().closest("li");t!=null&&t.length!=0&&(t.closest("li").css("background","rgb(226, 226, 226)"),setParent(t))}var Functions,ViewUtilities,DepartmentMenu,TopMenuModule,CalendarControl;typeof RBVH!="undefined"&&RBVH||(RBVH={});typeof RBVH.Stada!="undefined"&&RBVH.Stada||(RBVH.Stada={});typeof RBVH.Stada.javascript!="undefined"&&RBVH.Stada.javascript||(RBVH.Stada.javascript={});typeof RBVH.Stada.javascript.common!="undefined"&&RBVH.Stada.javascript.common||(RBVH.Stada.javascript.common={});RBVH.Stada.javascript.common.NamespaceManager={register:function(n){var t,i;for(n=n.split("."),window[n[0]]||(window[n[0]]={}),t=n[0],i=1;i<n.length;i++)t+="."+n[i],eval("if(typeof window."+t+"== 'undefined' || !window."+t+") window."+t+"={};")}};RBVH.Stada.javascript.common.NamespaceManager.register("RBVH.Stada.WebPages.Utilities");RBVH.Stada.WebPages.Utilities={GetValueByParam:function(n){for(var i,u=window.location.search.substring(1),r=u.split("&"),t=0;t<r.length;t++)if(i=r[t].split("="),i[0].toUpperCase()==n.toUpperCase())return i[1]},GetValueByParamURL:function(n,t){t||(t=window.location.href);n=n.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),i=r.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},UpdateQueryStringParameter:function(n,t,i){var r=new RegExp("([?&])"+t+"=.*?(&|$)","i"),u=n.indexOf("?")!==-1?"&":"?";return n.match(r)?n.replace(r,"$1"+t+"="+i+"$2"):n+u+t+"="+i},RegisterTabChangeEvent:function(){$('a[data-toggle="tab"]').on("shown.bs.tab",function(n){var i=$(n.target).attr("href"),t,r;i=i.substr(1);t=window.location.href;r="";r=t.indexOf("?")>=0?"&":"?";t=t.indexOf("Tab=")>0?t.replace(/(Tab=)[^\&]+/,"$1"+i):t+r+"Tab="+i;history.pushState(null,"",t)})},String:{format:function(){for(var i,t=arguments[0],n=0;n<arguments.length-1;n++)i=new RegExp("\\{"+n+"\\}","gm"),t=t.replace(i,arguments[n+1]);return t},toJSDate:function(){var n=arguments[0];return n.substring(0,6)=="/Date("?new Date(parseInt(n.substring(6,n.length-2))):null},toISOString:function(){var n=arguments[0];return n instanceof Date?n.getUTCFullYear()+"-0"+(n.getUTCMonth()+1)+n.getUTCDate():""},toMomentDateTime:function(){var n=arguments[0];try{return moment(n).toDate()}catch(t){return n}},parseISOLocal:function(n){var t=n.split(/\D/);return new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5])},padDate:function(n){return n!==undefined&&n!==""?n<=9?"0"+n:n:""},toISOStringTZ:function(n){var t=(new Date).getTimezoneOffset()*6e4;return new Date(n.getTime()-t).toISOString().slice(0,-1)}},GUI:{generateItemStatus:function(n){var r=this,i="label label-default",t=n;return n==RBVH.Stada.WebPages.Constants.ApprovalStatus.En_US.Approved||n==RBVH.Stada.WebPages.Constants.ApprovalStatus.Vi_VN.Approved?(i="label label-success",_spPageContextInfo.currentLanguage=="1066"&&(t=RBVH.Stada.WebPages.Constants.ApprovalStatus.Vi_VN.Approved)):n==RBVH.Stada.WebPages.Constants.ApprovalStatus.En_US.Completed||n==RBVH.Stada.WebPages.Constants.ApprovalStatus.Vi_VN.Completed?(i="label label-success",_spPageContextInfo.currentLanguage=="1066"&&(t=RBVH.Stada.WebPages.Constants.ApprovalStatus.Vi_VN.Completed)):n==RBVH.Stada.WebPages.Constants.ApprovalStatus.En_US.Cancelled||n==RBVH.Stada.WebPages.Constants.ApprovalStatus.Vi_VN.Cancelled?(i="label label-warning",_spPageContextInfo.currentLanguage=="1066"&&(t=RBVH.Stada.WebPages.Constants.ApprovalStatus.Vi_VN.Cancelled)):n==RBVH.Stada.WebPages.Constants.ApprovalStatus.En_US.Rejected||n==RBVH.Stada.WebPages.Constants.ApprovalStatus.Vi_VN.Rejected?(i="label label-danger",_spPageContextInfo.currentLanguage=="1066"&&(t=RBVH.Stada.WebPages.Constants.ApprovalStatus.Vi_VN.Rejected)):(n==RBVH.Stada.WebPages.Constants.ApprovalStatus.En_US.InProcess||n==RBVH.Stada.WebPages.Constants.ApprovalStatus.Vi_VN.InProcess)&&(i="label label-primary",_spPageContextInfo.currentLanguage=="1066"&&(t=RBVH.Stada.WebPages.Constants.ApprovalStatus.Vi_VN.InProcess)),t=r.processApprovalStatus(t),$("<span />").attr("class",i).html(t)},showRequestExpired:function(n,t,i){$(t).html('<span class="label label-danger">'+i+"<\/span>");$(n).show()},processApprovalStatus:function(n){var i=n,t;try{t=n.split("/");t&&t.length>1&&(i=_spPageContextInfo.currentLanguage==1033?t[0]:t[1])}catch(r){}return i},showApprovalStatus:function(n){var i=this,t=$(n);t&&t.length>0&&$.each(t,function(n,t){var r=$(t).text(),u=i.processApprovalStatus(r);$(t).text(u)});$(n).show()}}};Functions={getDisplayName:function(n,t){for(var r="FieldName",i=0,u=n.ListSchema.Field.length;i<u;i++)n.ListSchema.Field[i].Name==t&&(r=n.ListSchema.Field[i].DisplayName);return r},getSPFieldRender:function(n,t){var i=n,r=n.ListSchema.Field.filter(function(n){return n.Name===t});return i.CurrentFieldSchema=r[0],i.CurrentFieldValue=n.ListData.Items[0][t],n.Templates.Fields[t](i)},getSPFieldValue:function(n,t){for(var r=!1,i=0;i<n.ListSchema.Field.length;i++)if(n.ListSchema.Field[i].Name===t){r=!0;break}return r===!0?n.ListData.Items[0][t]:""},getSPFieldLookupId:function(n,t){var r=n.ListData.Items[0],i=r[t].split("#");return i&&i.length>1?i[0]:""},getSPFieldLookupValue:function(n,t){var r=n.ListData.Items[0],i=r[t].split("#");return i&&i.length>1?i[i.length-1]:""},getSPFieldTitle:function(n,t){var i=n.ListSchema.Field.filter(function(n){return n.Name===t});return i[0].Title},populateApprovertoPeoplePicker:function(n,t,i){var r=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Employee/EmployeeService.svc/GetEmployeeApprovers/"+t,u=$.ajax({type:"GET",url:r,contentType:"application/json; charset=utf-8",dataType:"json"});u.then(function(t){t!=null&&(t!=undefined&&t.Approver1!=null&&n[0]!=null&&Functions.setUserFieldValue(n[0].InternalFieldName,n[0].FullLoginUserName,i),t.Approver2!=undefined&&t.Approver2!=null&&n[1]!=null&&Functions.setUserFieldValue(n[1].InternalFieldName,n[1].FullLoginUserName,i),t.Approver3!=undefined&&t.Approver3!=null&&n[2]!=null&&Functions.setUserFieldValue(n[2].InternalFieldName,n[2].FullLoginUserName,i))},function(){})},setUserFieldValue:function(n,t,i){var u=$("div[id ^='"+n+"']"),f=u.attr("id"),e=$("input[id ^='"+n+"']"),r;e.val(t);r=SPClientPeoplePicker.SPClientPeoplePickerDict[f];r.AddUnresolvedUserFromEditor(!0);i!=undefined&&i.css("pointer-events","none")},hideDatePartInDatetimePicker:function(n){$.each(n,function(n,t){$("table[id ^='"+t+"_'] input:first").hide();$("table[id ^='"+t+"_'] a").hide();$("table[id ^='"+t+"_'] td[class='ms-dttimeinput']").css("margin-left","-6px")})},hideDatePickerDisplayForm:function(n){var i=n.CurrentItem[n.CurrentFieldSchema.Name].trim(),t=i.split(" ");return t.length==3?t[1]+" "+t[2]:text},getParameterByName:function(n){url=window.location.href;n=n.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),t=i.exec(url);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null},getParamByName:function(n,t){n=n.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),i=r.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},loadDepartment:function(n,t,i,r){var u="",f,e;r==""?(u=Functions.getParameterByName("lang"),(u===undefined||u==null||u=="")&&(u="en-US")):u=r;f=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Department/DepartmentService.svc/GetDepartmentByIdLanguageCode/"+n+"/"+u;e=$.ajax({type:"GET",url:f,contentType:"application/json; charset=utf-8",dataType:"json"});e.then(function(n){n.DepartmentName!=undefined&&n.DepartmentName!=""?i!=""?$(t).html(i+": "+n.DepartmentName):$(t).html(n.DepartmentName):$(t).html("")},function(){})},isTwoApproverDifference:function(n,t,i,r,u,f){var e=$(n).val(),o=$(i).val(),s=!1,h,c;return e.length>0&&e!=""&&e!="[]"&&o.length>0&&o!=""&&o!="[]"?(h=$.parseJSON(e),c=$.parseJSON(o),h[0].Key===c[0].Key?(s=!1,$(u).html(t+", "+r+" "+f)):(s=!0,$(u).html(""))):s=!0,s},removeParam:function(n,t){var u=t.split("?")[0],f,i=[],e=t.indexOf("?")!==-1?t.split("?")[1]:"",r;if(e!==""){for(i=e.split("&"),r=i.length-1;r>=0;r-=1)f=i[r].split("=")[0],f===n&&i.splice(r,1);u=u+"?"+i.join("&")}return u},redirectToSource:function(n){var t="",i=Functions.getParameterByName("Source");t=i?i:n?n:"/";window.location.href=t},padDate:function(n){return n<10?"0"+n:n},parseDate:function(n){return new Date(n)},parseVietNameseDate:function(n){var t=n.split("/");return new Date(t[2],t[1]-1,t[0])},parseDateTimeToMMDDYYYY:function(n){var t=Functions.parseDate(n);return Functions.padDate(t.getMonth()*1+1)+"-"+Functions.padDate(t.getDate())+"-"+Functions.padDate(t.getFullYear())},parseVietnameseDateTimeToMMDDYYYY:function(n){var t=Functions.parseVietNameseDate(n);return Functions.padDate(t.getMonth()*1+1)+"-"+Functions.padDate(t.getDate())+"-"+Functions.padDate(t.getFullYear())},parseDateTimeToMMDDYYYY2:function(n){var t=Functions.parseDate(n);return Functions.padDate(t.getMonth()*1+1)+"/"+Functions.padDate(t.getDate())+"/"+Functions.padDate(t.getFullYear())},parseVietnameseDateTimeToDDMMYYYY2:function(n){return Functions.padDate(n.getDate())+"/"+Functions.padDate(n.getMonth()*1+1)+"/"+Functions.padDate(n.getFullYear())},removeInvalidValue:function(n){return n?n:""},isCurrentUserMemberOfGroup:function(n,t){function s(){for(var n=!1,i=f.getEnumerator(),r;i.moveNext();)if(r=i.get_current(),r.get_id()==e.get_id()){n=!0;break}t(n)}function h(){t(!1)}var i=new SP.ClientContext.get_current,o=i.get_web(),e=i.get_web().get_currentUser(),r,u,f;i.load(e);r=o.get_siteGroups();i.load(r);u=r.getByName(n);i.load(u);f=u.get_users();i.load(f);i.executeQueryAsync(s,h)},getAttachments:function(n,t){var r=_spPageContextInfo.webAbsoluteUrl,u=r+"/_api/web/lists/getbytitle('"+n+"')/items("+t+")/AttachmentFiles",i="";return $.ajax({url:u,type:"GET",headers:{ACCEPT:"application/json;odata=verbose"},async:!1,success:function(n){n&&n.d&&n.d.results[0]&&(i=encodeURI(n.d.results[0].ServerRelativeUrl))},error:function(){}}),i},parseComment:function(n){var t="",i;return n&&n.length>0&&(i=n.split("###"),i.forEach(function(n){var i=n.replace(/\:/,"___").split("___");t=t+"<b>"+i[0]+"<\/b>:"+i[1]+"<br />"})),t},generateApprovalHistoryTable:function(n,t,i,r){var e='<table class="table gridView" style="border-collapse: collapse;" border="1" rules="all" cellspacing="0">',u,o,f;if(n&&n.length>0)for(e+='<tr><th scope="col">'+t[0]+'<\/th><th scope="col">'+t[1]+'<\/th><th scope="col">'+t[2]+'<\/th><th scope="col">'+t[3]+"<\/th><\/tr>",u=0;u<n.length;u++)o="",n[u].Description&&(o=n[u].Description),f=i[0],n[u].TaskOutcome!=="Approved"&&(f=i[1]),f=RBVH.Stada.WebPages.Utilities.GUI.processApprovalStatus(f),e+='<tr><td style="width: 200px;">'+f+'<\/td><td style="width: 250px;">'+n[u].AssignedTo.FullName+'<\/td><td style="width: 200px;">'+n[u].Modified+"<\/td><td>"+o+"<\/td><\/tr>";else e+="<span>"+r+"<\/span>";return e+"<\/table>"},getConfigValue:function(n,t){var i=null;return n&&$.each(n,function(n,r){if(r.Key.trim().toLowerCase()===t.trim().toLowerCase()&&r.Value&&r.Value.length>0)return i=r.Value.trim(),!1}),i},getDisplayTextOfItemAll:function(n){return n==1033?"All":"Tất cả"}};ViewUtilities=ViewUtilities||{};ViewUtilities.Paging=ViewUtilities.Paging||{};ViewUtilities.Paging.InstanceHtml=function(n){var r=n.ListData.FirstRow,u=n.ListData.LastRow,f=n.ListData.NextHref,t="<div class='Paging'>",e,i;return n.ListData.PrevHref&&(e=r-RBVH.Stada.WebPages.Constants.PageLimit,i=RBVH.Stada.WebPages.Utilities.UpdateQueryStringParameter(n.ListData.PrevHref,"PageFirstRow",e)),u!=undefined?(t+=i?"<a class='ms-commandLink ms-promlink-button ms-promlink-button-enabled navigate-page' data-href='"+i+"' ><span class='ms-promlink-button-image'><img class='ms-promlink-button-left' src='/_layouts/15/images/spcommon.png?rev=40' /><\/span><\/a>":"",t+="<span class='ms-paging'><span class='First'>"+r+"<\/span> - <span class='Last'>"+u+"<\/span><\/span>",t+=f?"<a class='ms-commandLink ms-promlink-button ms-promlink-button-enabled navigate-page' data-href='"+f+"&PagingEnd' ><span class='ms-promlink-button-image'><img class='ms-promlink-button-right' src='/_layouts/15/images/spcommon.png?rev=40'/><\/span><\/a>":"",t+="<\/div>"):t="","<\/tbody><\/table><\/div>"+t};ViewUtilities.Paging.RemovePagingCurrentURL=function(){var n=window.location.search.replace("?",""),t="&PagingEnd&",i;return n.indexOf(t)>0&&(i=n.substring(n.indexOf(t)+t.length,n.length),n=i),n};ViewUtilities.Paging.RemovePagingURL=function(n){var t=n,i="&PagingEnd&",r;return t.indexOf(i)>0&&(r=t.substring(t.indexOf(i)+i.length,t.length),t="?"+r),t};$.fn.showOption=function(){return this.each(function(){var n,t;this.tagName=="OPTION"&&(n=this,$(this).parent().get(0).tagName=="SPAN"&&(t=$(this).parent().get(0),$(t).replaceWith(n),$(t).remove()),n.disabled=!1,$(n).show())}),this};$.fn.hideOption=function(){return this.each(function(){var n,t;this.tagName=="OPTION"&&(n=this,$(this).parent().get(0).tagName=="SPAN"?(t=$(this).parent().get(0),$(t).hide()):$(n).wrap("span").hide(),n.disabled=!0)}),this};$(document).ready(function(){$(".navigate-page").click(function(){var n=ViewUtilities.Paging.RemovePagingCurrentURL(),t=$(this).attr("data-href")+"&"+n+window.location.hash;window.location=t})});var displayUrls=["Overview","Leave","/Shift","Login","/Overtime","/LeaveManagement","/ChangeShiftManagement",],DisplayFullUrls=["/SitePages/Overview.aspx","/_layouts/15/people.aspx","/SitePages/OvertimeRequest.aspx","/SitePages/OvertimeApprovalList.aspx","/SitePages/OvertimeApproval.aspx","/SitePages/ShiftRequest.aspx","/SitePages/ShiftApprovalList.aspx","/SitePages/ShiftApproval.aspx","/SitePages/OvertimeManagement.aspx","/SitePages/LeaveOfAbsenceManagement.aspx","/SitePages/LeaveOfAbsenceManagementTaskList.aspx","/SitePages/ChangeShiftManagement.aspx","/SitePages/ChangeShiftManagementTaskList.aspx","/SitePages/TransportationManagement.aspx","/SitePages/TransportationManagementTaskList.aspx","/SitePages/LeaveRequest.aspx","/SitePages/FreightRequest.aspx","/SitePages/BusinessTripRequest.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/MyShiftTime.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/MyOvertime.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/LeaveManagement.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/SecurityLeaveManagement.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/LeaveManagementApprovalTask.aspx","/Lists/VehicleManagement/NewForm.aspx","/Lists/VehicleManagement/EditForm.aspx","/Lists/VehicleManagement/DispForm.aspx","/Lists/NotOvertimeManagement/NewForm.aspx","/Lists/ChangeShiftManagement/NewForm.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/OvertimeManagement/OvertimeManagementAdmin.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/OvertimeManagement/OvertimeManagementManager.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/OvertimeManagement/OvertimeManagementBOD.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/OvertimeManagement/OvertimeManagementMember.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/LeaveOfAbsenceManagement/LeaveOfAbsenceManagementAdmin.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/LeaveOfAbsenceManagement/LeaveOfAbsenceManagementBOD.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/LeaveOfAbsenceManagement/LeaveOfAbsenceManagementManager.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/LeaveOfAbsenceManagement/LeaveOfAbsenceManagementMember.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/ShiftManagement/ShiftManagementAdmin.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/ShiftManagement/ShiftManagementMember.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/ShiftManagement/ShiftManagementManager.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/ShiftManagement/ShiftManagementBOD.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/ChangeShiftManagement/ChangeShiftManagementMember.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/ChangeShiftManagement/ChangeShiftManagementAdmin.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/ChangeShiftManagement/ChangeShiftManagementManager.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/ChangeShiftManagement/ChangeShiftManagementBOD.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/TransportationManagement/TransportationManagementAdmin.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/TransportationManagement/TransportationManagementBOD.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/TransportationManagement/TransportationManagementManager.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/TransportationManagement/TransportationManagementMember.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/LeaveManagement/LeaveManagementAdmin.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/LeaveManagement/LeaveManagementBOD.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/LeaveManagement/LeaveManagementManager.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/LeaveManagement/LeaveManagementMember.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/RequestManagement/RequestList.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/RequestManagement/RequestForm.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/RecruitmentManagement/RecruitmentList.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/RecruitmentManagement/RecruitmentForm.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/FreightManagement/FreightManagementAdmin.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/FreightManagement/FreightManagementBOD.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/FreightManagement/FreightManagementManager.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/FreightManagement/FreightManagementMember.aspx","_layouts/15/RBVH.Stada.Intranet.WebPages/RequestForDiplomaSupplyManagement/RequestForDiplomaSupplyForm.aspx","_layouts/15/RBVH.Stada.Intranet.WebPages/RequestForDiplomaSupplyManagement/RequestForDiplomaSupplyList.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/BusinessTripManagement/BusinessTripManagementAdmin.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/BusinessTripManagement/BusinessTripManagementBOD.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/BusinessTripManagement/BusinessTripManagementManager.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/BusinessTripManagement/BusinessTripManagementMember.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/DelegationManagement/DelegationList.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/DelegationManagement/DelegationForm.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/LeaveOfAbsenceManagement/LeaveOfAbsenceApprovalDelegation.aspx","/_layouts/15/RBVH.Stada.Intranet.WebPages/ChangeShiftManagement/ChangeShiftApprovalDelegation.aspx",],DisplayGroup=["/_layouts/15/people.aspx",];$(document).ready(function(){var n=window.location.href;if(_spPageContextInfo&&(_spPageContextInfo.userId===1073741823||_spPageContextInfo.isSiteAdmin)){$("#ctl00_PlaceHolderLeftNavBar_QuickLaunchNavigationManager").css("display","none");n.indexOf("_layouts")<0?($("#contentRow").css("margin-left","2%"),$("#contentRow").css("margin-right","2%")):$("#contentRow").css("margin-left","10px");$("#contentBox").css("margin-left","0%");ShowPolicyMenu(n);return}$("#ContentDiv .ms-core-listMenu-verticalBox").css("display","none");$("#ctl00_PlaceHolderLeftNavBar_QuickLaunchNavigationManager").css("display","none");$("#contentBox").css("margin-left","0");n.indexOf("_layouts")<0?($("#contentRow").css("margin-left","2%"),$("#contentRow").css("margin-right","2%")):$("#contentRow").css("margin-left","10px");HideLeftMenu(n);ShowPolicyMenu(n)});DepartmentMenu={DepartmentList:"Departments",DepartmentNameField:"CommonName",VietnameseLanguageCultureId:1066,MenuClientId:"#DepartmentMenuul",renderDepartments:function(){var n=_spPageContextInfo.currentLanguage,t="?$orderby= "+DepartmentMenu.DepartmentNameField,i;n===DepartmentMenu.VietnameseLanguageCultureId&&(t="?$orderby= "+DepartmentMenu.DepartmentNameField+n);i=_spPageContextInfo.siteAbsoluteUrl+"/_api/web/lists/getByTitle('"+DepartmentMenu.DepartmentList+"')/items"+t;try{$.ajax({url:i,method:"GET",headers:{Accept:"application/json; odata=verbose"},cache:!0,async:!0,success:function(t){var i,f,o,r,e,u,s;if($(DepartmentMenu.MenuClientId).empty(),t&&t.d&&t.d.results&&(i=t.d.results,f=[],i&&i.length>0)){for(f=[],o=[],r=0;r<i.length;r++)(typeof i[r].IsVisible=="undefined"||i[r].IsVisible==!0)&&(i[r].UpperDepartmentId==null?f.push(i[r]):o.push(i[r]));for(e=0;e<f.length;e++)u=f[e],s=u.CommonName,n===DepartmentMenu.VietnameseLanguageCultureId&&(s=u[DepartmentMenu.DepartmentNameField+n]),$(DepartmentMenu.MenuClientId).append("<li id='Department"+u.Code+"li'><a href='/"+u.Code+"' item-data='/"+u.Code+"'>"+s+"<\/a><\/li>"),DepartmentMenu.renderSubDepartments(o,u,n)}}})}catch(r){}},renderSubDepartments:function(n,t,i){for(var u,f,o,e=[],r=0;r<n.length;r++)t.ID===n[r].UpperDepartmentId&&e.push(n[r]);for(u="",r=0;r<e.length;r++)f=e[r],o=f.CommonName,i===DepartmentMenu.VietnameseLanguageCultureId&&(o=f[DepartmentMenu.DepartmentNameField+i]),u+="<li><a href='/"+f.Code+"' item-data='/"+f.Code+"'> "+o+"<\/a><\/li>";u!==""&&(u="<ul class='dropdown-menu'>"+u+"<\/ul>",$("#Department"+t.Code+"li").addClass("dropdown-submenu"),$("#Department"+t.Code+"li").append(u))}};TopMenuModule=function(){var n=!0,t=!1,i=function(){t==!0?($("#topmenu_Admin a.dropdown-toggle").removeClass("disabled"),$("#topmenu_Admin span.caret").show(),n&&(n=!1,$("#topmenu_Admin a.dropdown-toggle").trigger("click"))):(n=!1,$("#topmenu_Admin a.dropdown-toggle").addClass("disabled"))},r=function(){n&&$.ajax({headers:{accept:"application/json; odata=verbose"},method:"GET",url:_spPageContextInfo.webAbsoluteUrl+"/_api/web/currentuser/groups",success:function(n){n&&n.d&&n.d.results&&n.d.results.forEach(function(n){n.Title.toUpperCase()=="SYSTEM ADMIN"&&(t=!0)});i(t)},error:function(n){i(!1);console.log(n.status)}})};return{ShowHideAdminMenu:r}}();RBVH.Stada.javascript.common.NamespaceManager.register("RBVH.Stada.WebPages.Constants");RBVH.Stada.WebPages.Constants={DateTimeFormat:{VietNameseDateTime:"DD/MM/YYYY HH:mm"},PageLimit:20,EmployeeLevel:{BOD:7,DepartmentHead:5,GroupLeader:4,Administrator:3,TeamLeader:3.2,AssociateTeamLeader:3.1,ShiftLeader:3.3,Employee:2,Helper:1,SecurityGuard:1,Gardener:1,DirectManagement:6},ApprovalStatus:{En_US:{InProgress:"Approval",Approved:"Approved",Cancelled:"Cancelled",Rejected:"Rejected",InProcess:"In-Process",Completed:"Completed"},Vi_VN:{InProgress:"Approval",Approved:"Đã duyệt",Cancelled:"Đã hủy",Rejected:"Từ chối",InProcess:"Đang thực hiện",Completed:"Hoàn thành"}}};CalendarControl=CalendarControl||{};CalendarControl.CalendarControlSide=".ms-core-navigation";CalendarControl.DatePicker="#DatePickerDiv";CalendarControl.IsLoaded=!1;$(document).ready(function(){var n=$(CalendarControl.CalendarControlSide),t,i;n.each(function(){$(this).find(CalendarControl.DatePicker).length>0&&n.css({display:"flex",width:"500px"})});t=$("#AsynchronousViewDefault_CalendarView");i=$("#DatePickerDiv");t.length>0&&i.length&&window.browseris.ie&&(window.location.hash||(window.location=window.location+"#loaded",window.location.reload()),$(window).resize(function(){CalendarControl.IsLoaded&&window.location.reload();CalendarControl.IsLoaded=!0}))});$.urlParam=function(n){var t=new RegExp("[?&]"+n+"=([^&#]*)").exec(window.location.href);return t==null?null:decodeURI(t[1])||0};$(function(){$(".ms-cui-topBar2 #RibbonContainer-TabRowRight").append("<span id ='flag' class='ms-qatbutton'><a id='enUSLang' href=''><img src='/styles/images/language_flag/en.png'/><\/a><a id='viVNLang' href=''><img src='/styles/images/language_flag/vn.png'/><\/a><\/span>");$("#viVNLang").click(function(){var n=document.URL,t=updateUrlParameter(n,"lang","vi-VN");return window.location.href=t,!1});$("#enUSLang").click(function(){var n=document.URL,t=updateUrlParameter(n,"lang","en-US");return window.location.href=t,!1});var n=DepartmentMenu||{};$("#DepartmentMenuul").prev("a").on("click",function(){$("#DepartmentMenuul li").length==0&&n.renderDepartments()});setNavigation();$("#topmenu_Admin a").on("click",function(){TopMenuModule.ShowHideAdminMenu()});RBVH.Stada.WebPages.Utilities.GUI.showApprovalStatus(".statusmultilang")});$(window).load(function(){$(".se-pre-con").fadeOut(0)});