function leaveSCR_LeavePostRender(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){SP.SOD.registerSod(LeaveRequestSecurityConfig.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+LeaveRequestSecurityConfig.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(LeaveRequestSecurityConfig.ListResourceFileName,"Res",leaveSCR_OnListResourcesReady)},"strings.js");$(".left-button").click(function(){$(this).attr("disabled","true");leaveSCR_UpdateLeftStatus($(this).attr("data-id"),$(this))});$(".entertime-button").click(function(){$(this).attr("disabled","true");leaveSCR_UpdateEnterTimeStatus($(this).attr("data-id"),$(this))});var n=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Department/DepartmentService.svc/GetDepartments/"+_spPageContextInfo.currentUICultureName+"/"+_rbvhContext.EmployeeInfo.FactoryLocation.LookupId;$.ajax({url:n,method:"GET",async:!0,headers:{Accept:"application/json; odata=verbose"},success:function(n){n&&n.length>0&&$("#"+LeaveRequestSecurityConfig.Container+" .department-locale").each(function(){var t=$(this).attr("data-id"),i=$(this);$(n).each(function(n,r){r.Id.toString()===t&&i.text(r.DepartmentName)})})},error:function(){status="failed"}})}function leaveSCR_OnListResourcesReady(){$("#leaveSCR_requester").text(Res.leaveList_Requester);$("#leaveSCR_department").text(Res.leaveList_Department);$("#leaveSCR_from").text(Res.leaveList_From);$("#leaveSCR_to").text(Res.leaveList_To);$("#leaveSCR_shift").text(Res.leaveList_Shift);$("#leaveSCR_leftAt").text(Res.leaveList_LeavedAt);$("#leaveSCR_checkoutby").text(Res.leaveList_CheckOutBy);$("#leaveSCR_photo").text(Res.leaveList_Avatar);$("#leaveSCR_EnterTime").text(Res.leaveList_EnterTime);$("#leaveSCR_checkinby").text(Res.leaveList_CheckInBy);$("#"+LeaveRequestSecurityConfig.Container+" .left-button").text(Res.leaveList_LeftButton);$("#"+LeaveRequestSecurityConfig.Container+" .entertime-button").text(Res.leaveList_Entered)}function leaveSCR_CustomItem(n){var r=n.CurrentItem.ID,c=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Employee/EmployeeService.svc/GetAvatar/"+n.CurrentItem.RequestFor[0].lookupId,l=$.ajax({url:c,method:"GET",async:!1,headers:{Accept:"application/json; odata=verbose"}}),t="";l.then(function(n){t=n!=""?"<td id='photo'><div class='customImageAvatar'>"+n+"<\/div><\/td>":"<td id='photo'><div class='customImageAvatar'>"+LeaveRequestSecurityConfig.DefaultAvatar+"<\/div><\/td>"},function(){t="<td  id='photo'><div class='customImageAvatar'>"+LeaveRequestSecurityConfig.DefaultAvatar+"<\/div><\/td>"});var a='<td style="vertical-align: middle;">'+Functions.removeInvalidValue(n.CurrentItem.RequestFor[0].lookupValue)+"<\/td>",v='<td class="department-locale" data-id="'+n.CurrentItem.CommonDepartment[0].lookupId+'" style="vertical-align: middle;">'+n.CurrentItem.CommonDepartment[0].lookupValue+"<\/td>",y='<td style="vertical-align: middle;">'+n.CurrentItem.CommonFrom+"<\/td>",p='<td style="vertical-align: middle;">'+n.CurrentItem.To+"<\/td>",w='<td style="vertical-align: middle;">'+n.CurrentItem.LeftAt+"<\/td>",u="";n.CurrentItem.CheckOutBy&&(u=n.CurrentItem.CheckOutBy[0].lookupValue);var b='<td style="vertical-align: middle;">'+u+"<\/td>",k='<td style="vertical-align: middle;">'+n.CurrentItem.EnterTime+"<\/td>",f="";n.CurrentItem.CheckInBy&&(f=n.CurrentItem.CheckInBy[0].lookupValue);var d='<td style="vertical-align: middle;">'+f+"<\/td>",e="",o="",s="";(n.CurrentItem.LeftAt||n.CurrentItem.LeftAt!="")&&(o="disabled");n.CurrentItem.EnterTime&&n.CurrentItem.EnterTime!=""&&(s="disabled");var g=n.CurrentItem.CommonDepartment[0].lookupId,nt=n.CurrentItem.RequestFor[0].lookupId,tt=_rbvhContext.EmployeeInfo.FactoryLocation.LookupId,i=new Date,it=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate(),h='<td style="vertical-align: middle;">HC<\/td>',rt=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/LeaveManagement/LeaveManagementService.svc/GetShiftTimeByDate/"+it+"/"+nt+"/"+g+"/"+tt;return $.ajax({url:rt,method:"GET",async:!1,headers:{Accept:"application/json; odata=verbose"}}).done(function(n){h='<td style="vertical-align: middle;">'+n+"<\/td>"}),e="<td style='vertical-align: middle;' nowrap><button type='button'  class='btn btn-default btn-sm left-button' "+o+" data-id='"+r+"'>Left<\/button><button type='button' style='margin-left: 10px;'  class='btn btn-default btn-sm entertime-button' "+s+" data-id='"+r+"'>Entered<\/button><\/td>","<tr>"+t+a+v+y+p+h+w+b+k+d+e+"<\/tr>"}function pagingControl(n){return ViewUtilities.Paging.InstanceHtml(n)}function leaveSCR_UpdateLeftStatus(n){var t=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('"+String(LeaveRequestSecurityConfig.LaveManagement_ListTitle)+"')/items("+n+")";$.ajax({url:t,method:"GET",async:!1,headers:{Accept:"application/json; odata=verbose"},success:function(t){t&&leaveSCR_UpdateItem(n)},error:function(){}})}function leaveSCR_UpdateItem(n){var u=_spPageContextInfo.webServerRelativeUrl,f=window.location.protocol+"//"+window.location.host+u,t=new SP.ClientContext(f),i=t.get_web().get_lists().getByTitle(String(LeaveRequestSecurityConfig.LaveManagement_ListTitle)),e=t.get_web().get_currentUser(),r;t.load(e);t.load(i);this.oListItem=i.getItemById(n);r=new Date;oListItem.set_item("LeftAt",r);oListItem.set_item("CheckOutBy",_rbvhContext.EmployeeInfo.ID);oListItem.update();t.executeQueryAsync(Function.createDelegate(this,this.leaveSCR_onQuerySucceeded),Function.createDelegate(this,this.leaveSCR_onQueryFailed))}function leaveSCR_UpdateEnterTimeStatus(n){var t=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('"+String(LeaveRequestSecurityConfig.LaveManagement_ListTitle)+"')/items("+n+")";$.ajax({url:t,method:"GET",async:!1,headers:{Accept:"application/json; odata=verbose"},success:function(t){t&&leaveSCR_UpdateEnterTimeItem(n)},error:function(){}})}function leaveSCR_UpdateEnterTimeItem(n){var u=_spPageContextInfo.webServerRelativeUrl,f=window.location.protocol+"//"+window.location.host+u,t=new SP.ClientContext(f),i=t.get_web().get_lists().getByTitle(String(LeaveRequestSecurityConfig.LaveManagement_ListTitle)),e=t.get_web().get_currentUser(),r;t.load(e);t.load(i);this.oListItem=i.getItemById(n);r=new Date;oListItem.set_item("EnterTime",r);oListItem.set_item("CheckInBy",_rbvhContext.EmployeeInfo.ID);oListItem.update();t.executeQueryAsync(Function.createDelegate(this,this.leaveSCR_onQuerySucceeded),Function.createDelegate(this,this.leaveSCR_onQueryFailed))}function leaveSCR_onQuerySucceeded(){location.reload()}function leaveSCR_onQueryFailed(){location.reload()}var LeaveRequestSecurityConfig={LaveManagement_Requester:"Requester",LeaveManagement_Department:"Department",LaveManagement_From:"From",LaveManagement_To:"To",LeaveManagement_Shift:"Shift",LeaveManagement_LeaveHours:"Leave Hours",LaveManagement_Reason:"Reason",LeaveManagement_LeftAt:"Left At",LeaveManagement_CheckOutBy:"Check Out By",LeaveManagement_EnterTime:"Time In",LeaveManagement_CheckInBy:"Check In By",LaveManagement_RequesterPhoto:"Photo",LaveManagement_ListTitle:"Leave Management",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",DefaultAvatar:"<img src='/styles/images/DefaultAvatar.jpg'>",Container:"leave-sec-list-container"};(function(){var n={};n.Templates={};n.Templates.Item=leaveSCR_CustomItem;n.OnPreRender=function(){$(".ms-menutoolbar").hide()};n.ListTemplateType=10004;n.BaseViewID=6;n.OnPostRender=leaveSCR_LeavePostRender;n.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='leaveSCR_photo'>"+LeaveRequestSecurityConfig.LaveManagement_RequesterPhoto+"<\/th><th id='leaveSCR_requester'>"+LeaveRequestSecurityConfig.LaveManagement_Requester+"<\/th><th id='leaveSCR_department'>"+LeaveRequestSecurityConfig.LeaveManagement_Department+"<\/th><th id='leaveSCR_from'>"+LeaveRequestSecurityConfig.LaveManagement_From+"<\/th><th id='leaveSCR_to'>"+LeaveRequestSecurityConfig.LaveManagement_To+"<\/th><th id='leaveSCR_shift'>"+LeaveRequestSecurityConfig.LeaveManagement_Shift+"<\/th><th id='leaveSCR_leftAt'>"+LeaveRequestSecurityConfig.LeaveManagement_LeftAt+"<\/th><th id='leaveSCR_checkoutby'>"+LeaveRequestSecurityConfig.LeaveManagement_CheckOutBy+"<\/th><th id='leaveSCR_EnterTime'>"+LeaveRequestSecurityConfig.LeaveManagement_EnterTime+"<\/th><th id='leaveSCR_checkinby'>"+LeaveRequestSecurityConfig.LeaveManagement_CheckInBy+"<\/th><th><\/th><\/tr><\/thead><tbody>";n.Templates.Footer=pagingControl;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(n)})();