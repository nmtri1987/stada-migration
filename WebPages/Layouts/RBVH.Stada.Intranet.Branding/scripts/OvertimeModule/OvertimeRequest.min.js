RBVH.Stada.javascript.common.NamespaceManager.register("RBVH.Stada.WebPages.pages");RBVH.Stada.WebPages.pages.OvertimeRequest=function(n){this.Protocol=window.location.protocol;this.Settings={ServiceUrls:{DepartmentList:this.Protocol+"//{0}/_vti_bin/Services/Department/DepartmentService.svc/GetDepartmentsByLcid/{1}/{2}",DepartmentId:this.Protocol+"//{0}/_vti_bin/Services/Department/DepartmentService.svc/GetDepartmentByIdLanguageCode/{1}/{2}",GetOverTimeManagementById:this.Protocol+"//{0}/_vti_bin/Services/Overtime/OvertimeService.svc/GetById/{1}",UserInformation:this.Protocol+"//{0}/_vti_bin/Services/Employee/EmployeeService.svc/GetCurrentUser",EmployeeList:this.Protocol+"//{0}/_vti_bin/Services/Employee/EmployeeService.svc/GetByDepartmentLocation/{1}/{2}/{3}",OvertimeSubmit:this.Protocol+"//{0}/_vti_bin/Services/Overtime/OvertimeService.svc/InsertOvertime",Approvers:this.Protocol+"//{0}/_vti_bin/Services/Employee/EmployeeService.svc/GetEmployeeApprovers/{1}",GetModifiedDate:this.Protocol+"//{0}/_vti_bin/Services/Common/CommonService.svc/GetModifiedDate/{1}/{2}",EmployeeNotOvertimeList:this.Protocol+"//{0}/_vti_bin/Services/Employee/EmployeeService.svc/GetEmployeeListDontHaveOvertimeInDate/{1}/{2}/{3}",IsDelegated:this.Protocol+"//{0}/_vti_bin/Services/Overtime/OvertimeService.svc/IsDelegated/{1}/{2}",GetConfigurations:"//{0}/_vti_bin/Services/Configurations/ConfigurationsService.svc/GetConfigurations"},OvertimeManagementListUrl:this.Protocol+"//{0}/SitePages/OvertimeManagement.aspx",ISODateFormat:"{0}-{1}-{2}",OvertimeDate:"",Id:0,Grid:{CustomFields:{FullNameField:null,OvertimeHourFromField:null,OvertimeHourToField:null,TaskField:null},CompanyTransportList:[{Name:"Tự túc",Id:"Tự túc"},{Name:"HM",Id:"HM"},{Name:"KD",Id:"KD"}]},OvertimeJsonArray:[],Data:[],EmployeeList:[{Name:"Tri Ngo",Id:11111,Code:"Emp11111"},{Name:"Chau Tran",Id:22222,Code:"Emp22222"}],FullEmployeeList:[],EmployeeListAdd:[],EmployeeListEdit:[],EmployeeListDelete:[],AddedEmployeeCodeList:[],RegisteredEmployeeList:[],StartDate:null,EndDate:null,DefaultDurationHour:23,Requester:{Id:0,Name:"",DepartmentId:0,LocationId:0},ApprovedBy:{UserName:"",FullName:""},OvertimeRequestId:0,IsSystemAdmin:!1,IsReject:!1,ShaderCssClass:".jsgrid-load-shader",LoadPanelCssClass:".jsgrid-load-panel",IsValidRow:!0,IsInsertError:!1,IsItemEditing:!1,IsViewMode:!1,GridBeforeEdit:null,IsValidGridDetails:!1,IsValidMaster:!0,IsBODApprovalRequired:!1,CurrentUserInfo:{RoleId:0},Roles:{BOD:1,DepartmentHead:2},BORoleId:1,BODApprover:null,InsertTemplate:{WorkingHourFrom:"0",WorkingHourTo:"9",WorkingMinuteFrom:"0",WorkingMinuteTo:"0",Task:"",CompanyTransport:""},ApproverFullName:"",Modified:"",ApprovalHistory:{},Configurations:{},ConfigKey_ValidOverTimeDate:"OvertimeForm_ValidOverTimeDate",DiffDays:0};$.extend(!0,this.Settings,n);this.Initialize()};RBVH.Stada.WebPages.pages.OvertimeRequest.prototype={Initialize:function(){var n=this,t;n.Settings.Id=RBVH.Stada.WebPages.Utilities.GetValueByParam("itemId");t=RBVH.Stada.WebPages.Utilities.GetValueByParam("Source");t=!t?document.referrer:decodeURIComponent(t);n.Settings.PrevURL=t;$(document).ready(function(){SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){n.GetConfigurations();n.InitControls();n.SetDefaultValue();n.PopulateData();n.RegisterEvents()})})},GetConfigurations:function(){var n=this,t=[n.Settings.ConfigKey_ValidOverTimeDate],i=RBVH.Stada.WebPages.Utilities.String.format(n.Settings.ServiceUrls.GetConfigurations,location.host);$.ajax({type:"POST",url:i,data:JSON.stringify(t),cache:!1,async:!1,contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(t){t&&t.length>0&&(n.Settings.Configurations=t)})},RegisterEvents:function(){var n=this;$(n.Settings.FromDateControlSelector).on("changeDate",function(t){var i=t.date.getDate(),r=t.date.getMonth()+1,u=t.date.getYear()+1900,f=RBVH.Stada.WebPages.Utilities.String.format(n.Settings.ISODateFormat,u,r,i);n.Settings.OvertimeDate=f;$(".datepicker").hide();n.ValidateInputDate()==!0?n.GetEmployeeList():n.Settings.EmployeeList=[];n.Settings.OvertimeJsonArray=[];n.Settings.AddedEmployeeCodeList=[];n.Settings.EmployeeListAdd=[];n.Settings.EmployeeListEdit=[];n.Settings.EmployeeListDelete=[];$(n.Settings.QuantityControlSelector).val("0");$(n.Settings.ServingControlSelector).val("0");$(n.Settings.GridOvertimeRequestControlSelector).jsGrid("destroy");n.PopulateGrid()});$(n.Settings.QuantityControlSelector).on("keypress",function(n){var t=n.which?n.which:event.keyCode;return t>31&&(t<48||t>57)?!1:!0});$(n.Settings.ServingControlSelector).on("keypress",function(n){var t=n.which?n.which:event.keyCode;return t>31&&(t<48||t>57)?!1:!0});$(n.Settings.ServingControlSelector).on("blur keyup",function(){var i=$(n.Settings.QuantityControlSelector).val()!=""?parseInt($(n.Settings.QuantityControlSelector).val()):0,r=$(this).val()!=""?parseInt($(this).val()):0,t=$(this);setTimeout(function(){r>i?(t.addClass("required-error"),t.focus(),n.Settings.IsValidMaster=!1,n.ToggleSaveButton()):(t.removeClass("required-error"),n.Settings.IsValidMaster=!0,n.ToggleSaveButton())},10)});$(n.Settings.DepartmentControlSelector).on("change",function(){n.Settings.Requester.DepartmentId=$(this).val();n.GetEmployeeList();$(n.Settings.GridOvertimeRequestControlSelector).jsGrid("destroy");n.PopulateGrid()});$(document).on("change","select.workingHourFrom",function(){var i=$(this).val(),r=$(this).closest("td").next("td").find(".workingHourTo").val(),u=n.ValidateHours(parseInt(i),parseInt(r)),t;n.Settings.IsInsertError=!1;u?($(this).attr("title",""),$(this).removeClass("time-invalid"),t=$(this).parent().parent().find(".workingHourTo"),t.length>0&&(t.attr("title",""),t.removeClass("time-invalid")),n.Settings.IsValidRow=!0,$(this).closest("tr.jsgrid-insert-row").find(".jsgrid-insert-button").prop("disabled",!1),$(this).closest("tr.jsgrid-edit-row").find(".jsgrid-update-button").prop("disabled",!1)):(n.Settings.IsInsertError=!1,$(this).parents(".jsgrid-insert-row").length>0?n.Settings.IsInsertError=!0:n.Settings.IsValidRow=!1,$(this).attr("title",n.Settings.InvalidHoursMessage),$(this).addClass("time-invalid"),$(this).closest("tr.jsgrid-insert-row").find(".jsgrid-insert-button").prop("disabled",!0),$(this).closest("tr.jsgrid-edit-row").find(".jsgrid-update-button").prop("disabled",!0))});$(document).on("change","select.workingHourTo",function(){var i=$(this).val(),r=$(this).closest("td").prev("td").find(".workingHourFrom").val(),u=n.ValidateHours(parseInt(r),parseInt(i)),t;n.Settings.IsInsertError=!1;u?($(this).attr("title",""),$(this).removeClass("time-invalid"),t=$(this).parent().parent().find(".workingHourFrom"),t.length>0&&(t.attr("title",""),t.removeClass("time-invalid")),n.Settings.IsValidRow=!0,$(this).closest("tr.jsgrid-insert-row").find(".jsgrid-insert-button").prop("disabled",!1),$(this).closest("tr.jsgrid-edit-row").find(".jsgrid-update-button").prop("disabled",!1)):($(this).parents(".jsgrid-insert-row").length>0?n.Settings.IsInsertError=!0:n.Settings.IsValidRow=!1,$(this).attr("title",n.Settings.InvalidHoursMessage),$(this).addClass("time-invalid"),$(this).closest("tr.jsgrid-insert-row").find(".jsgrid-insert-button").prop("disabled",!0),$(this).closest("tr.jsgrid-edit-row").find(".jsgrid-update-button").prop("disabled",!0))});$(n.Settings.SaveControlSelector).click(function(){return n.ValidateFields()?(n.ValidateEmployeeList(n.OnSaveData),!1):(alert(n.Settings.RequiredFieldsErrorMessage),!1)});$(n.Settings.RejectControlSelector).click(function(){return n.ValidateFields()?($(n.Settings.CommentsControlSelector).removeClass("required-error"),$(n.Settings.CommentsControlSelector).val()=="")?($(n.Settings.CommentsControlSelector).addClass("required-error"),!1):(n.Settings.IsReject=!0,n.OnSaveData(),!1):(alert(n.Settings.RequiredFieldsErrorMessage),!1)});$(n.Settings.CancelControlSelector).click(function(){var t=Functions.getParameterByName("Source");return t&&t.length>0?window.location.href=t:window.location=n.Settings.PrevURL,!1});$(n.Settings.GridOvertimeRequestControlSelector).on("keyup",".jsgrid-edit-row input, .jsgrid-edit-row select",function(t){t.which==13||t.which==40||t.which==38?n.Settings.IsValidRow&&($(".jsgrid-update-button").click(),$(n.Settings.SaveControlSelector).focus()):t.which==27&&$(".jsgrid-cancel-edit-button").click()});$(document).on("click",".jsgrid-row , .jsgrid-alt-row",function(){var t=$(this),n=$(this).prev();n.find("td input:enabled:visible:not([readonly]):first").focus()});$(n.Settings.GridOvertimeRequestControlSelector).on("keyup",".jsgrid-insert-row input, .jsgrid-insert-row select",function(t){(t.which==13||t.which==40||t.which==38)&&(n.Settings.IsInsertError||$(".jsgrid-insert-button").click())});$(window).keydown(function(n){if(n.which==13)return n.preventDefault(),!1});$(document).on("click","a.viewDetail",function(){var t=$(this).attr("data-url"),i={url:t,width:800,height:400,showClose:!0,allowMaximize:!1,title:n.Settings.ViewDetail};SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",i)});$(n.Settings.ApprovalHistoryButtonSelector).on("click",function(t){t.preventDefault();n.RenderOvertimeHistory()})},PopulateData:function(){this.PopulateDepartment();this.PopulatePersonalInformation();this.TryLoadInformation();this.PopulateEmployeeList();this.PopulateGrid()},TryLoadInformation:function(){var n=this,i=RBVH.Stada.WebPages.Utilities.GetValueByParam("Mode"),t,r;i&&i.toUpperCase()=="VIEW"&&(n.Settings.IsViewMode=!0,n.DisableControls());t=RBVH.Stada.WebPages.Utilities.GetValueByParam("itemid");t&&(n.Settings.OvertimeRequestId=t,$(n.Settings.FromDateControlSelector).prop("disabled",!0),r=RBVH.Stada.WebPages.Utilities.String.format(n.Settings.ServiceUrls.GetOverTimeManagementById,location.host,t),$.ajax({type:"GET",url:r,contentType:"application/json; charset=utf-8",async:!1,cache:!1,dataType:"json"}).done(function(r){var u,e,f;if(n.Settings.ApprovalHistory.ApprovedLevel=r.ApprovedLevel,n.Settings.ApprovalHistory.ApprovalStatus=r.ApprovalStatus,n.Settings.ApprovalHistory.FirstApprovedBy=r.FirstApprovedBy,n.Settings.ApprovalHistory.FirstApprovedDate=r.FirstApprovedDate,n.Settings.ApprovalHistory.Modified=r.Modified,n.Settings.Modified=r.Modified,n.Settings.ApprovalHistory.ApprovedBy=r.ApprovedBy,n.Settings.ApprovalHistory.DHComments=r.DHComments,n.Settings.ApprovalHistory.BODComments=r.BODComments,n.Settings.ApprovalHistory.SecurityComments=r.SecurityComments,n.Settings.OvertimeJsonArray=r.OvertimeDetailModelList,u=new Date(r.Date),$(n.Settings.FromDateControlSelector).val(u.getDate()+"/"+(u.getMonth()+1)+"/"+(u.getYear()+1900)),n.Settings.OvertimeDate=RBVH.Stada.WebPages.Utilities.String.format(n.Settings.ISODateFormat,u.getYear()+1900,u.getMonth()+1,u.getDate()),n.PopulateDepartment(r.CommonDepartment.LookupId),n.Settings.LocationId=r.CommonLocation.LookupId,$(n.Settings.FactoryLocationControlSelector).html(r.CommonLocation.LookupValue),$(n.Settings.PlaceControlSelector).val(r.Place),$(n.Settings.QuantityControlSelector).val(r.SumOfEmployee),$(n.Settings.ServingControlSelector).val(r.SumOfMeal),$(n.Settings.RequesterControlSelector).html(r.Requester.LookupValue),n.Settings.Requester.Id=r.Requester.LookupId,n.Settings.Requester.Name=r.Requester.LookupValue,$(n.Settings.OtherRequestControlSelector).val(r.OtherRequirements),n.Settings.DepartmentId=r.CommonDepartment.LookupId,n.Settings.ApprovedBy=r.ApprovedBy,$(n.Settings.ApprovedByControlSelector).html(r.ApprovedBy.FullName),n.Settings.View=="Approval"&&(_rbvhContext&&_rbvhContext.EmployeeInfo&&_rbvhContext.EmployeeInfo.ADAccount.ID!=r.ApprovedBy.ID&&_rbvhContext&&_rbvhContext.EmployeeInfo&&_rbvhContext.EmployeeInfo.ADAccount.ID!=r.ApprovedBy.ID&&(e=RBVH.Stada.WebPages.Utilities.String.format(n.Settings.ServiceUrls.IsDelegated,location.host,r.ApprovedBy.ID,t),$.ajax({type:"GET",url:e,cache:!1,async:!1,contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(t){t==!1&&(window.location=window.location.protocol+"//"+location.host+"/_layouts/15/AccessDenied.aspx");n.Settings.ApproverFullName=_rbvhContext.EmployeeInfo.FullName})),n.Settings.OvertimeJsonArray.length==0&&n.DisableControls()),r.ApprovalStatus=="false"||r.ApprovalStatus=="true"||n.Settings.View!="Approval"&&r.ApprovalStatus==""&&r.FirstApprovedBy!=null&&r.FirstApprovedBy.ID>0?(n.Settings.IsViewMode=!0,n.DisableControls()):n.Settings.View=="Approval"&&r.RequestExpired==!0&&(errMsg=decodeURI(n.Settings.RequestExpiredMsgFormat),errMsg=RBVH.Stada.WebPages.Utilities.String.format(errMsg,r.RequestDueDate),RBVH.Stada.WebPages.Utilities.GUI.showRequestExpired(n.Settings.ErrorMsgContainerSelector,n.Settings.ErrorMsgSelector,errMsg),n.Settings.IsViewMode=!0,n.DisableControls()),i&&i.toUpperCase()=="VIEW"){f=Functions.getAttachments("Overtime Management",t);f!=""&&n.Settings.CurrentUserInfo.RoleId!=n.Settings.Roles.BOD&&$(n.Settings.PrintControlSelector).show();$(n.Settings.PrintControlSelector).on("click",function(n){window.open(f);n.preventDefault()})}}))},PopulateAdminRequester:function(){var n=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var t=new SP.ClientContext.get_current,r=t.get_web(),i=t.get_web().get_currentUser();t.load(i);t.executeQueryAsync(function(){var r=i.get_id(),t=i.get_title();$(n.Settings.RequesterControlSelector).html(t);n.Settings.Requester={Id:r,Name:t,DepartmentId:$(n.Settings.DepartmentControlSelector).val()}},function(){})})},PopulatePersonalInformation:function(){var n=this,t=RBVH.Stada.WebPages.Utilities.String.format(n.Settings.ServiceUrls.UserInformation,location.host);$.ajax({type:"GET",url:t,contentType:"application/json; charset=utf-8",dataType:"json",async:!1,cache:!1,success:function(t){t&&(t.IsSystemAdmin==!0?(n.Settings.IsSystemAdmin=!0,n.PopulateDepartment(),n.PopulateAdminRequester()):n.Settings.View!="Approval"&&!!n.Settings.Id==!1&&(n.Settings.Requester={Id:t.ID,Name:t.FullName,DepartmentId:t.Department.LookupId,LocationId:t.Location.LookupId},n.Settings.DepartmentId=t.Department.LookupId,n.Settings.LocationId=t.Location.LookupId,$(n.Settings.RequesterControlSelector).html(t.FullName),$(n.Settings.FactoryLocationControlSelector).html(t.Location.LookupValue),$(n.Settings.DepartmentControlSelector).val(t.Department.LookupId).change(),$(n.Settings.DepartmentControlSelector).prop("disabled",!0)),n.Settings.CurrentUserInfo.RoleId=t.EmployeePosition,n.Settings.IsBODApprovalRequired=t.IsBODApprovalRequired,!!n.Settings.ApprovedBy.UserName==!1&&n.PopulateApprovedBy(t.ID))}})},PopulateDepartment:function(n){var i=this,u=_spPageContextInfo.currentLanguage,t=0,r;(typeof n!="undefined"&&(t=n),t==0&&_rbvhContext!=null&&_rbvhContext.EmployeeInfo.Department!=null&&(t=_rbvhContext.EmployeeInfo.Department.LookupId),t!=0)&&(r=RBVH.Stada.WebPages.Utilities.String.format(i.Settings.ServiceUrls.DepartmentId,location.host,t,u),$(i.Settings.DepartmentControlSelector).attr("disabled",!1),$(i.Settings.DepartmentControlSelector).empty(),$.ajax({type:"GET",url:r,contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(n){$(n).each(function(){$(i.Settings.DepartmentControlSelector).append($("<option>").attr("value",this.Id).text(this.DepartmentName))})}}))},PopulateApprovedBy:function(n){var t=this,i=RBVH.Stada.WebPages.Utilities.String.format(t.Settings.ServiceUrls.Approvers,location.host,n);$.ajax({type:"GET",url:i,contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(n){n&&(t.Settings.IsBODApprovalRequired&&t.Settings.View=="Approval"&&n.Approver3&&(t.Settings.BODApprover={},t.Settings.BODApprover.UserName=n.Approver3.LoginName,t.Settings.BODApprover.FullName=n.Approver3.FullLoginName),n.Approver2&&($(t.Settings.ApprovedByControlSelector).html(n.Approver2.FullLoginName),t.Settings.ApprovedBy.UserName=n.Approver2.LoginName,t.Settings.ApprovedBy.FullName=n.Approver2.FullLoginName))}})},PopulateGrid:function(){var n=this;n.BindGridColumns();$(n.Settings.GridOvertimeRequestControlSelector).jsGrid({width:"100%",height:"400px",align:"center",inserting:!n.Settings.IsViewMode&&n.Settings.View!="Approval",editing:!n.Settings.IsViewMode,sorting:!0,autoload:!0,noDataContent:"",deleteConfirm:n.Settings.ConfirmDeleteMessage,onDataLoaded:function(){},controller:{loadData:function(){var t=$.Deferred();return t.resolve(n.Settings.OvertimeJsonArray),t.promise()},insertItem:function(){},updateItem:function(){},deleteItem:function(){}},onItemInserting:function(t){var i=t.item.OvertimeHourFrom.split(":")[0],r=t.item.OvertimeHourTo.split(":")[0],u=n.ValidateHours(parseInt(i),parseInt(r));if(!u){alert(n.Settings.InvalidHoursMessage);t.cancel=!0;return}n.FilterEmployeeList().length==0&&(t.cancel=!0)},onItemInserted:function(t){var e=t.item.FullName,i,r,u,f;n.Settings.AddedEmployeeCodeList.push(e.split("_")[1]);t.item.ID=0;n.Settings.EmployeeListAdd.push(t.item);n.UpdateQuantity(1);n.ToggleSaveButton();i=t.item.OvertimeHourFrom.split(":")[0];n.Settings.InsertTemplate.WorkingHourFrom=i;r=t.item.OvertimeHourTo.split(":")[0];n.Settings.InsertTemplate.WorkingHourTo=r;u=t.item.OvertimeHourFrom.split(":")[1];n.Settings.InsertTemplate.WorkingMinuteFrom=u;f=t.item.OvertimeHourTo.split(":")[1];n.Settings.InsertTemplate.WorkingMinuteTo=f;n.Settings.InsertTemplate.Task=t.item.Task;n.Settings.InsertTemplate.CompanyTransport=t.item.CompanyTransport;setTimeout(function(){$(n.Settings.RegisteredEmployeeList).each(function(){var n=this.FullName.split("_")[0];$(".jsgrid-grid-body td:contains("+n+")").parent("tr").children("td, th").addClass("invalid-row")})},100)},onItemEditing:function(){n.Settings.IsItemEditing=!0;n.ToggleSaveButton()},onItemUpdated:function(t){var r=t.item.FullName,i;t.item.ID=t.item.ID==""?"0":t.item.ID;i=parseInt(t.item.ID);i>0?(n.RefreshEmployeeEditList(t.item.FullName),n.Settings.EmployeeListEdit.push(t.item)):(n.RefreshEmployeeAddList(t.item.FullName),n.Settings.EmployeeListAdd.push(t.item));n.Settings.IsItemEditing=!1;n.ToggleSaveButton()},onItemDeleted:function(t){var u=t.item.FullName,i,r;if(t.item.ID=t.item.ID==""?"0":t.item.ID,i=parseInt(t.item.ID),i>0){var f=u.split("_")[1],e=n.GetEmployeeCodeById(f),r=n.Settings.AddedEmployeeCodeList.indexOf(e);n.Settings.AddedEmployeeCodeList.splice(r,1);t.item.ID=-i;n.Settings.EmployeeListDelete.push(t.item)}else r=n.Settings.AddedEmployeeCodeList.indexOf(u.split("_")[1]),n.Settings.AddedEmployeeCodeList.splice(r,1),n.RefreshEmployeeAddList(t.item.FullName),n.RefreshEmployeeEditList(t.item.FullName);n.FilterEmployeeList().length>0&&$(n.Settings.GridOvertimeRequestControlSelector).jsGrid("clearInsert");n.UpdateQuantity(-1);n.ToggleSaveButton();$(n.Settings.RegisteredEmployeeList).each(function(){var n=this.FullName.split("_")[0];$(".jsgrid-grid-body td:contains("+n+")").parent("tr").children("td, th").addClass("invalid-row")})},onItemEditCancelling:function(){n.Settings.IsItemEditing=!1;n.Settings.IsValidRow=!0;n.ToggleSaveButton()},fields:n.Settings.Grid.Fields})},InitControls:function(){var n=this;$(n.Settings.FromDateControlSelector).datepicker({format:"dd/mm/yyyy",autoclose:!0});$(n.Settings.SaveControlSelector).click(function(){return!1});!!n.Settings.Id==!1&&($(n.Settings.SaveControlSelector).prop("disabled",!0),$(n.Settings.SaveControlSelector).addClass("disable"))},DisableControls:function(){var n=this;$(n.Settings.DepartmentControlSelector).prop("disabled",!0);$(n.Settings.FromDateControlSelector).prop("disabled",!0);$(n.Settings.PlaceControlSelector).prop("disabled",!0);$(n.Settings.QuantityControlSelector).prop("disabled",!0);$(n.Settings.ServingControlSelector).prop("disabled",!0);$(n.Settings.OtherRequestControlSelector).prop("disabled",!0);$(n.Settings.SaveControlSelector).prop("disabled",!0);$(n.Settings.SaveControlSelector).addClass("disable");$(n.Settings.RejectControlSelector).prop("disabled",!0);$(n.Settings.RejectControlSelector).addClass("disable")},ValidateInputDate:function(){var n=this,t;$(n.Settings.OvertimeDateErrorSelector).html("");try{t=Functions.getConfigValue(n.Settings.Configurations,n.Settings.ConfigKey_ValidOverTimeDate);t&&(n.Settings.DiffDays=parseInt(t))}catch(e){n.Settings.DiffDays=0}var u=$(n.Settings.FromDateControlSelector).val(),f=Functions.parseVietNameseDate(u),i=new Date,r=new Date(i.getFullYear(),i.getMonth(),i.getDate());return r.setDate(r.getDate()+n.Settings.DiffDays),f.valueOf()>=r.valueOf()?!0:($(n.Settings.OvertimeDateErrorSelector).html(RBVH.Stada.WebPages.Utilities.String.format(decodeURI(n.Settings.OvertimeDateErrorMsgFormat),n.Settings.DiffDays)),!1)},SetDefaultValue:function(){var n=this,r,i,t,u;$(n.Settings.OtherRequestControlSelector).val("");$(n.Settings.CommentsControlSelector).val("");try{r=Functions.getConfigValue(n.Settings.Configurations,n.Settings.ConfigKey_ValidOverTimeDate);r&&(n.Settings.DiffDays=parseInt(r))}catch(f){n.Settings.DiffDays=0}i=new Date;t=new Date(i.getFullYear(),i.getMonth(),i.getDate());t.setDate(t.getDate()+n.Settings.DiffDays);u=Functions.parseVietnameseDateTimeToDDMMYYYY2(t);$(n.Settings.FromDateControlSelector).val(u);n.Settings.OvertimeDate=RBVH.Stada.WebPages.Utilities.String.format(n.Settings.ISODateFormat,t.getYear()+1900,t.getMonth()+1,t.getDate());$(n.Settings.QuantityControlSelector).val("0");$(n.Settings.ServingControlSelector).val("0")},BindGridColumns:function(){var n=this;n.BindFullNameField();n.BindOvertimeHourFromField();n.BindOvertimeHourToField();n.BindTaskField();jsGrid.fields.custFullNameField=n.Settings.Grid.CustomFields.FullNameField;jsGrid.fields.custOvertimeHourFromField=n.Settings.Grid.CustomFields.OvertimeHourFromField;jsGrid.fields.custOvertimeHourToField=n.Settings.Grid.CustomFields.OvertimeHourToField;jsGrid.fields.custTaskField=n.Settings.Grid.CustomFields.TaskField;n.Settings.Grid.Fields=[{name:"ID",title:"ID",readOnly:!0,headercss:"hide"},{name:"FullName",title:n.Settings.Grid.ColumnTitles.GridColumn_FullName,width:300,headercss:"header-center",type:"custFullNameField"},{name:"OvertimeHourFrom",title:n.Settings.Grid.ColumnTitles.GridColumn_OvertimeHourFrom,width:150,align:"center",type:"custOvertimeHourFromField"},{name:"OvertimeHourTo",title:n.Settings.Grid.ColumnTitles.GridColumn_OvertimeHourTo,width:150,align:"center",type:"custOvertimeHourToField"},{name:"Task",title:n.Settings.Grid.ColumnTitles.GridColumn_Task,type:"text",width:"auto",headercss:"header-center",type:"custTaskField"},{name:"CompanyTransport",title:n.Settings.Grid.ColumnTitles.GridColumn_CompanyTransport,type:"select",items:n.Settings.Grid.CompanyTransportList,valueField:"Id",textField:"Name",width:150,headercss:"header-center"},{type:"control",editButton:!1,deleteButton:!n.Settings.IsViewMode,width:60,modeSwitchButton:!1}]},BindFullNameField:function(){var n=this;n.Settings.Grid.CustomFields.FullNameField=function(n){jsGrid.Field.call(this,n)};n.Settings.Grid.CustomFields.FullNameField.prototype=new jsGrid.Field({itemTemplate:function(n){var t=n;return t.split("_")[0]},insertTemplate:function(){var i=n.FilterEmployeeList(),t,u,f,r;if(i.length>0){t=$("<select class='full-name form-control' style='width: 150px;' />");$(i).each(function(){t.append($("<option>").attr("value",this.EmployeeID).text(this.FullName))});u=i[0].EmployeeID;f=$("<span class='full-name'>").html(" - "+u);t.on("change",function(){$(this).parent().find("span.full-name").html(" - "+$(this).val())});return r=$("<div>"),r.append(t).append(f),t.select2(),this._insertFullName=r}},editTemplate:function(n){var t=n.split("_"),f=t[1],u=$("<span class='full-name'>").html(t[0]),i=$("<div style='font-weight: bold; text-align: center;'>"),r;return i.append(u),r=$("<input/>",{type:"hidden",name:"empId",value:t[1]}),i.append(r),this._editFullName=i},insertValue:function(){if(this._insertFullName){var n=this._insertFullName.find("option:selected");return n.text()+"_"+n.val()}},editValue:function(){var n=this._editFullName.find("input[type=hidden]:first").val(),t=this._editFullName.text();return t+"_"+n}})},FormatNumber:function(n,t){var i="000000000"+n;return i.substr(i.length-t)},BindOvertimeHourFromField:function(){var n=this;n.Settings.Grid.CustomFields.OvertimeHourFromField=function(n){jsGrid.Field.call(this,n)};n.Settings.Grid.CustomFields.OvertimeHourFromField.prototype=new jsGrid.Field({itemTemplate:function(t){var r=t,i=r.split(":");return i[0]+":"+n.FormatNumber(i[1],2)},insertTemplate:function(){return this._insertWorkingHourTime=this._createWorkingHourTimeBox()},editTemplate:function(n){var t=n.split(":");return $result=this._editWorkingHourTime=this._createWorkingHourTimeBox(),$result[0].value=t[0],$result[2].value=t[1],$result},insertValue:function(){var n=$(this._insertWorkingHourTime[0]).val(),t=$(this._insertWorkingHourTime[2]).val();return n+":"+t},editValue:function(){var n=$(this._editWorkingHourTime[0]).val(),t=$(this._editWorkingHourTime[2]).val();return n+":"+t},_createWorkingHourTimeBox:function(){for(var t,r=$("<select id='workingHourFrom' class='workingHourFrom form-control' style='width: 55px;' />"),i=0;i<24;i++)r.append($("<option>").attr("value",i).text(i));return t=$("<select id='workingMinuteFrom' class='workingMinuteFrom form-control' style='width: 55px;' />"),t.append($("<option>").attr("value",0).text("00")),t.append($("<option>").attr("value",15).text("15")),t.append($("<option>").attr("value",30).text("30")),t.append($("<option>").attr("value",45).text("45")),r.val(n.Settings.InsertTemplate.WorkingHourFrom),t.val(n.Settings.InsertTemplate.WorkingMinuteFrom),r.add("<span>:<span>").add(t)}})},BindOvertimeHourToField:function(){var n=this;n.Settings.Grid.CustomFields.OvertimeHourToField=function(n){jsGrid.Field.call(this,n)};n.Settings.Grid.CustomFields.OvertimeHourToField.prototype=new jsGrid.Field({itemTemplate:function(t){var r=t,i=r.split(":");return i[0]+":"+n.FormatNumber(i[1],2)},insertTemplate:function(){return this._insertWorkingHourTime=this._createWorkingHourTimeBox()},editTemplate:function(n){var t=n.split(":");return $result=this._editWorkingHourTime=this._createWorkingHourTimeBox(),$result[0].value=t[0],$result[2].value=t[1],$result},insertValue:function(){var n=$(this._insertWorkingHourTime[0]).val(),t=$(this._insertWorkingHourTime[2]).val();return n+":"+t},editValue:function(){var n=$(this._editWorkingHourTime[0]).val(),t=$(this._editWorkingHourTime[2]).val();return n+":"+t},_createWorkingHourTimeBox:function(){for(var t,r=$("<select id='workingHourTo' class='workingHourTo form-control' style='width: 55px;' />"),i=0;i<24;i++)r.append($("<option>").attr("value",i).text(i));return t=$("<select id='workingMinuteTo' class='workingMinuteTo form-control' style='width: 55px;' />"),t.append($("<option>").attr("value",0).text("00")),t.append($("<option>").attr("value",15).text("15")),t.append($("<option>").attr("value",30).text("30")),t.append($("<option>").attr("value",45).text("45")),r.val(n.Settings.InsertTemplate.WorkingHourTo),t.val(n.Settings.InsertTemplate.WorkingMinuteTo),r.add("<span>:<span>").add(t)}})},BindTaskField:function(){var n=this;n.Settings.Grid.CustomFields.TaskField=function(n){jsGrid.Field.call(this,n)};n.Settings.Grid.CustomFields.TaskField.prototype=new jsGrid.Field({itemTemplate:function(t){var i,r;return t==null||t==""?t:(i=t,i.split("_").length>1)?(r='<a class="viewDetail" href="#" data-url="'+i.split("_")[1]+'">'+n.Settings.ViewDetailTitle+"<\/a>",i.split("_")[0]+" - "+r):t},insertTemplate:function(t){var i=$("<input/>",{type:"text",name:"txtOvertimeTask",value:t,maxlength:254});return i.val(n.Settings.InsertTemplate.Task),this._insertTask=i},editTemplate:function(n){var t=$("<input/>",{type:"text",name:"txtOvertimeTask",value:n,maxlength:254});return this._editTask=t},insertValue:function(){return this._insertTask.val()},editValue:function(){return this._editTask.val()}})},ToggleSaveButton:function(){var n=!1,t=!1,i=!0;!!this.Settings.Id==!1?this.Settings.OvertimeJsonArray.length==0&&(n=!0):(n=!this.Settings.IsValidMaster,this.Settings.View=="Approval"?t=this.Settings.OvertimeJsonArray.length==0:i=!this.Settings.OvertimeJsonArray.length==0);n||t||!this.Settings.IsValidRow||!this.Settings.IsValidMaster||!i||this.Settings.IsItemEditing?($(this.Settings.SaveControlSelector).prop("disabled",!0),$(this.Settings.SaveControlSelector).addClass("disable"),$(this.Settings.RejectControlSelector).length>0&&($(this.Settings.RejectControlSelector).prop("disabled",!0),$(this.Settings.RejectControlSelector).addClass("disable"))):($(this.Settings.SaveControlSelector).prop("disabled",!1),$(this.Settings.SaveControlSelector).removeClass("disable"),$(this.Settings.RejectControlSelector).length>0&&($(this.Settings.RejectControlSelector).prop("disabled",!1),$(this.Settings.RejectControlSelector).removeClass("disable")))},CheckDirtyGrid:function(){return!!this.Settings.Id==!1?this.Settings.OvertimeJsonArray.length==0:that.Settings.EmployeeListAdd.push.apply(that.Settings.EmployeeListAdd,that.Settings.EmployeeListEdit,that.Settings.EmployeeListDelete).length==0},FilterEmployeeList:function(n){var t=this,i=t.Settings.EmployeeList.filter(function(i){return typeof n!="undefined"&&i.EmployeeID==n||$.inArray(i.EmployeeID,t.Settings.AddedEmployeeCodeList)<0});return $.each(this.Settings.EmployeeListDelete,function(n,r){i.push({FullName:r.FullName.split("_")[0],EmployeeID:t.GetEmployeeCodeById(r.FullName.split("_")[1])})}),i},PopulateEmployeeList:function(){var n=this;this.GetEmployeeList();this.GetFullEmployeeList();!this.Settings.Id||(this.Settings.AddedEmployeeCodeList=$.map(this.Settings.OvertimeJsonArray,function(t){return n.GetEmployeeCodeById(t.Employee.LookupId)}))},GetEmployeeList:function(){var n=this,t=$(n.Settings.DepartmentControlSelector).val(),i=n.Settings.LocationId,r=RBVH.Stada.WebPages.Utilities.String.format(n.Settings.ServiceUrls.EmployeeNotOvertimeList,location.host,t,i,n.Settings.OvertimeDate);$.ajax({type:"GET",url:r,contentType:"application/json; charset=utf-8",dataType:"json",async:!1,cache:!1,success:function(t){n.Settings.EmployeeList=t}})},GetFullEmployeeList:function(){var n=this,t=$(n.Settings.DepartmentControlSelector).val(),i=n.Settings.LocationId,r=RBVH.Stada.WebPages.Utilities.String.format(n.Settings.ServiceUrls.EmployeeList,location.host,i,t,6);$.ajax({type:"GET",url:r,contentType:"application/json; charset=utf-8",dataType:"json",async:!1,cache:!1,success:function(t){n.Settings.FullEmployeeList=t}})},ValidateHours:function(n,t){return!(n==12&&t==13)},GetEmployeeIdByCode:function(n){if(n!=""){var t="";return $.each(this.Settings.FullEmployeeList,function(i,r){if(r.EmployeeID==n){t=r.ID;return}}),t}return""},GetEmployeeCodeById:function(n){if(n!=""){var t="";return $.each(this.Settings.FullEmployeeList,function(i,r){if(r.ID==n){t=r.EmployeeID;return}}),t}return""},RefreshEmployeeAddList:function(n){var i=this,t;n!=""&&(t=-1,$.each(this.Settings.EmployeeListAdd,function(i,r){if(r.FullName==n){t=i;return}}),t>=0&&i.Settings.EmployeeListAdd.splice(t,1))},RefreshEmployeeEditList:function(n){var i=this,t;n!=""&&(t=-1,$.each(this.Settings.EmployeeListEdit,function(i,r){if(r.FullName==n){t=i;return}}),t>=0&&i.Settings.EmployeeListEdit.splice(t,1))},RemoveRequiredError:function(){var n=this;$(n.Settings.DepartmentControlSelector).removeClass("required-error");$(n.Settings.QuantityControlSelector).removeClass("required-error");$(n.Settings.ServingControlSelector).removeClass("required-error");$(n.Settings.FromDateControlSelector).removeClass("required-error")},ValidateFields:function(){var n=this,t;if(n.RemoveRequiredError(),t=!0,($(n.Settings.DepartmentControlSelector).val()==null||$(n.Settings.DepartmentControlSelector).val()=="")&&($(n.Settings.DepartmentControlSelector).addClass("required-error"),t=!1),$(n.Settings.QuantityControlSelector).val()==""&&($(n.Settings.QuantityControlSelector).addClass("required-error"),t=!1),$(n.Settings.ServingControlSelector).val()==""&&($(n.Settings.ServingControlSelector).addClass("required-error"),t=!1),$(n.Settings.FromDateControlSelector).val()=="")$(n.Settings.FromDateControlSelector).addClass("required-error"),t=!1;else if(!!n.Settings.Id==!1){var i=new Date,u=new Date(i.getFullYear(),i.getMonth(),i.getDate()),r=$(n.Settings.FromDateControlSelector).val().split("/"),f=new Date(r[2],r[1]-1,r[0]);f.valueOf()<u.valueOf()&&($(n.Settings.FromDateControlSelector).addClass("required-error"),t=!1)}return t},UpdateQuantity:function(n){var r=this,t=$(r.Settings.QuantityControlSelector).val(),i=$(r.Settings.ServingControlSelector).val();isNaN(t)||(t=parseInt(t)+n);isNaN(i)||(i=parseInt(i)+n);t=t<0?0:t;i=i<0?0:i;$(r.Settings.QuantityControlSelector).val(t);$(r.Settings.ServingControlSelector).val(i)},OnBeginSaveData:function(){var n=this;$(n.Settings.ShaderCssClass).show();$(n.Settings.LoadPanelCssClass).show();$(n.Settings.SaveControlSelector).prop("disabled",!0);$(n.Settings.SaveControlSelector).addClass("disable");$(n.Settings.RejectControlSelector).prop("disabled",!0);$(n.Settings.RejectControlSelector).addClass("disable")},OnEndSaveData:function(){var n=this;$(n.Settings.ShaderCssClass).hide();$(n.Settings.LoadPanelCssClass).hide();$(n.Settings.SaveControlSelector).prop("disabled",!1);$(n.Settings.SaveControlSelector).removeClass("disable");$(n.Settings.RejectControlSelector).prop("disabled",!1);$(n.Settings.RejectControlSelector).removeClass("disable")},SetMasterObject:function(){var t=this,n={},n={};return n.ApprovalStatus="",n.CommonDepartment={},n.CommonDepartment.LookupId=t.Settings.Requester.DepartmentId||$(t.Settings.DepartmentControlSelector).val(),n.CommonLocation={},n.CommonLocation.LookupId=t.Settings.LocationId,n.Place=$(t.Settings.PlaceControlSelector).val(),n.SumOfEmployee=$(t.Settings.QuantityControlSelector).val(),n.SumOfMeal=$(t.Settings.ServingControlSelector).val(),n.OtherRequirements=$(t.Settings.OtherRequestControlSelector).val(),n.Requester={},n.Requester.LookupId=t.Settings.Requester.Id,n.Requester.LookupValue=t.Settings.Requester.Name,n.ApprovedBy=t.Settings.ApprovedBy||{},n.ApproverFullName=t.Settings.ApproverFullName!=""?t.Settings.ApproverFullName:n.ApprovedBy.FullName,n.ID=t.Settings.OvertimeRequestId,n.OvertimeDetailModelList=[],n},OnSaveData:function(){var n=this,i,f,u,b,c,h,k,l,g;if(n.Settings.Id===0&&n.ValidateInputDate()===!1)return!1;if(n.OnBeginSaveData(),i=n.Settings.OvertimeJsonArray,i.length==0&&!!n.Settings.Id==!1){n.OnEndSaveData();return}var t=n.SetMasterObject(),r={},a=$(n.Settings.FromDateControlSelector).val().split("/"),o=new Date(a[2],a[1]-1,a[0]),v=o.getDate(),y=o.getMonth(),p=o.getYear()+1900;for(t.Date=o.toDateString(),f=o,u=0;u<i.length;u++){r={};r.ID=i[u].ID!=""?parseInt(i[u].ID):0;var s=parseInt(i[u].OvertimeHourFrom.split(":")[0]),d=parseInt(i[u].OvertimeHourFrom.split(":")[1]),e=parseInt(i[u].OvertimeHourTo.split(":")[0]),w=parseInt(i[u].OvertimeHourTo.split(":")[1]),nt=new Date(p,y,v,s,d,0);!!i[u].OvertimeTo;b=new Date(p,y,v,e,w,0);c=0;e<s?(f.setDate(f.getDate()+1),b=new Date(f.getYear()+1900,f.getMonth(),f.getDate(),e,w,0),c=24+e-s):c=e-s;h=i[u].FullName.split("_")[1];k=n.GetEmployeeIdByCode(h);h=k==""?parseInt(h):k;r.Employee={};r.Employee.LookupId=h;r.OvertimeFrom=nt.toISOString();r.OvertimeTo=b.toISOString();r.Task=i[u].Task;r.CompanyTransport=i[u].CompanyTransport;l=w-d;l=l/60;r.WorkingHours=(c+l).toString();s<=12&&e>=13&&(r.WorkingHours-=.75);r.WorkingHours=Math.round(r.WorkingHours);t.OvertimeDetailModelList.push(r);f=new Date(p,y,v)}n.Settings.View=="Approval"&&(t.ApprovedBy={UserName:_rbvhContext.EmployeeInfo.ADAccount.UserName,ID:_rbvhContext.EmployeeInfo.ADAccount.ID},n.Settings.IsReject?(t.ApprovalStatus=!1,n.Settings.BODApprover!=null&&(t.RequiredBODApprove=!0)):n.Settings.OvertimeJsonArray.length>0&&(n.Settings.CurrentUserInfo.RoleId==n.Settings.Roles.BOD?(t.ApprovalStatus=!0,t.RequiredBODApprove=!0):(t.DHComments=$(n.Settings.CommentsControlSelector).val(),n.Settings.BODApprover!=null?(t.ApprovedBy=n.Settings.BODApprover,t.RequiredBODApprove=!0,t.ApprovalStatus=""):t.ApprovalStatus=!0)),n.Settings.CurrentUserInfo.RoleId==n.Settings.Roles.BOD?t.BODComments=$(n.Settings.CommentsControlSelector).val():(t.FirstApprovedBy={UserName:_rbvhContext.EmployeeInfo.ADAccount.UserName,ID:_rbvhContext.EmployeeInfo.ADAccount.ID},t.DHComments=$(n.Settings.CommentsControlSelector).val()));g=RBVH.Stada.WebPages.Utilities.String.format(n.Settings.ServiceUrls.GetModifiedDate,location.host,"3",t.ID);$.ajax({type:"GET",url:g,contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(i){i.Code==0&&i.Message!==n.Settings.Modified?$.confirm({title:n.Settings.Modal.Title,content:n.Settings.DataChanged_Msg,buttons:{save:{text:n.Settings.Modal.SaveButton,action:function(){n.SubmitData(t)}},reload:{text:n.Settings.Modal.ReloadButton,btnClass:"btn-blue",action:function(){window.location.reload()}},close:{text:n.Settings.Modal.CloseButton,action:function(){n.OnEndSaveData()}}}}):i.Code!=0?n.OnEndSaveData():n.SubmitData(t)})},SubmitData:function(n){var t=this,i=RBVH.Stada.WebPages.Utilities.String.format(t.Settings.ServiceUrls.OvertimeSubmit,location.host);$.ajax({type:"POST",url:i,data:JSON.stringify(n),contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(n){n&&(n.Code===1||n.Code===2||n.Code===3||n.Code===4)?alert(n.Message):n&&n.Code===999&&(alert(n.Message),window.location.reload());t.Settings.OvertimeRequestId=n.ObjectId;$(t.Settings.ShaderCssClass).hide();$(t.Settings.LoadPanelCssClass).hide();$(t.Settings.SaveControlSelector).prop("disabled",!1);$(t.Settings.SaveControlSelector).removeClass("disable");t.Settings.EmployeeListAdd=[];t.Settings.EmployeeListEdit=[];t.Settings.EmployeeListDelete=[];t.Settings.AddedEmployeeCodeList=[];var i=Functions.getParameterByName("Source");i&&i.length>0?window.location.href=i:window.location=t.Settings.PrevURL})},ValidateEmployeeList:function(n){var t=this,i=$(t.Settings.DepartmentControlSelector).val(),r=t.Settings.LocationId,u=RBVH.Stada.WebPages.Utilities.String.format(t.Settings.ServiceUrls.EmployeeNotOvertimeList,location.host,i,r,t.Settings.OvertimeDate);return $.ajax({type:"GET",url:u,contentType:"application/json; charset=utf-8",dataType:"json",async:!1,cache:!1,success:function(i){var r,u,f;typeof n=="function"&&(t.Settings.RegisteredEmployeeList=[],r=i,u=t.Settings.EmployeeListAdd,$(u).each(function(){var u=this.FullName.split("_")[1],n=this.FullName.split("_")[0],i=!0;$.grep(r,function(n){n.EmployeeID==u&&(i=!1)});i==!0?(t.Settings.RegisteredEmployeeList.push(this),$(".jsgrid-grid-body td:contains("+n+")").parent("tr").children("td, th").addClass("invalid-row")):$(".jsgrid-grid-body td:contains("+n+")").parent("tr").children("td, th").removeClass("invalid-row")}),t.Settings.RegisteredEmployeeList.length>0?alert(t.Settings.RegisteredEmployeeMessage):(f=n.bind(t),f()))}})},RenderOvertimeHistory:function(){var t=this,r=[],n=t.Settings.ApprovalHistory,i,f,o,e,u;if(n.ApprovedLevel==1?(i={},i.Status=n.ApprovalStatus=="false"?t.Settings.ApprovalStatus_Rejected:t.Settings.ApprovalStatus_Approved,i.Approver=n.FirstApprovedBy.FullName,i.Date=n.FirstApprovedDate,i.Comment=n.DHComments,r.push(i)):n.ApprovedLevel==2&&(i={},i.Status=t.Settings.ApprovalStatus_Approved,i.Approver=n.FirstApprovedBy.FullName,i.Date=n.FirstApprovedDate,i.Comment=n.DHComments,r.push(i),f={},f.Status=n.ApprovalStatus=="false"?t.Settings.ApprovalStatus_Rejected:t.Settings.ApprovalStatus_Approved,f.Approver=n.ApprovedBy.FullName,f.Date=n.Modified,f.Comment=n.BODComments,r.push(f)),o=t.Settings.NoDataAvaibleMsg,e='<table class="table gridView" style="border-collapse: collapse;" border="1" rules="all" cellspacing="0">',r&&r.length>0){var s=t.Settings.ApprovalStatusTitle,h=t.Settings.PostedByTitle,c=t.Settings.DateTitle,l=t.Settings.CommentTitle;for(e+='<tr><th scope="col">'+s+'<\/th><th scope="col">'+h+'<\/th><th scope="col">'+c+'<\/th><th scope="col">'+l+"<\/th><\/tr>",u=0;u<r.length;u++)e+='<tr><td style="width: 200px;">'+r[u].Status+'<\/td><td style="width: 250px;">'+r[u].Approver+'<\/td><td style="width: 200px;">'+r[u].Date+'<\/td><td style="width: 200px;">'+r[u].Comment+"<\/td><\/tr>"}else e+="<span>"+o+"<\/span>";e+="<\/table>";$(t.Settings.ApprovalHistoryContainerSelector).html(e)}};