(function(){function t(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){n.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",i)},"strings.js");var t=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Department/DepartmentService.svc/GetDepartments/"+_spPageContextInfo.currentUICultureName+"/"+_rbvhContext.EmployeeInfo.FactoryLocation.LookupId;$.ajax({url:t,method:"GET",async:!0,headers:{Accept:"application/json; odata=verbose"},success:function(t){t&&t.length>0&&$("#"+n.Container+" .department-locale").each(function(){var n=$(this).attr("data-id"),i=$(this);$(t).each(function(t,r){r.Id.toString()===n&&i.text(r.DepartmentName)})})},error:function(){status="failed"}})}function i(){$("#viewDetailTHVehicleApproval").text(Res.vehicleManagement_ViewDetail);$("#requesterTHVehicleApproval").text(Res.vehicleManagement_Requester);$("#departmentTHVehicleApproval").text(Res.vehicleManagement_Department);$("#vehicleTypeTHVehicleApproval").text(Res.vehicleManagement_VehicleType);$("#fromTHVehicleApproval").text(Res.vehicleManagement_CommonFrom);$("#toTHVehicleApproval").text(Res.vehicleManagement_CommonTo);$("#reasonTHVehicleApproval").text(Res.vehicleManagement_Reason);$("#approvalStatusTHVehicleApproval").text(Res.vehicleManagement_ApprovalStatus);$("#"+n.Container+" .label-success").text(Res.approvalStatus_Approved);$("#"+n.Container+" .label-warning").text(Res.approvalStatus_Cancelled);$("#"+n.Container+" .label-danger").text(Res.approvalStatus_Rejected);$("#"+n.Container+" .viewDetail").text(Res.vehicleManagement_ViewDetail);$("#vehicle-approval-container tr").find('td:nth(3):contains("Company")').text(Res.vehicleManagement_VehicleType_Choice_Company);$("#vehicle-approval-container tr").find('td:nth(3):contains("Private")').text(Res.vehicleManagement_VehicleType_Choice_Private)}function r(n){var f="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",e='<td class="department-locale" data-id="'+n.CurrentItem.CommonDepartment[0].lookupId+'">'+n.CurrentItem.CommonDepartment[0].lookupValue+"<\/td>",o="<td> "+n.CurrentItem.VehicleType+"<\/td>",s="<td> "+n.CurrentItem.CommonFrom+"<\/td>",h="<td> "+n.CurrentItem.To+"<\/td>",c="<td>"+n.CurrentItem.Reason+"<\/td>",i=window.location.href.split("#")[0],u,t,r;return i=Functions.removeParam("lang",i),i+="#tab2",i=encodeURIComponent(i),u='<td><a href="/Lists/VehicleManagement/EditForm.aspx?subSection=TransportationManagement&ID='+n.CurrentItem.ID+"&Source="+i+'" class="viewDetail" >View Detail<\/a><\/td>',t=n.CurrentItem.ApprovalStatus+"",t=t.toLowerCase(),r="",r=t=="approved"?'<td><span class="label label-success">Approved<\/span><\/td>':t=="cancelled"?'<td><span class="label label-warning">Cancelled<\/span><\/td>':t=="rejected"?'<td><span class="label label-danger">Rejected<\/span><\/td>':t&&t.length>0?'<td><span class="label label-default statusmultilang">'+n.CurrentItem.ApprovalStatus+"<\/span><\/td>":'<td><span class="label label-default">In-Progress<\/span><\/td>',"<tr>"+u+f+e+o+s+h+c+r+"<\/tr>"}function u(n){return ViewUtilities.Paging.InstanceHtml(n)}var n={VehicleManagement_ViewDetail:"View Detail",VehicleManagement_Requester:"Requester",VehicleManagement_Department:"Department",VehicleManagement_VehicleType:"Vehicle Type",VehicleManagement_CommonFrom:"From",VehicleManagement_CommonTo:"To",VehicleManagement_Reason:"Reason",VehicleManagement_ApprovalStatus:"Approval Status",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Locale:"",Container:"vehicle-approval-container"};(function(){var i={};i.Templates={};i.Templates.Item=r;i.OnPreRender=function(){$(".ms-menutoolbar").hide()};i.BaseViewID=1;i.ListTemplateType=10013;i.OnPostRender=t;i.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='viewDetailTHVehicleApproval'>"+n.VehicleManagement_ViewDetail+"<\/th><th id='requesterTHVehicleApproval'>"+n.VehicleManagement_Requester+"<\/th><th id='departmentTHVehicleApproval'>"+n.VehicleManagement_Department+"<\/th><th id='vehicleTypeTHVehicleApproval'>"+n.VehicleManagement_VehicleType+"<\/th><th id='fromTHVehicleApproval'>"+n.VehicleManagement_CommonFrom+"<\/th><th id='toTHVehicleApproval'>"+n.VehicleManagement_CommonTo+"<\/th><th id='reasonTHVehicleApproval'>"+n.VehicleManagement_Reason+"<\/th><th id='approvalStatusTHVehicleApproval'>"+n.VehicleManagement_ApprovalStatus+"<\/th><\/tr><\/thead><tbody>";i.Templates.Footer=u;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(i)})()})(),function(){function t(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){n.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",i)},"strings.js");var t=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Department/DepartmentService.svc/GetDepartments/"+_spPageContextInfo.currentUICultureName+"/"+_rbvhContext.EmployeeInfo.FactoryLocation.LookupId;$.ajax({url:t,method:"GET",async:!0,headers:{Accept:"application/json; odata=verbose"},success:function(t){t&&t.length>0&&$("#"+n.Container+" .department-locale").each(function(){var n=$(this).attr("data-id"),i=$(this);$(t).each(function(t,r){r.Id.toString()===n&&i.text(r.DepartmentName)})})},error:function(){status="failed"}})}function i(){$("#viewDetailTHVehicleDept").text(Res.vehicleManagement_ViewDetail);$("#requesterTHVehicleDept").text(Res.vehicleManagement_Requester);$("#departmentTHVehicleDept").text(Res.vehicleManagement_Department);$("#vehicleTypeTHVehicleDept").text(Res.vehicleManagement_VehicleType);$("#companyPickupTHVehicleDept").text(Res.vehicleManagement_CompanyPickup);$("#fromTHVehicleDept").text(Res.vehicleManagement_CommonFrom);$("#toTHVehicleDept").text(Res.vehicleManagement_CommonTo);$("#reasonTHVehicleDept").text(Res.vehicleManagement_Reason);$("#approvalStatusTHVehicleDept").text(Res.vehicleManagement_ApprovalStatus);$("#"+n.Container+" .label-success").text(Res.approvalStatus_Approved);$("#"+n.Container+" .label-warning").text(Res.approvalStatus_Cancelled);$("#"+n.Container+" .label-danger").text(Res.approvalStatus_Rejected);$("#"+n.Container+" .viewDetail").text(Res.vehicleManagement_ViewDetail);$("#vehicle-bydept-container tr").find('td:nth(3):contains("Company")').text(Res.vehicleManagement_VehicleType_Choice_Company);$("#vehicle-bydept-container tr").find('td:nth(3):contains("Private")').text(Res.vehicleManagement_VehicleType_Choice_Private)}function r(n){var f="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",e='<td class="department-locale" data-id="'+n.CurrentItem.CommonDepartment[0].lookupId+'">'+n.CurrentItem.CommonDepartment[0].lookupValue+"<\/td>",o="<td> "+n.CurrentItem.VehicleType+"<\/td>",s=n.CurrentItem.CompanyPickup[0]==null?" ":n.CurrentItem.CompanyPickup[0].lookupValue,h="<td> "+s+"<\/td>",c="<td> "+n.CurrentItem.CommonFrom+"<\/td>",l="<td> "+n.CurrentItem.To+"<\/td>",a="<td>"+n.CurrentItem.Reason+"<\/td>",i=window.location.href.split("#")[0],u,t,r;return i=Functions.removeParam("lang",i),i+="#tab3",i=encodeURIComponent(i),u='<td><a href="/Lists/VehicleManagement/EditForm.aspx?subSection=TransportationManagement&ID='+n.CurrentItem.ID+"&Source="+i+'" class="viewDetail" >View Detail<\/a><\/td>',t=n.CurrentItem.ApprovalStatus+"",t=t.toLowerCase(),r="",r=t=="approved"?'<td><span class="label label-success">Approved<\/span><\/td>':t=="cancelled"?'<td><span class="label label-warning">Cancelled<\/span><\/td>':t=="rejected"?'<td><span class="label label-danger">Rejected<\/span><\/td>':t&&t.length>0?'<td><span class="label label-default statusmultilang">'+n.CurrentItem.ApprovalStatus+"<\/span><\/td>":'<td><span class="label label-default">In-Progress<\/span><\/td>',"<tr>"+u+f+e+o+h+c+l+a+r+"<\/tr>"}function u(n){return ViewUtilities.Paging.InstanceHtml(n)}var n={VehicleManagement_ViewDetail:"View Detail",VehicleManagement_Requester:"Requester",VehicleManagement_Department:"Department",VehicleManagement_VehicleType:"Vehicle Type",VehicleManagement_CompanyPickup:"Company Pickup",VehicleManagement_CommonFrom:"From",VehicleManagement_CommonTo:"To",VehicleManagement_Reason:"Reason",VehicleManagement_ApprovalStatus:"Approval Status",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Locale:"",Container:"vehicle-bydept-container"};(function(){var i={};i.Templates={};i.Templates.Item=r;i.OnPreRender=function(){$(".ms-menutoolbar").hide()};i.BaseViewID=2;i.ListTemplateType=10013;i.OnPostRender=t;i.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='viewDetailTHVehicleDept'>"+n.VehicleManagement_ViewDetail+"<\/th><th id='requesterTHVehicleDept'>"+n.VehicleManagement_Requester+"<\/th><th id='departmentTHVehicleDept'>"+n.VehicleManagement_Department+"<\/th><th id='vehicleTypeTHVehicleDept'>"+n.VehicleManagement_VehicleType+"<\/th><th id='companyPickupTHVehicleDept'>"+n.VehicleManagement_CompanyPickup+"<\/th><th id='fromTHVehicleDept'>"+n.VehicleManagement_CommonFrom+"<\/th><th id='toTHVehicleDept'>"+n.VehicleManagement_CommonTo+"<\/th><th id='reasonTHVehicleDept'>"+n.VehicleManagement_Reason+"<\/th><th id='approvalStatusTHVehicleDept'>"+n.VehicleManagement_ApprovalStatus+"<\/th><\/tr><\/thead><tbody>";i.Templates.Footer=u;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(i)})()}(),function(){function t(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",i);SP.SOD.registerSod(n.PageResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.PageResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.PageResourceFileName,"Res",r)},"strings.js");$(".cancel-request").click(function(){e($(this).attr("data-id"),$(this));$(this).attr("disabled","true")})}function i(){$("#viewDetailTHVehicleRequestList").text(Res.vehicleManagement_ViewDetail);$("#requesterTHVehicleRequestList").text(Res.vehicleManagement_Requester);$("#vehicleTypeTHVehicleRequestList").text(Res.vehicleManagement_VehicleType);$("#companyPickupTHVehicleRequestList").text(Res.vehicleManagement_CompanyPickup);$("#fromTHVehicleRequestList").text(Res.vehicleManagement_CommonFrom);$("#toTHVehicleRequestList").text(Res.vehicleManagement_CommonTo);$("#reasonTHVehicleRequestList").text(Res.vehicleManagement_Reason);$("#approvalStatusTHVehicleRequestList").text(Res.vehicleManagement_ApprovalStatus);$("#"+n.Container+" .label-success").text(Res.approvalStatus_Approved);$("#"+n.Container+" .label-warning").text(Res.approvalStatus_Cancelled);$("#"+n.Container+" .label-danger").text(Res.approvalStatus_Rejected);$("#"+n.Container+" .cancel-request").text(Res.notOverTimeManagement_CancelRequest);$("#"+n.Container+" .viewDetail").text(Res.vehicleManagement_ViewDetail);$("#vehicle-request-container tr").find('td:nth(2):contains("Company")').text(Res.vehicleManagement_VehicleType_Choice_Company);$("#vehicle-request-container tr").find('td:nth(2):contains("Private")').text(Res.vehicleManagement_VehicleType_Choice_Private)}function r(){n.RequestStatusApproved=Res.requestStatusApproved;n.RequestStatusRejected=Res.requestStatusRejected;n.RequestStatusCancelled=Res.requestStatusCancelled;n.RequestStatusInProgress=Res.requestStatusInProgress}function u(n){var f="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",e="<td> "+n.CurrentItem.VehicleType+"<\/td>",o=n.CurrentItem.CompanyPickup[0]==null?" ":n.CurrentItem.CompanyPickup[0].lookupValue,s="<td> "+o+"<\/td>",h="<td> "+n.CurrentItem.CommonFrom+"<\/td>",c="<td> "+n.CurrentItem.To+"<\/td>",l="<td>"+n.CurrentItem.Reason+"<\/td>",r=window.location.href.split("#")[0],i;r=Functions.removeParam("lang",r);r+="#tab1";r=encodeURIComponent(r);var a='<td><a href="/Lists/VehicleManagement/EditForm.aspx?subSection=TransportationManagement&ID='+n.CurrentItem.ID+"&Source="+r+'" class="viewDetail" >View Detail<\/a><\/td>',t=n.CurrentItem.ApprovalStatus+"",u="<td><button type='button' class='btn btn-default btn-sm cancel-request' disabled  data-id='"+n.CurrentItem.ID+"'>Cancel Request<\/button><\/td>";return t=t.toLowerCase(),i="",t=="approved"?i='<td><span class="label label-success">Approved<\/span><\/td>':t=="cancelled"?i='<td><span class="label label-warning">Cancelled<\/span><\/td>':t=="rejected"?i='<td><span class="label label-danger">Rejected<\/span><\/td>':t&&t.length>0?(i='<td><span class="label label-default statusmultilang">'+n.CurrentItem.ApprovalStatus+"<\/span><\/td>",u="<td><button type='button' class='btn btn-default btn-sm cancel-request'  data-id='"+n.CurrentItem.ID+"'>Cancel Request<\/button><\/td>"):(i='<td><span class="label label-default">In-Progress<\/span><\/td>',u="<td><button type='button' class='btn btn-default btn-sm cancel-request'  data-id='"+n.CurrentItem.ID+"'>Cancel Request<\/button><\/td>"),"<tr>"+a+f+e+s+h+c+l+i+u+"<\/tr>"}function f(n){return ViewUtilities.Paging.InstanceHtml(n)}function e(t){if(o(t),n.ApprovalStatus==="Approved")alert(n.RequestStatusApproved),location.reload();else if(n.ApprovalStatus==="Rejected")alert(n.RequestStatusRejected),location.reload();else if(n.ApprovalStatus==="Cancelled")alert(n.RequestStatusCancelled),location.reload();else if(n.IsInProgress===!1){var u=_spPageContextInfo.webServerRelativeUrl,f=window.location.protocol+"//"+window.location.host+u,i=new SP.ClientContext(f),r=i.get_web().get_lists().getByTitle(String(n.VehicleManagement_ListTitle));i.load(r);this.oListItem=r.getItemById(t);oListItem.set_item("ApprovalStatus","Cancelled");oListItem.update();i.executeQueryAsync(Function.createDelegate(this,function(){location.reload()}),Function.createDelegate(this,function(){}))}}function o(t){var r=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('"+String(n.VehicleManagement_ListTitle)+"')/items("+t+")",i=$.Deferred();return $.ajax({url:r,method:"GET",async:!1,headers:{Accept:"application/json; odata=verbose"},success:function(t){n.ApprovalStatus=t.d.ApprovalStatus;t.d.AuthorId!=t.d.EditorId&&(n.IsInProgress=!0);i.resolve(t.d)},error:function(){status="failed"}}),i.promise()}var n={VehicleManagement_ViewDetail:"View Detail",VehicleManagement_Requester:"Requester",VehicleManagement_VehicleType:"Vehicle Type",VehicleManagement_CompanyPickup:"Company Pickup",VehicleManagement_CommonFrom:"From",VehicleManagement_CommonTo:"To",VehicleManagement_Reason:"Reason",VehicleManagement_ApprovalStatus:"Approval Status",ApprovalStatus:"",RequestStatusApproved:"",RequestStatusRejected:"",RequestStatusCancelled:"",RequestStatusInProgress:"",VehicleManagement_ListTitle:"Vehicle Management",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Container:"vehicle-request-container",IsInProgress:!1};(function(){var i={};i.Templates={};i.Templates.Item=u;i.OnPreRender=function(){$(".ms-menutoolbar").hide()};i.BaseViewID=3;i.ListTemplateType=10013;i.OnPostRender=t;i.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='viewDetailTHVehicleRequestList'>"+n.VehicleManagement_ViewDetail+"<\/th><th id='requesterTHVehicleRequestList'>"+n.VehicleManagement_Requester+"<\/th><th id='vehicleTypeTHVehicleRequestList'>"+n.VehicleManagement_VehicleType+"<\/th><th id='companyPickupTHVehicleRequestList'>"+n.VehicleManagement_CompanyPickup+"<\/th><th id='fromTHVehicleRequestList'>"+n.VehicleManagement_CommonFrom+"<\/th><th id='toTHVehicleRequestList'>"+n.VehicleManagement_CommonTo+"<\/th><th id='reasonTHVehicleRequestList'>"+n.VehicleManagement_Reason+"<\/th><th id='approvalStatusTHVehicleRequestList'>"+n.VehicleManagement_ApprovalStatus+"<\/th><th><\/th><\/tr><\/thead><tbody>";i.Templates.Footer=f;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(i)})()}();