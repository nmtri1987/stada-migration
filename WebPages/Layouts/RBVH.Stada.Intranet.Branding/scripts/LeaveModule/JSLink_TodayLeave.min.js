function LeavePostRender(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){SP.SOD.registerSod(ApprovalConfig.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+ApprovalConfig.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(ApprovalConfig.ListResourceFileName,"Res",OnListResourcesReady)},"strings.js");$(".left-button").click(function(){$(this).attr("disabled","true");updateLeftStatus($(this).attr("data-id"),$(this))})}function OnListResourcesReady(){$("#requesterTH").text(Res.leaveList_Requester);$("#from").text(Res.leaveList_From);$("#to").text(Res.leaveList_To);$("#left").text(Res.leaveList_Leaved);$("#leftAt").text(Res.leaveList_LeavedAt);$("#photo").text(Res.leaveList_Avatar);$(".left-button").text(Res.leaveList_LeftButton)}function CustomItem(n){var i=n.CurrentItem.ID,f=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Employee/EmployeeService.svc/GetAvatar/"+n.CurrentItem.RequestFor[0].lookupId,e=$.ajax({url:f,method:"GET",async:!1,headers:{Accept:"application/json; odata=verbose"}}),t="",a,r,u;e.then(function(n){t=n!=""?"<td id='photo'><div class='customImageAvatar'>"+n+"<\/div><\/td>":"<td id='photo'><div class='customImageAvatar'>"+ApprovalConfig.DefaultAvatar+"<\/div><\/td>"},function(){t="<td  id='photo'><div class='customImageAvatar'>"+ApprovalConfig.DefaultAvatar+"<\/div><\/td>"});var o='<td style="vertical-align: middle;">'+Functions.removeInvalidValue(n.CurrentItem.RequestFor[0].lookupValue)+"<\/td>",s='<td style="vertical-align: middle;">'+n.CurrentItem.CommonFrom+"<\/td>",h='<td style="vertical-align: middle;">'+n.CurrentItem.To+"<\/td>",c='<td style="vertical-align: middle;">'+n.CurrentItem.Left+"<\/td>",v='<td style="vertical-align: middle;">'+n.CurrentItem.LeaveHours+"<\/td>",l="";return l=n.CurrentItem.TransferworkTo&&n.CurrentItem.TransferworkTo[0]&&n.CurrentItem.TransferworkTo[0].lookupValue?'<td style="vertical-align: middle;">'+Functions.removeInvalidValue(n.CurrentItem.TransferworkTo[0].lookupValue)+"<\/td>":'<td style="vertical-align: middle;">&nbsp<\/td>',a='<td style="vertical-align: middle;">'+n.CurrentItem.Reason+"<\/td>",r='<td style="vertical-align: middle;">'+n.CurrentItem.LeftAt+"<\/td>",u=n.CurrentItem["Left.value"]&&n.CurrentItem["Left.value"]==="1"?"<td style='vertical-align: middle;' nowrap><button type='button'  class='btn btn-default btn-sm left-button' disabled data-id='"+i+"'>Left<\/button><\/td>":"<td style='vertical-align: middle;' nowrap><button type='button'   class='btn btn-default btn-sm left-button'  data-id='"+i+"'>Left<\/button><\/td>","<tr>"+t+o+s+h+c+r+u+"<\/tr>"}function pagingControl(n){return ViewUtilities.Paging.InstanceHtml(n)}function updateLeftStatus(n){var t=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('"+String(ApprovalConfig.LaveManagement_ListTitle)+"')/items("+n+")";$.ajax({url:t,method:"GET",async:!1,headers:{Accept:"application/json; odata=verbose"},success:function(t){t&&updateItem(n)},error:function(){}})}function updateItem(n){var u=_spPageContextInfo.webServerRelativeUrl,f=window.location.protocol+"//"+window.location.host+u,t=new SP.ClientContext(f),i=t.get_web().get_lists().getByTitle(String(ApprovalConfig.LaveManagement_ListTitle)),r;t.load(i);this.oListItem=i.getItemById(n);oListItem.set_item("Left",!0);r=new Date;oListItem.set_item("LeftAt",r);oListItem.update();t.executeQueryAsync(Function.createDelegate(this,this.onQuerySucceeded),Function.createDelegate(this,this.onQueryFailed))}function onQuerySucceeded(){location.reload()}function onQueryFailed(){location.reload()}function isLeft(n){var t=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('"+String(ApprovalConfig.LaveManagement_ListTitle)+"')/items("+n+")";$.ajax({url:t,method:"GET",async:!1,headers:{Accept:"application/json; odata=verbose"},success:function(n){return n?n.d.Left:!1},error:function(){return!1}})}var ApprovalConfig={LaveManagement_Requester:"Requester",LaveManagement_From:"From",LaveManagement_To:"To",LeaveManagement_LeftAt:"Left At",LeaveManagement_Left:"Left",LaveManagement_RequesterPhoto:"Photo",LaveManagement_ListTitle:"Leave Management",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",DefaultAvatar:"<img src='/styles/images/DefaultAvatar.jpg'>"};(function(){var n={};n.Templates={};n.Templates.Item=CustomItem;n.OnPreRender=function(){$(".ms-menutoolbar").hide()};n.ListTemplateType=10004;n.OnPostRender=LeavePostRender;n.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='photo'>"+ApprovalConfig.LaveManagement_RequesterPhoto+"<\/th><th id='requesterTH'>"+ApprovalConfig.LaveManagement_Requester+"<\/th><th id='from'>"+ApprovalConfig.LaveManagement_From+"<\/th><th id='to'>"+ApprovalConfig.LaveManagement_To+"<\/th><th id='left'>"+ApprovalConfig.LeaveManagement_Left+"<\/th><th id='leftAt'>"+ApprovalConfig.LeaveManagement_LeftAt+"<\/th><th><\/th><\/tr><\/thead><tbody>";n.Templates.Footer=pagingControl;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(n)})();