function onQuerySucceeded(){location.reload()}function onQueryRejectSucceeded(){location.reload()}function onQueryFailed(){}(function(){function i(t){var i={url:t,width:800,height:400,showClose:!0,allowMaximize:!1,title:n.ViewDetail};SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",i)}function r(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){n.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",u);SP.SOD.registerSod(n.PageResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.PageResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.PageResourceFileName,"Res",f)},"strings.js");$(".approve-request").click(function(){$(this).prop("disabled",!0);s($(this).attr("data-id"),$(this).attr("data-approvalstatus"),$(this).attr("data-emp-id"))});$(".reject-request").click(function(){$(this).prop("disabled",!0);h($(this).attr("data-id"),$(this))});$(".viewdetaildeprequest").click(function(){t=$(this).attr("data-url");i(t)});var t=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Department/DepartmentService.svc/GetDepartments/"+_spPageContextInfo.currentUICultureName+"/"+_rbvhContext.EmployeeInfo.FactoryLocation.LookupId;$.ajax({url:t,method:"GET",async:!0,headers:{Accept:"application/json; odata=verbose"},success:function(t){t&&t.length>0&&$(n.Container+" .department-locale").each(function(){var n=$(this).attr("data-id"),i=$(this);$(t).each(function(t,r){r.Id.toString()===n&&i.text(r.DepartmentName)})})},error:function(){status="failed"}})}function u(){$(n.Container+" #departmentApprovalDepartmentTH").text(Res.notOverTimeManagement_DepartmentName);$(n.Container+" #requesterApprovalDepartmentTH").text(Res.notOverTimeManagement_Requester);$(n.Container+" #hoursperdayApprovalDepartment").text(Res.notOverTimeManagement_HoursPerDay);$(n.Container+" #approvalStatusApprovalDepartment").text(Res.notOverTimeManagement_ApprovalStatus);$(n.Container+" #dateApprovalDepartment").text(Res.notOverTimeManagement_Date);$(n.Container+" #fromApprovalDepartment").text(Res.notOverTimeManagement_From);$(n.Container+" #toApprovalDepartment").text(Res.notOverTimeManagement_To);$(n.Container+" #reasonApprovalDepartment").text(Res.notOverTimeManagement_Reason);$(n.Container+" #viewDetailNOTApprovalDepartment").text(Res.notOvertimeManagement_ViewTitle);$(n.Container+" .label-success").text(Res.approvalStatus_Approved);$(n.Container+" .label-default").text(Res.approvalStatus_InProgress);$(n.Container+" .label-warning").text(Res.approvalStatus_Cancelled);$(n.Container+" .label-danger").text(Res.approvalStatus_Rejected);$(n.Container+" .cancel-request").text(Res.notOverTimeManagement_CancelRequest)}function f(){n.ViewDetail=Res.viewDetail;$(".approve-request").text(Res.approveButton);$(".reject-request").text(Res.rejectButton)}function e(n){var f="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",e="<td> "+n.CurrentItem.CommonDate+"<\/td>",o="<td> "+n.CurrentItem.CommonFrom+"<\/td>",s="<td> "+n.CurrentItem.To+"<\/td>",h='<td class="department-locale" data-id="'+n.CurrentItem.CommonDepartment[0].lookupId+'">'+n.CurrentItem.CommonDepartment[0].lookupValue+"<\/td>",c="<td>"+n.CurrentItem.HoursPerDay+"<\/td>",l="<td>"+n.CurrentItem.Reason+"<\/td>",a='<td><input type="text" class="form-control comment'+n.CurrentItem.ID+'" /><\/td>',t=window.location.href.split("#")[0],r,i,u;return t=Functions.removeParam("lang",t),t+="#tab3",t=encodeURIComponent(t),r='<span><a data-url="/Lists/NotOverTimeManagement/DispForm.aspx?ID='+n.CurrentItem.ID+"&TextOnly=true&Source="+t+'"   class="table-action viewdetaildeprequest"><i class="fa fa-eye" aria-hidden="true"><\/i><\/a><\/span>',r="<td>"+r+"<\/td>",i=n.CurrentItem.ApprovalStatus,i=i.toLowerCase(),u="",u=i=="approved"?'<td><span class="label label-success">Approved<\/span><\/td>':i=="cancelled"?'<td><span class="label label-warning">Cancelled<\/span><\/td>':i=="rejected"?'<td><span class="label label-danger">Rejected<\/span><\/td>':'<td><span class="label label-default">In-Progress<\/span><\/td>',"<tr>"+f+h+c+e+o+s+l+u+r+"<\/tr>"}function o(n){return ViewUtilities.Paging.InstanceHtml(n)}function s(i,r,u){var o;if(t(i),n.ApprovalStatus&&n.ApprovalStatus.toLowerCase()!="cancelled"){n.ItemID=i;var s=_spPageContextInfo.webServerRelativeUrl,h=window.location.protocol+"//"+window.location.host+s,f=new SP.ClientContext(h),e=f.get_web().get_lists().getByTitle(String(n.NotOverTimeManagement_ListTitle));f.load(e);this.oListItem=e.getItemById(i);r==""&&(this.checkIsManager(u),o=$(".comment"+i).val(),oListItem.set_item("CommonComment",o),oListItem.set_item("ApprovalStatus","Approved"),n.ApprovalStatus="Approved");oListItem.update();f.executeQueryAsync(Function.createDelegate(this,this.onQuerySucceeded),Function.createDelegate(this,this.onQueryFailed))}else alert(n.ApproveCancelled)}function h(i){var f;if(t(i),n.ItemID=i,n.ApprovalStatus&&n.ApprovalStatus.toLowerCase()!="cancelled"){var e=_spPageContextInfo.webServerRelativeUrl,o=window.location.protocol+"//"+window.location.host+e,r=new SP.ClientContext(o),u=r.get_web().get_lists().getByTitle(String(n.NotOverTimeManagement_ListTitle));r.load(u);this.oListItem=u.getItemById(i);f=$(".comment"+i).val();oListItem.set_item("CommonComment",f);oListItem.set_item("ApprovalStatus","Rejected");oListItem.update();r.executeQueryAsync(Function.createDelegate(this,this.onQuerySucceeded),Function.createDelegate(this,this.onQueryFailed))}else alert(n.ApproveCancelled)}function t(t){var r=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('"+String(n.NotOverTimeManagement_ListTitle)+"')/items("+t+")",i=$.Deferred();return $.ajax({url:r,method:"GET",async:!1,headers:{Accept:"application/json; odata=verbose"},success:function(t){n.ApprovalStatus=t.d.ApprovalStatus;i.resolve(t.d)},error:function(){status="failed"}}),i.promise()}var n={NotOverTimeManagement_DepartmentName:"Department Name",NotOverTimeManagement_Requester:"Requester",NotOverTimeManagement_HoursPerDay:"Hours per Day",NotOverTimeManagement_To:"To",NotOverTimeManagement_From:"From",Comment:"Comment",NotOverTimeManagement_ApprovalStatus:"Approval Status",NotOverTimeManagement_Date:"Date",NotOverTimeManagement_Reason:"Reason",NotOverTimeManagement_ListTitle:"Leave Of Absence For Overtime Management",NotOvertimeManagement_ViewTitle:"View",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",ItemID:"",ApprovalStatus:"",IsManager:!1,IsManagerServiceUrl:"/_vti_bin/Services/Employee/EmployeeService.svc/IsManager/",Locale:"",ViewDetail:"View item detail",Container:"#leaveOfAbsenceDepartmentContainer"};(function(){var t={};t.Templates={};t.Templates.Item=e;t.OnPreRender=function(){$(".ms-menutoolbar").hide()};t.ListTemplateType=10007;t.BaseViewID=2;t.OnPostRender=r;t.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='requesterApprovalDepartmentTH'>"+n.NotOverTimeManagement_Requester+"<\/th><th id='departmentApprovalDepartmentTH'>"+n.NotOverTimeManagement_DepartmentName+"<\/th><th id='hoursperdayApprovalDepartment'>"+n.NotOverTimeManagement_HoursPerDay+"<\/th><th id='dateApprovalDepartment'>"+n.NotOverTimeManagement_Date+"<\/th><th id='fromApprovalDepartment'>"+n.NotOverTimeManagement_From+"<\/th><th id='toApprovalDepartment'>"+n.NotOverTimeManagement_To+"<\/th><th id='reasonApprovalDepartment'>"+n.NotOverTimeManagement_Reason+"<\/th><th id='approvalStatusApprovalDepartment'>"+n.NotOverTimeManagement_ApprovalStatus+"<\/th><th id='viewDetailNOTApprovalDepartment'>"+n.NotOvertimeManagement_ViewTitle+"<\/th><th><\/th><\/tr><\/thead><tbody>";t.Templates.Footer=o;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(t)})()})();