RBVH.Stada.javascript.common.NamespaceManager.register("RBVH.Stada.WebPages.pages");RBVH.Stada.WebPages.pages.RequestList=function(n){this.Settings={Controls:{}};$.extend(!0,this.Settings,n);this.Initialize()};RBVH.Stada.WebPages.pages.RequestList.prototype={Initialize:function(){var n=this;$(document).ready(function(){SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){n.InitControls();n.RegisterEvents()})})},InitControls:function(){var n=this,t=n.Settings.Controls.ActivedTabSelector,i=$(t).val();n.ActivaTab(i);$(n.Settings.Controls.FromDateControlSelector).datepicker({viewMode:"days",minViewMode:"days",format:"dd/mm/yyyy",autoclose:!0});$(n.Settings.Controls.ToDateControlSelector).datepicker({viewMode:"days",minViewMode:"days",format:"dd/mm/yyyy",autoclose:!0});$(n.Settings.Controls.FromDateErrorMsgSelector).addClass("ms-formvalidation");$(n.Settings.Controls.ToDateErrorMsgSelector).addClass("ms-formvalidation")},RegisterEvents:function(){var n=this;$('a[data-toggle="tab"]').on("shown.bs.tab",function(t){var r=$(t.target).attr("href"),i=n.Settings.Controls.ActivedTabSelector;$(i).val($(this).attr("aria-controls"))});$(n.Settings.Controls.FromDateControlSelector).on("changeDate",function(){n.RefreshPageForDeptAndMonthChanging($(this).val(),$(n.Settings.Controls.ToDateControlSelector).val())});$(n.Settings.Controls.ToDateControlSelector).on("changeDate",function(){n.RefreshPageForDeptAndMonthChanging($(n.Settings.Controls.FromDateControlSelector).val(),$(this).val())});$(n.Settings.Controls.DepartmentSelector).change(function(){n.RefreshPageForDeptAndMonthChanging($(n.Settings.Controls.FromDateControlSelector).val(),$(n.Settings.Controls.ToDateControlSelector).val())});$(".linkAddNewItem").on("click",function(){$(".se-pre-con").fadeIn(0)});RBVH.Stada.WebPages.Utilities.RegisterTabChangeEvent()},ActivaTab:function(n){$('.nav-tabs a[href="#'+n+'"]').tab("show")},RefreshPageForDeptAndMonthChanging:function(n,t){var r=this,s=r.Settings.Controls.ActivedTabSelector,h=$(s).val(),u=r.Settings.Controls.TabParamName,f=r.Settings.Controls.DepartmentParamName,c=r.Settings.Controls.DepartmentSelector,e=r.Settings.Controls.FromDateParamName,o=r.Settings.Controls.ToDateParamName,i=$URI(window.location.href);i.removeQuery(u);i.removeQuery(f);i.removeQuery(e);i.removeQuery(o);i.addQuery(u,h);i.addQuery(f,$(c).val());i.addQuery(e,n);i.addQuery(o,t);window.location.href=i.toString()}};