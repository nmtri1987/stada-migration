(function(){function i(t){var i={url:t,width:800,height:400,showClose:!0,allowMaximize:!1,title:n.ViewDetail};SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",i)}function r(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){n.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",u);SP.SOD.registerSod(n.PageResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.PageResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.PageResourceFileName,"Res",f)},"strings.js");$(".approve-requestTask").click(function(){$(this).prop("disabled",!0);s($(this).attr("data-id"))});$(".reject-requestTask").click(function(){$(this).prop("disabled",!0);h($(this).attr("data-id"))});$(".viewdetailapproval").click(function(){t=$(this).attr("data-url");i(t)});var t=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Department/DepartmentService.svc/GetDepartments/"+_spPageContextInfo.currentUICultureName+"/"+_rbvhContext.EmployeeInfo.FactoryLocation.LookupId;$.ajax({url:t,method:"GET",async:!0,headers:{Accept:"application/json; odata=verbose"},success:function(t){t&&t.length>0&&$(n.Container+" .department-localeTask").each(function(){var n=$(this).attr("data-id"),i=$(this);$(t).each(function(t,r){r.Id.toString()===n&&i.text(r.DepartmentName)})})},error:function(){status="failed"}})}function u(){$(n.Container+" #departmentApprovalTH").text(Res.notOverTimeManagement_DepartmentName);$(n.Container+" #requesterApprovalTH").text(Res.notOverTimeManagement_Requester);$(n.Container+" #hoursperdayApprovalTH").text(Res.notOverTimeManagement_HoursPerDay);$(n.Container+" #approvalStatusApprovalTH").text(Res.notOverTimeManagement_ApprovalStatus);$(n.Container+" #dateApprovalTH").text(Res.notOverTimeManagement_Date);$(n.Container+" #fromApprovalTH").text(Res.notOverTimeManagement_From);$(n.Container+" #toApprovalTH").text(Res.notOverTimeManagement_To);$(n.Container+" #reasonApprovalTH").text(Res.notOverTimeManagement_Reason);$(n.Container+" #viewDetailNOTApprovalTH").text(Res.notOvertimeManagement_ViewTitle);$(n.Container+" #commentApprovalTH").text(Res.commonComment);$(n.Container+" .label-success").text(Res.approvalStatus_Approved);$(n.Container+" .label-default").text(Res.approvalStatus_InProgress);$(n.Container+" .label-warning").text(Res.approvalStatus_Cancelled);$(n.Container+" .label-danger").text(Res.approvalStatus_Rejected);$(n.Container+" .cancel-request").text(Res.notOverTimeManagement_CancelRequest)}function f(){n.ViewDetail=Res.viewDetail;$(".approve-requestTask").text(Res.approveButton);$(".reject-requestTask").text(Res.rejectButton)}function e(n){var u="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",f="<td> "+n.CurrentItem.CommonDate+"<\/td>",e="<td> "+n.CurrentItem.CommonFrom+"<\/td>",o="<td> "+n.CurrentItem.To+"<\/td>",s='<td class="department-localeTask" data-id="'+n.CurrentItem.CommonDepartment[0].lookupId+'">'+n.CurrentItem.CommonDepartment[0].lookupValue+"<\/td>",h="<td>"+n.CurrentItem.HoursPerDay+"<\/td>",c="<td>"+n.CurrentItem.Reason+"<\/td>",l='<td><input type="text" class="form-control comment'+n.CurrentItem.ID+'" /><\/td>',t=window.location.href.split("#")[0],i;t=Functions.removeParam("lang",t);t+="#tab2";t=encodeURIComponent(t);i='<span><a data-url="/Lists/NotOverTimeManagement/DispForm.aspx?ID='+n.CurrentItem.ID+"&TextOnly=true&Source="+t+'"   class="table-action viewdetailapproval"><i class="fa fa-eye" aria-hidden="true"><\/i><\/a><\/span>';i="<td>"+i+"<\/td>";var r="",a="<button type='button' class='btn btn-success btn-sm approve-requestTask' data-approvalStatus='"+n.CurrentItem.ApprovalStatus+"'  data-id='"+n.CurrentItem.ID+"' data-emp-id='"+n.CurrentItem.Requester[0].lookupId+"' "+r+">Approve<\/button>",v="<button type='button' class='btn btn-default btn-sm reject-requestTask'  data-id='"+n.CurrentItem.ID+"' "+r+">Reject<\/button>",y="<td>"+a+"   "+v+"<td>";return"<tr>"+u+s+h+f+e+o+c+i+l+y+"<\/tr>"}function o(n){return ViewUtilities.Paging.InstanceHtml(n)}function s(i){var r={},u;r.Id=i;r.Comment=$(".comment"+i).val();r.ApproverName=_rbvhContext.EmployeeInfo.FullName;r.ApproverId=_rbvhContext.EmployeeInfo.ADAccount.ID;u=RBVH.Stada.WebPages.Utilities.String.format(n.ApproveRequest,location.host);$.ajax({type:"POST",url:u,data:JSON.stringify(r),contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(n){n.Code===2&&alert(n.Message);t()})}function h(i){var r={},u;r.Id=i;r.Comment=$(".comment"+i).val();r.ApproverName=_rbvhContext.EmployeeInfo.FullName;r.ApproverId=_rbvhContext.EmployeeInfo.ADAccount.ID;u=RBVH.Stada.WebPages.Utilities.String.format(n.RejectRequest,location.host);$.ajax({type:"POST",url:u,data:JSON.stringify(r),contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(n){n.Code===3&&alert(n.Message);t()})}function t(){var n=Functions.getParameterByName("Source");n?Functions.redirectToSource():window.location.reload()}var n={NotOverTimeManagement_DepartmentName:"Department Name",NotOverTimeManagement_Requester:"Requester",NotOverTimeManagement_HoursPerDay:"Hours per Day",NotOverTimeManagement_To:"To",NotOverTimeManagement_From:"From",Comment:"Comment",NotOverTimeManagement_Date:"Date",NotOverTimeManagement_Reason:"Reason",NotOverTimeManagement_ListTitle:"Leave Of Absence For Overtime Management",NotOvertimeManagement_ViewTitle:"View",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",ApproveRequest:"//{0}/_vti_bin/Services/NotOverTimeManagement/NotOverTimeManagementService.svc/Approve",RejectRequest:"//{0}/_vti_bin/Services/NotOverTimeManagement/NotOverTimeManagementService.svc/Reject",Locale:"",ViewDetail:"View item detail",Container:"#leaveOfAbsenceApprovalContainer"};(function(){var t={};t.Templates={};t.Templates.Item=e;t.OnPreRender=function(){$(".ms-menutoolbar").hide()};t.ListTemplateType=10007;t.BaseViewID=4;t.OnPostRender=r;t.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='requesterApprovalTH'>"+n.NotOverTimeManagement_Requester+"<\/th><th id='departmentApprovalTH'>"+n.NotOverTimeManagement_DepartmentName+"<\/th><th id='hoursperdayApprovalTH'>"+n.NotOverTimeManagement_HoursPerDay+"<\/th><th id='dateApprovalTH'>"+n.NotOverTimeManagement_Date+"<\/th><th id='fromApprovalTH'>"+n.NotOverTimeManagement_From+"<\/th><th id='toApprovalTH'>"+n.NotOverTimeManagement_To+"<\/th><th id='reasonApprovalTH'>"+n.NotOverTimeManagement_Reason+"<\/th><th id='viewDetailNOTApprovalTH'>"+n.NotOvertimeManagement_ViewTitle+"<\/th><th id='commentApprovalTH'>"+n.Comment+"<\/th><th><\/th><\/tr><\/thead><tbody>";t.Templates.Footer=o;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(t)})()})();