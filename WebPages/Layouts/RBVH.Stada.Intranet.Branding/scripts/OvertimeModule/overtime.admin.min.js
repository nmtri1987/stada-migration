(function(){RBVH.Stada.javascript.common.NamespaceManager.register("RBVH.Stada.WebPages.pages");RBVH.Stada.WebPages.pages.MyOvertime=function(n){var t=window.location.pathname;this.Settings={Id:n.Id,BeginDate:21,PageUrl:"//{0}"+t+"?StartMonth={1}&EndMonth={2}"};$.extend(!0,this.Settings,n);this.Initialize()};RBVH.Stada.WebPages.pages.MyOvertime.prototype={Initialize:function(){var n=this;$(document).ready(function(){n.InitControls();n.RegisterEvents()})},InitControls:function(){var t=this,n,i,r;if($(t.Settings.MonthControlSelector).datepicker({viewMode:"months",minViewMode:"months",format:"mm/yyyy",autoclose:!0}),n=RBVH.Stada.WebPages.Utilities.GetValueByParam("MyStartMonth"),i=RBVH.Stada.WebPages.Utilities.GetValueByParam("MyEndMonth"),!!n==!1||!!i==!1)t.RebindUrl(n,i);else if(r=Date.parse(n),r!=NaN){var u=new Date(r),f=u.getMonth()+1,e=u.getFullYear();$(t.Settings.MonthControlSelector).val(f+"/"+e)}},RegisterEvents:function(){var n=this;$(n.Settings.MonthControlSelector).on("changeDate",function(t){var i=t.date.getMonth(),r=t.date.getYear()+1900,u,f;$(".datepicker").hide();u=new Date(r,i,1);f=new Date(r,i+1,0,23,59,59);n.RebindUrl(n.toISOStringTZ(u),n.toISOStringTZ(f),!0)})},toISOStringTZ:function(n){var t=(new Date).getTimezoneOffset()*6e4;return new Date(n.getTime()-t).toISOString().slice(0,-1)},RebindUrl:function(n,t){var s=this,o=window.location.hash,i=window.location.href.split("#")[0],f=new Date,u=n,r,e;u=typeof u!="undefined"?u:s.toISOStringTZ(new Date(f.getFullYear(),f.getMonth(),1));r=t;r=typeof r!="undefined"?r:s.toISOStringTZ(new Date(f.getFullYear(),f.getMonth()+1,0,23,59,59));e="";e="";e=i.indexOf("?")>=0?"&":"?";i=i.indexOf("MyStartMonth=")>0?i.replace(/(MyStartMonth=)[^\&]+/,"$1"+u):i+e+"MyStartMonth="+u;i=i.indexOf("MyEndMonth=")>0?i.replace(/(MyEndMonth=)[^\&]+/,"$1"+r):i+"&MyEndMonth="+r;o&&o.length>0&&(i+=o);window.location.href=i}}})();RBVH.Stada.javascript.common.NamespaceManager.register("RBVH.Stada.WebPages.pages");RBVH.Stada.WebPages.pages.OvertimeByDepartment=function(n){var t=window.location.pathname;this.Settings={Id:n.Id,BeginDate:21,PageUrl:window.location.protocol+"//{0}"+t+"?Month={1}&Year={2}",DepartmentList:window.location.protocol+"//{0}/_vti_bin/Services/Department/DepartmentService.svc/GetDepartmentsByLcid/{1}/{2}",CurrentDepartmentId:0};$.extend(!0,this.Settings,n);this.Initialize()};RBVH.Stada.WebPages.pages.OvertimeByDepartment.prototype={Initialize:function(){var n=this;$(document).ready(function(){SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){n.InitControls();n.RegisterEvents()})})},InitControls:function(){var n=this;$(n.Settings.FromDateControlSelector).datepicker({viewMode:"days",minViewMode:"days",format:"dd/mm/yyyy",autoclose:!0});$(n.Settings.ToDateControlSelector).datepicker({viewMode:"days",minViewMode:"days",format:"dd/mm/yyyy",autoclose:!0});n.PopulateDepartment();var t=RBVH.Stada.WebPages.Utilities.GetValueByParam("AdminFromDate"),i=RBVH.Stada.WebPages.Utilities.GetValueByParam("AdminToDate"),r=n.Settings.CurrentDepartmentId>0?n.Settings.CurrentDepartmentId:RBVH.Stada.WebPages.Utilities.GetValueByParam("AdminDeptId");!!t==!1||!!i==!1||!!r==!1?n.RebindUrl(t,i,r):(n.Settings.DepartmentId=r,n.Settings.FromDate=t,n.Settings.ToDate=i,$(n.Settings.DepartmentControlSelector).val(r),$(n.Settings.FromDateControlSelector).val(t),$(n.Settings.ToDateControlSelector).val(i),n.Settings.CurrentDepartmentId>0&&$(n.Settings.DepartmentControlSelector).prop("disabled",!0))},RegisterEvents:function(){var n=this;$(n.Settings.FromDateControlSelector).on("changeDate",function(){n.RebindUrl($(this).val(),n.Settings.ToDate,n.Settings.DepartmentId,!0)});$(n.Settings.ToDateControlSelector).on("changeDate",function(){n.RebindUrl(n.Settings.FromDate,$(this).val(),n.Settings.DepartmentId,!0)});$(n.Settings.DepartmentControlSelector).on("change",function(){n.Settings.DepartmentId=$(this).val();n.RebindUrl(n.Settings.FromDate,n.Settings.ToDate,n.Settings.DepartmentId,!0)})},PopulateDepartment:function(){var n=this,t=_spPageContextInfo.currentLanguage,i=_rbvhContext.EmployeeInfo!=null?_rbvhContext.EmployeeInfo.FactoryLocation.LookupId:2,r=RBVH.Stada.WebPages.Utilities.String.format(n.Settings.DepartmentList,location.host,t,i);$(n.Settings.DepartmentControlSelector).attr("disabled",!1);$(n.Settings.DepartmentControlSelector).empty();$.ajax({type:"GET",url:r,contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(t){n.Settings.CurrentDepartmentId==0&&$(n.Settings.DepartmentControlSelector).append($("<option>").attr("value",n.Settings.CurrentDepartmentId).text(Functions.getDisplayTextOfItemAll(_spPageContextInfo.currentLanguage)));$(t).each(function(){$(n.Settings.DepartmentControlSelector).append($("<option>").attr("value",this.Id).text(this.DepartmentName))});n.Settings.DepartmentId=$(n.Settings.DepartmentControlSelector).val()}})},toISOStringTZ:function(n){var t=(new Date).getTimezoneOffset()*6e4;return new Date(n.getTime()-t).toISOString().slice(0,-1)},RebindUrl:function(n,t,i,r){var l=this,h=window.location.hash,u=window.location.href.split("#")[0],f=new Date,s=n,e,o,c;s=typeof s!="undefined"?s:l.toISOStringTZ(new Date(f.getFullYear(),f.getMonth(),f.getDay()));e=t;e=typeof e!="undefined"?e:l.toISOStringTZ(new Date(f.getFullYear(),f.getMonth(),f.getDay()));o=i;o=typeof o!="undefined"?o:"0";c="";c=u.indexOf("?")>=0?"&":"?";u=u.indexOf("AdminFromDate=")>0?u.replace(/(AdminFromDate=)[^\&]+/,"$1"+s):u+c+"AdminFromDate="+s;u=u.indexOf("AdminToDate=")>0?u.replace(/(AdminToDate=)[^\&]+/,"$1"+e):u+"&AdminToDate="+e;u=u.indexOf("AdminDeptId=")>0?u.replace(/(AdminDeptId=)[^\&]+/,"$1"+o):u+"&AdminDeptId="+o;!r||(u=ViewUtilities.Paging.RemovePagingURL(u));h&&h.length>0&&(u+=h);window.location.href=u}};