(function(){function t(n){return ViewUtilities.Paging.InstanceHtml(n)}function i(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){n.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",r)},"strings.js");var t=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Department/DepartmentService.svc/GetDepartments/"+_spPageContextInfo.currentUICultureName+"/"+_rbvhContext.EmployeeInfo.FactoryLocation.LookupId;$.ajax({url:t,method:"GET",async:!0,headers:{Accept:"application/json; odata=verbose"},success:function(t){t&&t.length>0&&$("#"+n.Container+" .department-locale").each(function(){var n=$(this).attr("data-id"),i=$(this);$(t).each(function(t,r){r.Id.toString()===n&&i.text(r.DepartmentName)})})},error:function(){status="failed"}})}function r(){$("#viewDetailTH_businessTripApproval").text(Res.businessTripManagement_ViewDetail);$("#requesterTH_businessTripApproval").text(Res.businessTripManagement_RequesterTitle);$("#departmentTH_businessTripApproval").text(Res.overtime_Department);$("#businessTripType_businessTripApproval").text(Res.businessTripManagement_BusinessTripTypeTitle);$("#purpose_businessTripApproval").text(Res.businessTripManagement_PurposeTitle);$("#createdTH_businessTripApproval").text(Res.createdDate);$("#approvalStatusTH_businessTripApproval").text(Res.approval_Status);$("#"+n.Container+" .viewDetail").text(Res.businessTripManagement_ViewDetail);$(".label-success").text(Res.approvalStatus_Approved);$(".label-warning").text(Res.approvalStatus_Cancelled);$(".label-danger").text(Res.approvalStatus_Rejected);$(".internal-trip").html(Res.businessTripManagement_BusinessTripTypeInternalTitle);$(".external-trip").html(Res.businessTripManagement_BusinessTripTypeExternalTitle)}function u(n){var f="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",e='<td class="department-locale" data-id="'+n.CurrentItem.CommonDepartment[0].lookupId+'">'+n.CurrentItem.CommonDepartment[0].lookupValue+"<\/td>",o=n.CurrentItem["Domestic.value"]&&n.CurrentItem["Domestic.value"]==="1"?'<td class="internal-trip"><\/td>':'<td class="external-trip"><\/td>',s=n.CurrentItem.BusinessTripPurpose!=null?"<td>"+n.CurrentItem.BusinessTripPurpose+"<\/td>":"<td><\/td>",h="<td>"+n.CurrentItem.Created+"<\/td>",c=n.CurrentItem.CommonComment!=null?"<td>"+Functions.parseComment(n.CurrentItem.CommonComment)+"<\/td>":"<td><\/td>",t=n.CurrentItem.ApprovalStatus+"",r,i,u;return t=t.toLowerCase(),r="",i=window.location.href.split("#")[0],i=Functions.removeParam("lang",i),i+="#tab2",i=encodeURIComponent(i),u='<td><a href="/SitePages/BusinessTripRequest.aspx?subSection=BusinessTripManagement&itemId='+n.CurrentItem.ID+"&Source="+i+'"   class="viewDetail" >View Detail<\/a><\/td>',r=t=="approved"?'<td><span class="label label-success">Approved<\/span><\/td>':t=="cancelled"?'<td><span class="label label-warning">Cancelled<\/span><\/td>':t=="rejected"?'<td><span class="label label-danger">Rejected<\/span><\/td>':t&&t.length>0?'<td><span class="label label-default statusmultilang">'+n.CurrentItem.ApprovalStatus+"<\/span><\/td>":'<td><span class="label label-default">In-Progress<\/span><\/td>',"<tr>"+u+f+e+o+s+h+r+"<\/tr>"}var n={BusinessTripManagement_ViewDetail:"View Detail",BusinessTripManagement_Requester:"Requester",BusinessTripManagement_Department:"Department",BusinessTripManagement_PurposeTitle:"Purpose",BusinessTripManagement_BusinessTripTypeTitle:"Business trip type",BusinessTripManagement_Created:"Created",BusinessTripManagement_ApprovalStatus:"Approval status",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Locale:"",Container:"business-trip-approval-container"};(function(){var r={};r.Templates={};r.Templates.Item=u;r.OnPreRender=function(){$(".ms-menutoolbar").hide()};r.ListTemplateType=10059;r.BaseViewID=3;r.OnPostRender=i;r.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='viewDetailTH_businessTripApproval'>"+n.BusinessTripManagement_ViewDetail+"<\/th><th id='requesterTH_businessTripApproval'>"+n.BusinessTripManagement_Requester+"<\/th><th id='departmentTH_businessTripApproval'>"+n.BusinessTripManagement_Department+"<\/th><th id='businessTripType_businessTripApproval'>"+n.BusinessTripManagement_BusinessTripTypeTitle+"<\/th><th id='purpose_businessTripApproval'>"+n.BusinessTripManagement_PurposeTitle+"<\/th><th id='createdTH_businessTripApproval'>"+n.BusinessTripManagement_Created+"<\/th><th id='approvalStatusTH_businessTripApproval'>"+n.BusinessTripManagement_ApprovalStatus+"<\/th><th><\/th><\/tr><\/thead><tbody>";r.Templates.Footer=t;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(r)})()})(),function(){function t(n){return ViewUtilities.Paging.InstanceHtml(n)}function i(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){n.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",r)},"strings.js");var t=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Department/DepartmentService.svc/GetDepartments/"+_spPageContextInfo.currentUICultureName+"/"+_rbvhContext.EmployeeInfo.FactoryLocation.LookupId;$.ajax({url:t,method:"GET",async:!0,headers:{Accept:"application/json; odata=verbose"},success:function(t){t&&t.length>0&&$("#"+n.Container+" .department-locale").each(function(){var n=$(this).attr("data-id"),i=$(this);$(t).each(function(t,r){r.Id.toString()===n&&i.text(r.DepartmentName)})})},error:function(){status="failed"}})}function r(){$("#viewDetailTH_businessTripByDept").text(Res.businessTripManagement_ViewDetail);$("#requesterTH_businessTripByDept").text(Res.businessTripManagement_RequesterTitle);$("#departmentTH_businessTripByDept").text(Res.overtime_Department);$("#businessTripType_businessTripByDept").text(Res.businessTripManagement_BusinessTripTypeTitle);$("#purpose_businessTripByDept").text(Res.businessTripManagement_PurposeTitle);$("#createdTH_businessTripByDept").text(Res.createdDate);$("#commentTH_businessTripByDept").text(Res.commonComment);$("#approvalStatusTH_businessTripByDept").text(Res.approval_Status);$("#"+n.Container+" .viewDetail").text(Res.businessTripManagement_ViewDetail);$(".label-success").text(Res.approvalStatus_Approved);$(".label-warning").text(Res.approvalStatus_Cancelled);$(".label-danger").text(Res.approvalStatus_Rejected);$(".internal-trip").html(Res.businessTripManagement_BusinessTripTypeInternalTitle);$(".external-trip").html(Res.businessTripManagement_BusinessTripTypeExternalTitle)}function u(n){var f="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",e='<td class="department-locale" data-id="'+n.CurrentItem.CommonDepartment[0].lookupId+'">'+n.CurrentItem.CommonDepartment[0].lookupValue+"<\/td>",o=n.CurrentItem["Domestic.value"]&&n.CurrentItem["Domestic.value"]==="1"?'<td class="internal-trip"><\/td>':'<td class="external-trip"><\/td>',s=n.CurrentItem.BusinessTripPurpose!=null?"<td>"+n.CurrentItem.BusinessTripPurpose+"<\/td>":"<td><\/td>",h="<td>"+n.CurrentItem.Created+"<\/td>",c=n.CurrentItem.CommonComment!=null?"<td>"+Functions.parseComment(n.CurrentItem.CommonComment)+"<\/td>":"<td><\/td>",t=n.CurrentItem.ApprovalStatus+"",r,i,u;return t=t.toLowerCase(),r="",i=window.location.href.split("#")[0],i=Functions.removeParam("lang",i),i+="#tab3",i=encodeURIComponent(i),u='<td><a href="/SitePages/BusinessTripRequest.aspx?subSection=BusinessTripManagement&itemId='+n.CurrentItem.ID+"&Source="+i+'"   class="viewDetail" >View Detail<\/a><\/td>',r=t=="approved"?'<td><span class="label label-success">Approved<\/span><\/td>':t=="cancelled"?'<td><span class="label label-warning">Cancelled<\/span><\/td>':t=="rejected"?'<td><span class="label label-danger">Rejected<\/span><\/td>':t&&t.length>0?'<td><span class="label label-default statusmultilang">'+n.CurrentItem.ApprovalStatus+"<\/span><\/td>":'<td><span class="label label-default">In-Progress<\/span><\/td>',"<tr>"+u+f+e+o+s+h+c+r+"<\/tr>"}var n={BusinessTripManagement_ViewDetail:"View Detail",BusinessTripManagement_Requester:"Requester",BusinessTripManagement_Department:"Department",BusinessTripManagement_PurposeTitle:"Purpose",BusinessTripManagement_BusinessTripTypeTitle:"Business trip type",BusinessTripManagement_Created:"Created",BusinessTripManagement_Comment:"Comment",BusinessTripManagement_ApprovalStatus:"Approval status",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Locale:"",Container:"businesstrip-bydepartment-container"};(function(){var r={};r.Templates={};r.Templates.Item=u;r.OnPreRender=function(){$(".ms-menutoolbar").hide()};r.ListTemplateType=10059;r.BaseViewID=4;r.OnPostRender=i;r.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='viewDetailTH_businessTripByDept'>"+n.BusinessTripManagement_ViewDetail+"<\/th><th id='requesterTH_businessTripByDept'>"+n.BusinessTripManagement_Requester+"<\/th><th id='departmentTH_businessTripByDept'>"+n.BusinessTripManagement_Department+"<\/th><th id='businessTripType_businessTripByDept'>"+n.BusinessTripManagement_BusinessTripTypeTitle+"<\/th><th id='purpose_businessTripByDept'>"+n.BusinessTripManagement_PurposeTitle+"<\/th><th id='createdTH_businessTripByDept'>"+n.BusinessTripManagement_Created+"<\/th><th id='commentTH_businessTripByDept'>"+n.BusinessTripManagement_Comment+"<\/th><th id='approvalStatusTH_businessTripByDept'>"+n.BusinessTripManagement_ApprovalStatus+"<\/th><th><\/th><\/tr><\/thead><tbody>";r.Templates.Footer=t;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(r)})()}(),function(){function t(n){return ViewUtilities.Paging.InstanceHtml(n)}function i(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){n.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",r)},"strings.js");var t=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Department/DepartmentService.svc/GetDepartments/"+_spPageContextInfo.currentUICultureName+"/"+_rbvhContext.EmployeeInfo.FactoryLocation.LookupId;$.ajax({url:t,method:"GET",async:!0,headers:{Accept:"application/json; odata=verbose"},success:function(t){t&&t.length>0&&$("#"+n.Container+" .department-locale").each(function(){var n=$(this).attr("data-id"),i=$(this);$(t).each(function(t,r){r.Id.toString()===n&&i.text(r.DepartmentName)})})},error:function(){status="failed"}})}function r(){$("#viewDetailTH_businessTripByExtAdmin").text(Res.businessTripManagement_ViewDetail);$("#requesterTH_businessTripByExtAdmin").text(Res.businessTripManagement_RequesterTitle);$("#departmentTH_businessTripByExtAdmin").text(Res.overtime_Department);$("#businessTripType_businessTripByExtAdmin").text(Res.businessTripManagement_BusinessTripTypeTitle);$("#purpose_businessTripByExtAdmin").text(Res.businessTripManagement_PurposeTitle);$("#createdTH_businessTripByExtAdmin").text(Res.createdDate);$("#commentTH_businessTripByExtAdmin").text(Res.commonComment);$("#approvalStatusTH_businessTripByExtAdmin").text(Res.approval_Status);$("#"+n.Container+" .viewDetail").text(Res.businessTripManagement_ViewDetail);$(".label-success").text(Res.approvalStatus_Approved);$(".label-warning").text(Res.approvalStatus_Cancelled);$(".label-danger").text(Res.approvalStatus_Rejected);$(".internal-trip").html(Res.businessTripManagement_BusinessTripTypeInternalTitle);$(".external-trip").html(Res.businessTripManagement_BusinessTripTypeExternalTitle)}function u(n){var f="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",e='<td class="department-locale" data-id="'+n.CurrentItem.CommonDepartment[0].lookupId+'">'+n.CurrentItem.CommonDepartment[0].lookupValue+"<\/td>",o=n.CurrentItem["Domestic.value"]&&n.CurrentItem["Domestic.value"]==="1"?'<td class="internal-trip"><\/td>':'<td class="external-trip"><\/td>',s=n.CurrentItem.BusinessTripPurpose!=null?"<td>"+n.CurrentItem.BusinessTripPurpose+"<\/td>":"<td><\/td>",h="<td>"+n.CurrentItem.Created+"<\/td>",c=n.CurrentItem.CommonComment!=null?"<td>"+Functions.parseComment(n.CurrentItem.CommonComment)+"<\/td>":"<td><\/td>",t=n.CurrentItem.ApprovalStatus+"",r,i,u;return t=t.toLowerCase(),r="",i=window.location.href.split("#")[0],i=Functions.removeParam("lang",i),i+="#tab3",i=encodeURIComponent(i),u='<td><a href="/SitePages/BusinessTripRequest.aspx?subSection=BusinessTripManagement&itemId='+n.CurrentItem.ID+"&Source="+i+'"   class="viewDetail" >View Detail<\/a><\/td>',r=t=="approved"?'<td><span class="label label-success">Approved<\/span><\/td>':t=="cancelled"?'<td><span class="label label-warning">Cancelled<\/span><\/td>':t=="rejected"?'<td><span class="label label-danger">Rejected<\/span><\/td>':t&&t.length>0?'<td><span class="label label-default statusmultilang">'+n.CurrentItem.ApprovalStatus+"<\/span><\/td>":'<td><span class="label label-default">In-Progress<\/span><\/td>',"<tr>"+u+f+e+o+s+h+c+r+"<\/tr>"}var n={BusinessTripManagement_ViewDetail:"View Detail",BusinessTripManagement_Requester:"Requester",BusinessTripManagement_Department:"Department",BusinessTripManagement_PurposeTitle:"Purpose",BusinessTripManagement_BusinessTripTypeTitle:"Business trip type",BusinessTripManagement_Created:"Created",BusinessTripManagement_Comment:"Comment",BusinessTripManagement_ApprovalStatus:"Approval status",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Locale:"",Container:"businesstrip-by-ext-admin-container"};(function(){var r={};r.Templates={};r.Templates.Item=u;r.OnPreRender=function(){$(".ms-menutoolbar").hide()};r.ListTemplateType=10059;r.BaseViewID=4;r.OnPostRender=i;r.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='viewDetailTH_businessTripByExtAdmin'>"+n.BusinessTripManagement_ViewDetail+"<\/th><th id='requesterTH_businessTripByExtAdmin'>"+n.BusinessTripManagement_Requester+"<\/th><th id='departmentTH_businessTripByExtAdmin'>"+n.BusinessTripManagement_Department+"<\/th><th id='businessTripType_businessTripByExtAdmin'>"+n.BusinessTripManagement_BusinessTripTypeTitle+"<\/th><th id='purpose_businessTripByExtAdmin'>"+n.BusinessTripManagement_PurposeTitle+"<\/th><th id='createdTH_businessTripByExtAdmin'>"+n.BusinessTripManagement_Created+"<\/th><th id='commentTH_businessTripByExtAdmin'>"+n.BusinessTripManagement_Comment+"<\/th><th id='approvalStatusTH_businessTripByExtAdmin'>"+n.BusinessTripManagement_ApprovalStatus+"<\/th><th><\/th><\/tr><\/thead><tbody>";r.Templates.Footer=t;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(r)})()}(),function(){function t(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){n.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",i)},"strings.js");var t=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Department/DepartmentService.svc/GetDepartments/"+_spPageContextInfo.currentUICultureName+"/"+_rbvhContext.EmployeeInfo.FactoryLocation.LookupId;$.ajax({url:t,method:"GET",async:!0,headers:{Accept:"application/json; odata=verbose"},success:function(t){t&&t.length>0&&$("#"+n.Container+" .department-locale").each(function(){var n=$(this).attr("data-id"),i=$(this);$(t).each(function(t,r){r.Id.toString()===n&&i.text(r.DepartmentName)})})},error:function(){status="failed"}})}function i(){$("#businessTrip-cashier-detail").text(Res.businessTripManagement_ViewDetail);$("#businessTrip-cashier-requester").text(Res.businessTripManagement_RequesterTitle);$("#businessTrip-cashier-department").text(Res.overtime_Department);$("#businessTrip-cashier-businessTripType").text(Res.businessTripManagement_BusinessTripTypeTitle);$("#businessTrip-cashier-purpose").text(Res.businessTripManagement_PurposeTitle);$("#businessTrip-cashier-created").text(Res.createdDate);$("#businessTrip-cashier-comment").text(Res.commonComment);$("#businessTrip-cashier-status").text(Res.businessTripManagement_ApprovalStatus);$("#"+n.Container+" .viewDetail").text(Res.businessTripManagement_ViewDetail);$(".label-success").text(Res.approvalStatus_Approved);$(".label-warning").text(Res.approvalStatus_Cancelled);$(".label-danger").text(Res.approvalStatus_Rejected);$(".internal-trip").html(Res.businessTripManagement_BusinessTripTypeInternalTitle);$(".external-trip").html(Res.businessTripManagement_BusinessTripTypeExternalTitle)}function r(n){var f="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",e='<td class="department-locale" data-id="'+n.CurrentItem.CommonDepartment[0].lookupId+'">'+n.CurrentItem.CommonDepartment[0].lookupValue+"<\/td>",o="<td>"+n.CurrentItem.Created+"<\/td>",s=n.CurrentItem.CommonComment!=null?"<td>"+Functions.parseComment(n.CurrentItem.CommonComment)+"<\/td>":"<td><\/td>",h=n.CurrentItem["Domestic.value"]&&n.CurrentItem["Domestic.value"]==="1"?'<td class="internal-trip"><\/td>':'<td class="external-trip"><\/td>',c=n.CurrentItem.BusinessTripPurpose!=null?"<td>"+n.CurrentItem.BusinessTripPurpose+"<\/td>":"<td><\/td>",i=window.location.href.split("#")[0],u,t,r;return i=Functions.removeParam("lang",i),i+="#tab4",i=encodeURIComponent(i),u='<td><a href="/SitePages/BusinessTripRequest.aspx?subSection=BusinessTripManagement&itemId='+n.CurrentItem.ID+"&Source="+i+'"   class="viewDetail" >View Detail<\/a><\/td>',t=n.CurrentItem.ApprovalStatus+"",t=t.toLowerCase(),r="",r=t==="approved"?'<td><span class="label label-success">Approved<\/span><\/td>':t==="cancelled"?'<td><span class="label label-warning">Cancelled<\/span><\/td>':t==="rejected"?'<td><span class="label label-danger">Rejected<\/span><\/td>':t&&t.length>0?'<td><span class="label label-default statusmultilang">'+n.CurrentItem.ApprovalStatus+"<\/span><\/td>":'<td><span class="label label-default">In-Progress<\/span><\/td>',"<tr>"+u+f+e+h+c+o+s+r+"<\/tr>"}function u(n){return ViewUtilities.Paging.InstanceHtml(n)}var n={BusinessTripManagement_ViewDetail:"View Detail",BusinessTripManagement_Requester:"Requester",BusinessTripManagement_Department:"Department",BusinessTripManagement_BusinessTripTypeTitle:"Business trip type",BusinessTripManagement_PurposeTitle:"Purpose",BusinessTripManagement_Created:"Created",BusinessTripManagement_Comment:"Comment",BusinessTripManagement_ApprovalStatus:"Approval status",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Locale:"",Container:"businessTrip-cashier-container"};(function(){var i={};i.Templates={};i.Templates.Item=r;i.OnPreRender=function(){$(".ms-menutoolbar").hide()};i.ListTemplateType=10059;i.BaseViewID=6;i.OnPostRender=t;i.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='businessTrip-cashier-detail'>"+n.BusinessTripManagement_ViewDetail+"<\/th><th id='businessTrip-cashier-requester'>"+n.BusinessTripManagement_Requester+"<\/th><th id='businessTrip-cashier-department'>"+n.BusinessTripManagement_Department+"<\/th><th id='businessTrip-cashier-businessTripType'>"+n.BusinessTripManagement_BusinessTripTypeTitle+"<\/th><th id='businessTrip-cashier-purpose'>"+n.BusinessTripManagement_PurposeTitle+"<\/th><th id='businessTrip-cashier-created'>"+n.BusinessTripManagement_Created+"<\/th><th id='businessTrip-cashier-comment'>"+n.BusinessTripManagement_Comment+"<\/th><th id='businessTrip-cashier-status'>"+n.BusinessTripManagement_ApprovalStatus+"<\/th><th><\/th><\/tr><\/thead><tbody>";i.Templates.Footer=u;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(i)})()}(),function(){function t(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){n.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",i)},"strings.js");var t=_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/Services/Department/DepartmentService.svc/GetDepartments/"+_spPageContextInfo.currentUICultureName+"/"+_rbvhContext.EmployeeInfo.FactoryLocation.LookupId;$.ajax({url:t,method:"GET",async:!0,headers:{Accept:"application/json; odata=verbose"},success:function(t){t&&t.length>0&&$("#"+n.Container+" .department-locale").each(function(){var n=$(this).attr("data-id"),i=$(this);$(t).each(function(t,r){r.Id.toString()===n&&i.text(r.DepartmentName)})})},error:function(){status="failed"}})}function i(){$("#businessTrip-driver-detail").text(Res.businessTripManagement_ViewDetail);$("#businessTrip-driver-requester").text(Res.businessTripManagement_RequesterTitle);$("#businessTrip-driver-department").text(Res.overtime_Department);$("#businessTrip-driver-businessTripType").text(Res.businessTripManagement_BusinessTripTypeTitle);$("#businessTrip-driver-purpose").text(Res.businessTripManagement_PurposeTitle);$("#businessTrip-driver-created").text(Res.createdDate);$("#businessTrip-driver-comment").text(Res.commonComment);$("#businessTrip-driver-status").text(Res.businessTripManagement_ApprovalStatus);$("#"+n.Container+" .viewDetail").text(Res.businessTripManagement_ViewDetail);$(".label-success").text(Res.approvalStatus_Approved);$(".label-warning").text(Res.approvalStatus_Cancelled);$(".label-danger").text(Res.approvalStatus_Rejected);$(".internal-trip").html(Res.businessTripManagement_BusinessTripTypeInternalTitle);$(".external-trip").html(Res.businessTripManagement_BusinessTripTypeExternalTitle)}function r(n){var f="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",e='<td class="department-locale" data-id="'+n.CurrentItem.CommonDepartment[0].lookupId+'">'+n.CurrentItem.CommonDepartment[0].lookupValue+"<\/td>",o="<td>"+n.CurrentItem.Created+"<\/td>",s=n.CurrentItem.CommonComment!=null?"<td>"+Functions.parseComment(n.CurrentItem.CommonComment)+"<\/td>":"<td><\/td>",h=n.CurrentItem["Domestic.value"]&&n.CurrentItem["Domestic.value"]==="1"?'<td class="internal-trip"><\/td>':'<td class="external-trip"><\/td>',c=n.CurrentItem.BusinessTripPurpose!=null?"<td>"+n.CurrentItem.BusinessTripPurpose+"<\/td>":"<td><\/td>",i=window.location.href.split("#")[0],u,t,r;return i=Functions.removeParam("lang",i),i+="#tab5",i=encodeURIComponent(i),u='<td><a href="/SitePages/BusinessTripRequest.aspx?subSection=BusinessTripManagement&itemId='+n.CurrentItem.ID+"&Source="+i+'"   class="viewDetail" >View Detail<\/a><\/td>',t=n.CurrentItem.ApprovalStatus+"",t=t.toLowerCase(),r="",r=t==="approved"?'<td><span class="label label-success">Approved<\/span><\/td>':t==="cancelled"?'<td><span class="label label-warning">Cancelled<\/span><\/td>':t==="rejected"?'<td><span class="label label-danger">Rejected<\/span><\/td>':t&&t.length>0?'<td><span class="label label-default statusmultilang">'+n.CurrentItem.ApprovalStatus+"<\/span><\/td>":'<td><span class="label label-default">In-Progress<\/span><\/td>',"<tr>"+u+f+e+h+c+o+s+r+"<\/tr>"}function u(n){return ViewUtilities.Paging.InstanceHtml(n)}var n={BusinessTripManagement_ViewDetail:"View Detail",BusinessTripManagement_Requester:"Requester",BusinessTripManagement_Department:"Department",BusinessTripManagement_BusinessTripTypeTitle:"Business trip type",BusinessTripManagement_PurposeTitle:"Purpose",BusinessTripManagement_Created:"Created",BusinessTripManagement_Comment:"Comment",BusinessTripManagement_ApprovalStatus:"Approval status",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Locale:"",Container:"businessTrip-driver-container"};(function(){var i={};i.Templates={};i.Templates.Item=r;i.OnPreRender=function(){$(".ms-menutoolbar").hide()};i.ListTemplateType=10059;i.BaseViewID=5;i.OnPostRender=t;i.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='businessTrip-driver-detail'>"+n.BusinessTripManagement_ViewDetail+"<\/th><th id='businessTrip-driver-requester'>"+n.BusinessTripManagement_Requester+"<\/th><th id='businessTrip-driver-department'>"+n.BusinessTripManagement_Department+"<\/th><th id='businessTrip-driver-businessTripType'>"+n.BusinessTripManagement_BusinessTripTypeTitle+"<\/th><th id='businessTrip-driver-purpose'>"+n.BusinessTripManagement_PurposeTitle+"<\/th><th id='businessTrip-driver-created'>"+n.BusinessTripManagement_Created+"<\/th><th id='businessTrip-driver-comment'>"+n.BusinessTripManagement_Comment+"<\/th><th id='businessTrip-driver-status'>"+n.BusinessTripManagement_ApprovalStatus+"<\/th><th><\/th><\/tr><\/thead><tbody>";i.Templates.Footer=u;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(i)})()}(),function(){function t(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){n.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",i)},"strings.js")}function i(){$(".businessTrip-request-cancel").click(function(){$(this).attr("disabled","true");var n=$(this).attr("data-id"),t=window.location.protocol+"//{0}/_vti_bin/services/BusinessTripManagement/BusinessTripManagementService.svc/CancelBusinessTrip/{1}",t=RBVH.Stada.WebPages.Utilities.String.format(t,location.host,n);n&&$.ajax({type:"GET",url:t,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){n.Code===5&&alert(n.Message);window.location.reload()},error:function(){console.log("Error while cancelling this request")}})});$("#businessTrip-request-detail").text(Res.businessTripManagement_ViewDetail);$("#businessTrip-request-requester").text(Res.businessTripManagement_RequesterTitle);$("#businessTrip-request-businessTripType").text(Res.businessTripManagement_BusinessTripTypeTitle);$("#businessTrip-request-purpose").text(Res.businessTripManagement_PurposeTitle);$("#businessTrip-request-created").text(Res.createdDate);$("#businessTrip-request-comment").text(Res.commonComment);$("#businessTrip-request-status").text(Res.businessTripManagement_ApprovalStatus);$("#"+n.Container+" .viewDetail").text(Res.businessTripManagement_ViewDetail);$(".label-success").text(Res.approvalStatus_Approved);$(".label-warning").text(Res.approvalStatus_Cancelled);$(".label-danger").text(Res.approvalStatus_Rejected);$(".businessTrip-request-cancel").text(Res.businesstripManagement_CancelRequest);$(".internal-trip").html(Res.businessTripManagement_BusinessTripTypeInternalTitle);$(".external-trip").html(Res.businessTripManagement_BusinessTripTypeExternalTitle)}function r(n){var o="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",s="<td>"+n.CurrentItem.Created+"<\/td>",h=n.CurrentItem.CommonComment!=null?"<td>"+Functions.parseComment(n.CurrentItem.CommonComment)+"<\/td>":"<td><\/td>",c=n.CurrentItem["Domestic.value"]&&n.CurrentItem["Domestic.value"]==="1"?'<td class="internal-trip"><\/td>':'<td class="external-trip"><\/td>',l=n.CurrentItem.BusinessTripPurpose!=null?"<td>"+n.CurrentItem.BusinessTripPurpose+"<\/td>":"<td><\/td>",i=window.location.href.split("#")[0],f,t,r,e,u;return i=Functions.removeParam("lang",i),i+="#tab1",i=encodeURIComponent(i),f='<td><a href="/SitePages/BusinessTripRequest.aspx?subSection=BusinessTripManagement&itemId='+n.CurrentItem.ID+"&Source="+i+'"   class="viewDetail" >View Detail<\/a><\/td>',t=n.CurrentItem.ApprovalStatus+"",t=t.toLowerCase(),r="",(n.CurrentItem.Editor[0].id!==n.CurrentItem.Author[0].id||n.CurrentItem.Editor[0].id===n.CurrentItem.Author[0].id&&(t==="approved"||t==="cancelled"||t==="rejected"))&&(r="disabled"),e="<td><button type='button' class='btn btn-default btn-sm businessTrip-request-cancel' "+r+" data-id='"+n.CurrentItem.ID+"'>Cancel Request<\/button><\/td>",u="",u=t==="approved"?'<td><span class="label label-success">Approved<\/span><\/td>':t==="cancelled"?'<td><span class="label label-warning">Cancelled<\/span><\/td>':t==="rejected"?'<td><span class="label label-danger">Rejected<\/span><\/td>':t&&t.length>0?'<td><span class="label label-default statusmultilang">'+n.CurrentItem.ApprovalStatus+"<\/span><\/td>":'<td><span class="label label-default">In-Progress<\/span><\/td>',"<tr>"+f+o+c+l+s+h+u+e+"<\/tr>"}function u(n){return ViewUtilities.Paging.InstanceHtml(n)}var n={BusinessTripManagement_ViewDetail:"View Detail",BusinessTripManagement_Requester:"Requester",BusinessTripManagement_PurposeTitle:"Purpose",BusinessTripManagement_BusinessTripTypeTitle:"Business trip type",BusinessTripManagement_Created:"Created",BusinessTripManagement_Comment:"Comment",BusinessTripManagement_ApprovalStatus:"Approval status",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Locale:"",Container:"businessTrip-request-list-container"};(function(){var i={};i.Templates={};i.Templates.Item=r;i.OnPreRender=function(){$(".ms-menutoolbar").hide()};i.ListTemplateType=10059;i.BaseViewID=2;i.OnPostRender=t;i.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='businessTrip-request-detail'>"+n.BusinessTripManagement_ViewDetail+"<\/th><th id='businessTrip-request-requester'>"+n.BusinessTripManagement_Requester+"<\/th><th id='businessTrip-request-businessTripType'>"+n.BusinessTripManagement_BusinessTripTypeTitle+"<\/th><th id='businessTrip-request-purpose'>"+n.BusinessTripManagement_PurposeTitle+"<\/th><th id='businessTrip-request-created'>"+n.BusinessTripManagement_Created+"<\/th><th id='businessTrip-request-comment'>"+n.BusinessTripManagement_Comment+"<\/th><th id='businessTrip-request-status'>"+n.BusinessTripManagement_ApprovalStatus+"<\/th><th id='businessTrip-request-action'><\/th><th><\/th><\/tr><\/thead><tbody>";i.Templates.Footer=u;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(i)})()}(),function(){function t(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){n.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",i)},"strings.js")}function i(){$("#myBusinessTrip-detail").text(Res.businessTripManagement_ViewDetail);$("#myBusinessTrip-requester").text(Res.businessTripManagement_RequesterTitle);$("#myBusinessTrip-businessTripType").text(Res.businessTripManagement_BusinessTripTypeInternalTitle);$("#myBusinessTrip-purpose").text(Res.businessTripManagement_PurposeTitle);$("#myBusinessTrip-created").text(Res.createdDate);$("#myBusinessTrip-comment").text(Res.commonComment);$("#myBusinessTrip-status").text(Res.businessTripManagement_ApprovalStatus);$("#"+n.Container+" .viewDetail").text(Res.businessTripManagement_ViewDetail);$(".label-success").text(Res.approvalStatus_Approved);$(".label-warning").text(Res.approvalStatus_Cancelled);$(".label-danger").text(Res.approvalStatus_Rejected);$(".internal-trip").html(Res.businessTripManagement_BusinessTripTypeInternalTitle);$(".external-trip").html(Res.businessTripManagement_BusinessTripTypeExternalTitle)}function r(n){var f="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",e="<td>"+n.CurrentItem.Created+"<\/td>",o=n.CurrentItem.CommonComment!=null?"<td>"+Functions.parseComment(n.CurrentItem.CommonComment)+"<\/td>":"<td><\/td>",s=n.CurrentItem["Domestic.value"]&&n.CurrentItem["Domestic.value"]==="1"?'<td class="internal-trip"><\/td>':'<td class="external-trip"><\/td>',h=n.CurrentItem.BusinessTripPurpose!=null?"<td>"+n.CurrentItem.BusinessTripPurpose+"<\/td>":"<td><\/td>",i=window.location.href.split("#")[0],u,t,r;return i=Functions.removeParam("lang",i),i+="#tab1",i=encodeURIComponent(i),u='<td><a href="/SitePages/BusinessTripRequest.aspx?subSection=BusinessTripManagement&itemId='+n.CurrentItem.ID+"&Source="+i+'"   class="viewDetail" >View Detail<\/a><\/td>',t=n.CurrentItem.ApprovalStatus+"",t=t.toLowerCase(),r="",r=t==="approved"?'<td><span class="label label-success">Approved<\/span><\/td>':t==="cancelled"?'<td><span class="label label-warning">Cancelled<\/span><\/td>':t==="rejected"?'<td><span class="label label-danger">Rejected<\/span><\/td>':t&&t.length>0?'<td><span class="label label-default statusmultilang">'+n.CurrentItem.ApprovalStatus+"<\/span><\/td>":'<td><span class="label label-default">In-Progress<\/span><\/td>',"<tr>"+u+f+s+h+e+o+r+"<\/tr>"}function u(n){return ViewUtilities.Paging.InstanceHtml(n)}var n={BusinessTripManagement_ViewDetail:"View Detail",BusinessTripManagement_Requester:"Requester",BusinessTripManagement_PurposeTitle:"Purpose",BusinessTripManagement_BusinessTripTypeTitle:"Business trip type",BusinessTripManagement_Created:"Created",BusinessTripManagement_Comment:"Comment",BusinessTripManagement_ApprovalStatus:"Approval status",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Locale:"",Container:"my-business-trip-container"};(function(){var i={};i.Templates={};i.Templates.Item=r;i.OnPreRender=function(){$(".ms-menutoolbar").hide()};i.ListTemplateType=10059;i.BaseViewID=7;i.OnPostRender=t;i.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='myBusinessTrip-detail'>"+n.BusinessTripManagement_ViewDetail+"<\/th><th id='myBusinessTrip-requester'>"+n.BusinessTripManagement_Requester+"<\/th><th id='myBusinessTrip-businessTripType'>"+n.BusinessTripManagement_BusinessTripTypeTitle+"<\/th><th id='myBusinessTrip-purpose'>"+n.BusinessTripManagement_PurposeTitle+"<\/th><th id='myBusinessTrip-created'>"+n.BusinessTripManagement_Created+"<\/th><th id='myBusinessTrip-comment'>"+n.BusinessTripManagement_Comment+"<\/th><th id='myBusinessTrip-status'>"+n.BusinessTripManagement_ApprovalStatus+"<\/th><th id='myBusinessTrip-action'><\/th><th><\/th><\/tr><\/thead><tbody>";i.Templates.Footer=u;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(i)})()}();