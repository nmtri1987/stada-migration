(function(){function t(t){var i={url:t,width:800,height:400,showClose:!0,allowMaximize:!1,title:n.ViewDetail};SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",i)}function i(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){n.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",r);SP.SOD.registerSod(n.PageResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.PageResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.PageResourceFileName,"Res",u)},"strings.js");$(".cancel-request").click(function(){o($(this).attr("data-id"),$(this));$(this).attr("disabled","true")});$(".viewdetailmyrequest").click(function(){url=$(this).attr("data-url");t(url)})}function r(){$("#requesterTH_csRequest").text(Res.changeShiftList_Requester);$("#fromshift_csRequest").text(Res.changeShiftList_FromShift);$("#toshift_csRequest").text(Res.changeShiftList_ToShift);$("#from_csRequest").text(Res.changeShiftList_FromDate);$("#to_csRequest").text(Res.changeShiftList_ToDate);$("#created_csRequest").text(Res.createdDate);$("#reason_csRequest").text(Res.changeShiftManagement_Reason);$("#comment_csRequest").text(Res.commonComment);$("#approvalStatus_csRequest").text(Res.changeShiftManagement_ApprovalStatus);$("#action_csRequest").text(Res.changeShiftManagement_ViewTitle);$(".label-success").text(Res.approvalStatus_Approved);$(".label-default").text(Res.approvalStatus_InProgress);$(".label-warning").text(Res.approvalStatus_Cancelled);n.ApprovalStatus_Cancelled=Res.approvalStatus_Cancelled;$(".label-danger").text(Res.approvalStatus_Rejected);$(".cancel-request").text(Res.changeShiftManagement_CancelRequest)}function u(){n.RequestStatusApproved=Res.requestStatusApproved;n.RequestStatusCancelled=Res.requestStatusCancelled;n.RequestStatusRejected=Res.requestStatusRejected;n.ViewDetail=Res.viewDetail}function f(n){var f="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",e="<td>"+n.CurrentItem.FromShift[0].lookupValue+"<\/td>",o="<td>"+n.CurrentItem.ToShift[0].lookupValue+"<\/td>",s="<td>"+n.CurrentItem.CommonFrom+"<\/td>",h="<td>"+n.CurrentItem.To+"<\/td>",c="<td>"+n.CurrentItem.Created+"<\/td>",l="<td>"+n.CurrentItem.Reason+"<\/td>",a="<td>"+n.CurrentItem.CommonComment+"<\/td>",r=n.CurrentItem.ApprovalStatus+"",t=window.location.href.split("#")[0],i;t=Functions.removeParam("lang",t);t+="#tab1";t=encodeURIComponent(t);var v='<span><a data-url="/Lists/ChangeShiftManagement/DispForm.aspx?ID='+n.CurrentItem.ID+"&TextOnly=true&Source="+t+'"   class="table-action viewdetailmyrequest"><i class="fa fa-eye" aria-hidden="true"><\/i><\/a><\/span>',y="<td>"+v+"<\/td>",u="<td><button type='button' class='btn btn-default btn-sm cancel-request' disabled  data-id='"+n.CurrentItem.ID+"'>Cancel Request<\/button><\/td>";return r=r.toLowerCase(),i="",r=="approved"?i='<td><span class="label label-success">Approved<\/span><\/td>':r=="cancelled"?i='<td><span class="label label-warning">Cancelled<\/span><\/td>':r=="rejected"?i='<td><span class="label label-danger">Rejected<\/span><\/td>':(i='<td><span class="label label-default">In-Progress<\/span><\/td>',u="<td><button type='button' class='btn btn-default btn-sm cancel-request'  data-id='"+n.CurrentItem.ID+"'>Cancel Request<\/button><\/td>"),"<tr>"+f+e+o+s+h+c+l+a+i+y+u+"<\/tr>"}function e(n){return ViewUtilities.Paging.InstanceHtml(n)}function o(t){if(s(t),n.ApprovalStatus.toLowerCase()==="approved")alert(n.RequestStatusApproved),location.reload();else if(n.ApprovalStatus.toLowerCase()==="cancelled")alert(n.RequestStatusCancelled),location.reload();else if(n.ApprovalStatus.toLowerCase()==="rejected")alert(n.RequestStatusRejected),location.reload();else{var u=_spPageContextInfo.webServerRelativeUrl,f=window.location.protocol+"//"+window.location.host+u,i=new SP.ClientContext(f),r=i.get_web().get_lists().getByTitle(String(n.ChangeShiftManagement_ListTitle));i.load(r);this.oListItem=r.getItemById(t);oListItem.set_item("ApprovalStatus","Cancelled");oListItem.update();i.executeQueryAsync(Function.createDelegate(this,function(){location.reload()}),Function.createDelegate(this,function(){}))}}function s(t){var r=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('"+String(n.ChangeShiftManagement_ListTitle)+"')/items("+t+")",i=$.Deferred();return $.ajax({url:r,method:"GET",async:!1,headers:{Accept:"application/json; odata=verbose"},success:function(t){n.ApprovalStatus=t.d.ApprovalStatus;i.resolve(t.d)},error:function(){status="failed"}}),i.promise()}var n={ChangeShiftManagement_Requester:"Requester",ChangeShiftManagement_FromShift:"From Shift",ChangeShiftManagement_ToShift:"To Shift",ChangeShiftManagement_From:"From",ChangeShiftManagement_To:"To",ChangeShiftManagement_Created:"Created",Comment:"Comment",ChangeShiftManagement_Reason:"Reason",ApprovalStatus:"",RequestStatusApproved:"",RequestStatusCancelled:"",RequestStatusRejected:"",ChangeShiftManagement_ApprovalStatus:"Approval Status",ChangeShiftManagement_ListTitle:"Change Shift Management",ChangeShiftManagement_ViewTitle:"View",ApprovalStatus_Cancelled:"Cancelled",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Locale:"",ViewDetail:"View item detail"};(function(){var t={};t.Templates={};t.Templates.Item=f;t.OnPreRender=function(){$(".ms-menutoolbar").hide()};t.ListTemplateType=10011;t.BaseViewID=2;t.OnPostRender=i;t.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='requesterTH_csRequest'>"+n.ChangeShiftManagement_Requester+"<\/th><th id='fromshift_csRequest'>"+n.ChangeShiftManagement_FromShift+"<\/th><th id='toshift_csRequest'>"+n.ChangeShiftManagement_ToShift+"<\/th><th id='from_csRequest'>"+n.ChangeShiftManagement_From+"<\/th><th id='to_csRequest'>"+n.ChangeShiftManagement_To+"<\/th><th id='created_csRequest'>"+n.ChangeShiftManagement_Created+"<\/th><th id='reason_csRequest'>"+n.ChangeShiftManagement_Reason+"<\/th><th id='comment_csRequest'>"+n.Comment+"<\/th><th id='approvalStatus_csRequest'>"+n.ChangeShiftManagement_ApprovalStatus+"<\/th><th id='action_csRequest'>"+n.ChangeShiftManagement_ViewTitle+"<\/th><th><\/th><\/tr><\/thead><tbody>";t.Templates.Footer=e;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(t)})()})();