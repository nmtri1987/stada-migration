function validateBeforeApprove(){return requestFormInstance.ValidateBeforeApprove()}function ValidateBeforeSaveAndSubmit(){return(valid1=requestFormInstance.ValidateForm(),valid1==!0)?(valid2=requestFormInstance.ValidateDataDifferent(),valid3=supportingDocumentInstance.ValidateAttachments(),valid1==!0&&valid2==!0&&valid3==!0):!1}RBVH.Stada.javascript.common.NamespaceManager.register("RBVH.Stada.WebPages.pages");$.fn.showOption=function(){return this.each(function(){var n,t;this.tagName=="OPTION"&&(n=this,$(this).parent().get(0).tagName=="SPAN"&&(t=$(this).parent().get(0),$(t).replaceWith(n),$(t).remove()),n.disabled=!1,$(n).show())}),this};$.fn.hideOption=function(){return this.each(function(){var n,t;this.tagName=="OPTION"&&(n=this,$(this).parent().get(0).tagName=="SPAN"?(t=$(this).parent().get(0),$(t).hide()):$(n).wrap("span").hide(),n.disabled=!0)}),this};RBVH.Stada.WebPages.pages.RequestForm=function(n){this.Protocol=window.location.protocol;this.Settings={Controls:{FileContainer:"#ctl00_PlaceHolderMain_RequestFormUserControl_SupportingDocumentControl_GridSupportingDocument"},EmployeeID:"",FullName:"",LocationId:0,DepartmentId:0,ID:0,EmployeeLevel:0,CurrentRequestType:"RequestBuyDetails",CurrentActiveDetailDivId:"details1",Grid1:{CustomFields:{NoField:null,ContentField:null,FormField:null,UnitField:null,QuantityField:null,ReasonField:null}},Grid2:{CustomFields:{NoField:null,ContentField:null,FromField:null,ToField:null,PlaceField:null,ReasonField:null}},Grid3:{CustomFields:{NoField:null,ContentField:null,FormField:null,ToField:null,PlaceField:null,ReasonField:null}},Fields:[],Data:[],Grid1JsonArray:[],Grid2JsonArray:[],Grid3JsonArray:[],OldGrid1JsonArray:[],OldGrid2JsonArray:[],OldGrid3JsonArray:[],OldTitle:"",OldFileCount:"",OldRequestType:"",OldRequestReceivedByDepartmentId:0,OldFinishDate:"",OldComment:"",OldReferTo:0,IsViewMode:!1,IsEditMode:!1,IsFormEditable:!1,FormModeParam:"new",DocumentCount:0,SupportingDocuments:[]};$.extend(!0,this.Settings,n);this.Initialize()};RBVH.Stada.WebPages.pages.RequestForm.prototype={Initialize:function(){var n=this;$(document).ready(function(){SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){n.InitControls();n.PopulateData();n.EventsRegister()})})},InitControls:function(){var n=this,f=$(n.Settings.Controls.hdIsEditableSelector).val(),t,r,i,u;if(n.Settings.IsFormEditable=f=="True",t=$(n.Settings.Controls.hdRequestTypeSelector).val(),t!="")switch(t){case"1":n.Settings.CurrentActiveDetailDivId="details1";n.Settings.CurrentRequestType="RequestBuyDetails";break;case"2":n.Settings.CurrentActiveDetailDivId="details2";n.Settings.CurrentRequestType="RequestRepairDetails";break;case"3":n.Settings.CurrentActiveDetailDivId="details3";n.Settings.CurrentRequestType="RequestOtherDetails"}r=Functions.getParameterByName("mode");n.Settings.FormModeParam=r;$(n.Settings.Controls.FinishDateSelector).keydown(function(n){return n.preventDefault(),!1});$(n.Settings.Controls.DueDateSelector).keydown(function(n){return n.preventDefault(),!1});n.ShowDetailGrid();$(n.Settings.Controls.FinishDateSelector).attr("disabled")=="disabled"&&$(n.Settings.Controls.FinishDateSelector).parent().next().hide();$(n.Settings.Controls.DueDateSelector).attr("disabled")=="disabled"&&$(n.Settings.Controls.DueDateSelector).parent().next().hide();n.CheckToShowReceivedBy();n.FilterDepartmentAccordingToRequestType();n.CheckToShowFinishDate();n.CheckToShowRequiredApprovalByBOD();n.SetUrlReferTo();n.CheckToShowDueDate();n.ShowErrorMessage();n.Settings.IsFormEditable==!0&&(n.Settings.OldFileCount=$(n.Settings.FileContainer+" input[type='file']").length,n.Settings.OldTitle=$(n.Settings.Controls.txtTitleSelector).val(),n.Settings.OldRequestType=n.Settings.CurrentRequestType,n.Settings.OldRequestReceivedByDepartmentId=$(n.Settings.Controls.ddlReceivedBySelector).val(),n.Settings.OldFinishDate=$(n.Settings.Controls.FinishDateSelector).val(),n.Settings.OldComment=$(n.Settings.Controls.CommentSelector).val(),n.Settings.SupportingDocuments=[],$(n.Settings.Controls.SupportingDocumentDeletedItemSelector).each(function(){n.Settings.SupportingDocuments.push($(this).attr("name"))}),n.Settings.OldReferTo=$(n.Settings.Controls.ddlReferToSelector).val());$(n.Settings.Controls.ddlReferToSelector).select2();i=$(n.Settings.Controls.ApprovalStatusValueSelector).val();!i||($(n.Settings.Controls.ApprovalStatusTdSelector).html(RBVH.Stada.WebPages.Utilities.GUI.generateItemStatus(i)),$(n.Settings.Controls.ApprovalStatusTrSelector).show());$("input[id*='btnPrint']").is(":visible")&&$("input[id*='btnApprove']").is(":visible")&&(u=$(n.Settings.Controls.hdPrintCounter).val()=="1",u||$("input[id*='btnApprove']").hide())},DisableButtonControls:function(){var n=this;$(n.Settings.Controls.btnSaveDraftSelector).prop("disabled",!0);$(n.Settings.Controls.btnSaveAndSubmitSelector).prop("disabled",!0)},EnableButtonControls:function(){var n=this;$(n.Settings.Controls.btnSaveDraftSelector).removeAttr("disabled");$(n.Settings.Controls.btnSaveAndSubmitSelector).removeAttr("disabled")},PopulateData:function(){var n=this;n.PopulateGrid()},EventsRegister:function(){var n=this;$("input[type='radio'][name='"+n.Settings.Controls.RadioButtonsNameSelector+"']").click(function(){var e,r;$(n.Settings.Controls.hdRequestTypeSelector).val($(this).val());n.FilterDepartmentAccordingToRequestType();try{var c=n.Settings.Controls.hdRequestBuyTypeIdSelector,o=n.Settings.Controls.hdRequestRepairTypeIdSelector,s=n.Settings.Controls.hdRequestOtherTypeIdSelector,u=n.Settings.Controls.trReceivedBySelector,t=n.Settings.Controls.trRequireBODdApproveSelector,f=n.Settings.Controls.trFinishDateSelector,h=n.Settings.Controls.hdRequestTypeSelector,i=$(this).val();$(h).val(i);i==$(o).val()||i==$(s).val()?($(u).show(),$(f).show(),e=$(n.Settings.Controls.hdIsEmployeeDEHSelector).val(),e=="1"?$(t).show():$(t).hide()):($(u).hide(),$(f).hide(),$(t).hide())}catch(l){}r="details"+$(this).val();switch("#"+r){case n.Settings.Controls.GridDetail1ControlSelector:n.Settings.CurrentRequestType="RequestBuyDetails";break;case n.Settings.Controls.GridDetail2ControlSelector:n.Settings.CurrentRequestType="RequestRepairDetails";break;case n.Settings.Controls.GridDetail3ControlSelector:n.Settings.CurrentRequestType="RequestOtherDetails"}n.Settings.CurrentActiveDetailDivId=r;n.ShowDetailGrid()});$(n.Settings.Controls.ddlReferToSelector).change(function(){n.SetUrlReferTo()});$(n.Settings.Controls.linkReferToSelector).click(function(){var n=$(this).attr("url"),t;n!=""&&(t=$(this).attr("title"),openModalDialog(t,n,null,SP.UI.DialogResult.cancel))});$("input[type=submit]").keydown(function(n){if(n.which==13)return n.preventDefault(),!1});$("input[id*='btnPrint']").on("click",function(){$(n.Settings.Controls.hdPrintCounter).val("1");$("input[id*='btnApprove']").show()})},ShowDetailGrid:function(){var n=this,t=$("#"+n.Settings.CurrentActiveDetailDivId);$(t).siblings().hide();$(t).show();n.PopulateGrid()},PopulateGrid:function(){var n=this,t=n.Settings.CurrentActiveDetailDivId;switch("#"+t){case n.Settings.Controls.GridDetail1ControlSelector:n.PopulateRequestBuyDetailsGrid(t);break;case n.Settings.Controls.GridDetail2ControlSelector:n.PopulateRequestRepairDetailsGrid(t);break;case n.Settings.Controls.GridDetail3ControlSelector:n.PopulateRequestOtherGrid(t)}},ValidateBeforeApprove:function(){var n=this,i=0,r=new Date,e=new Date(r.getFullYear(),r.getMonth(),r.getDate()),t,u,f;return $(n.Settings.Controls.hdIsShowDueDateSelector).val()=="1"&&(t=$(n.Settings.Controls.DueDateSelector).val(),t&&t!=""&&t.trim()!=""?(u=Functions.parseVietNameseDate(t),u<e?($(n.Settings.Controls.DueDateSelector_Error).html(n.Settings.Messages.SelectedDateMustGreaterThanCurrentDate),i+=1):$(n.Settings.Controls.DueDateSelector_Error).html("")):($(n.Settings.Controls.DueDateSelector_Error).html(n.Settings.Messages.CantLeaveTheBlank),i+=1)),f=n.Settings.Controls.trReceivedBySelector,$(f).is(":visible")&&$(n.Settings.Controls.ddlReceivedBySelector+" option:selected").val()=="0"?(i+=1,$(n.Settings.Controls.ReceivedBy_Error).html(n.Settings.Messages.PleaseSelectedReceivedDepartment).show()):$(n.Settings.Controls.ReceivedBy_Error).html("").hide(),i==0},ValidateDataDifferent:function(){var n=this;return n.Settings.IsFormEditable==!1?!0:n.ValidateDetailGridDiffrent()==!1&&n.CheckFieldValueChange()==!1?(alert(n.Settings.Messages.DataMustBeDifferentAfterEdit),!1):!0},CheckFieldValueChange:function(){var n=this,t=0,i;return t+=$(n.Settings.Controls.txtTitleSelector).val()!=n.Settings.OldTitle?1:0,t+=n.Settings.CurrentRequestType!=n.Settings.OldRequestType?1:0,t+=$(n.Settings.Controls.ddlReceivedBySelector).val()!=n.Settings.OldRequestReceivedByDepartmentId?1:0,t+=$(n.Settings.Controls.FinishDateSelector).val()!=n.Settings.OldFinishDate?1:0,t+=$(n.Settings.Controls.CommentSelector).val()!=n.Settings.OldComment?1:0,t+=$(n.Settings.Controls.FileContainer+" input[type='file']").length!=n.Settings.OldFileCount?1:0,i=[],$(n.Settings.Controls.SupportingDocumentDeletedItemSelector).each(function(){i.push($(this).attr("name"))}),t+=$(n.Settings.SupportingDocuments).not(i).length===0&&$(i).not(n.Settings.SupportingDocuments).length===0?0:1,t+=$(n.Settings.Controls.ddlReferToSelector).val()!=n.Settings.OldReferTo?1:0,t>0},ValidateDetailGridDiffrent:function(){var r=this,f=[],e=[],o,t,u,i,n,s;if(r.Settings.IsFormEditable){if(o=r.Settings.CurrentRequestType,o=="RequestBuyDetails"){for(t=0;t<r.Settings.Grid1JsonArray.length;t++)n={},n.Content=r.Settings.Grid1JsonArray[t].Content,n.Form=r.Settings.Grid1JsonArray[t].Form,n.Unit=r.Settings.Grid1JsonArray[t].Unit,n.Quantity=r.Settings.Grid1JsonArray[t].Quantity,n.Reason=r.Settings.Grid1JsonArray[t].Reason,e.push(n);for(u=r.Settings.OldGrid1JsonArray,i=0;i<u.length;i++)n={},n.Content=u[i].Content,n.Form=u[i].Form,n.Unit=u[i].Unit,n.Quantity=u[i].Quantity,n.Reason=u[i].Reason,f.push(n)}else if(o=="RequestRepairDetails"){for(t=0;t<r.Settings.Grid2JsonArray.length;t++)n={},n.Content=r.Settings.Grid2JsonArray[t].Content,n.Place=r.Settings.Grid2JsonArray[t].Place,n.FromDateString=r.Settings.Grid2JsonArray[t].FromDateString,n.ToDateString=r.Settings.Grid2JsonArray[t].ToDateString,n.Reason=r.Settings.Grid2JsonArray[t].Reason,e.push(n);for(u=r.Settings.OldGrid2JsonArray,i=0;i<u.length;i++)n={},n.Content=u[i].Content,n.Place=u[i].Place,n.FromDateString=u[i].FromDateString,n.ToDateString=u[i].ToDateString,n.Reason=u[i].Reason,f.push(n)}else if(o=="RequestOtherDetails"){for(t=0;t<r.Settings.Grid3JsonArray.length;t++)n={},n.Content=r.Settings.Grid3JsonArray[t].Content,n.Quantity=r.Settings.Grid3JsonArray[t].Quantity,n.Unit=r.Settings.Grid3JsonArray[t].Unit,n.Reason=r.Settings.Grid3JsonArray[t].Reason,e.push(n);for(u=r.Settings.OldGrid3JsonArray,i=0;i<u.length;i++)n={},n.Content=u[i].Content,n.Quantity=u[i].Quantity,n.Unit=u[i].Unit,n.Reason=u[i].Reason,f.push(n)}return s=f!=[]&&e!=[]&&JSON.stringify(f)===JSON.stringify(e),!s}},ValidateForm:function(){var n=this,t=0,i=new Date,h=new Date(i.getFullYear(),i.getMonth(),i.getDate()),r=$(n.Settings.Controls.FinishDateSelector).val(),u=n.Settings.CurrentRequestType,f=$(n.Settings.Controls.txtTitleSelector).val(),e,c,o,s;f!=""&&f?$(n.Settings.Controls.TitleSelector_Error).html(""):($(n.Settings.Controls.TitleSelector_Error).html(n.Settings.Messages.CantLeaveTheBlank),t+=1);r!=""&&r?(e=Functions.parseVietNameseDate(r),e<h?($(n.Settings.Controls.FinishDateSelector_Error).html(n.Settings.Messages.SelectedDateMustGreaterThanCurrentDate),t+=1):$(n.Settings.Controls.FinishDateSelector_Error).html("")):(u=="RequestRepairDetails"||u=="RequestOtherDetails")&&($(n.Settings.Controls.FinishDateSelector_Error).html(n.Settings.Messages.CantLeaveTheBlank),t+=1);switch(u){case"RequestBuyDetails":n.Settings.Grid1JsonArray.length==0&&(alert(n.Settings.Messages.PleaseInputGridDetail),t+=n.Settings.Grid1JsonArray.length>0?0:1);break;case"RequestRepairDetails":n.Settings.Grid2JsonArray.length==0&&(alert(n.Settings.Messages.PleaseInputGridDetail),t+=n.Settings.Grid2JsonArray.length>0?0:1);break;case"RequestOtherDetails":n.Settings.Grid3JsonArray.length==0&&(alert(n.Settings.Messages.PleaseInputGridDetail),t+=n.Settings.Grid3JsonArray.length>0?0:1)}return c=n.Settings.Controls.ddlReceivedBySelector,o=n.Settings.Controls.trReceivedBySelector,$(o).is(":visible")&&(s=$(n.Settings.Controls.ddlReceivedBySelector+" option:selected").val(),s==0?(t+=1,$(n.Settings.Controls.ReceivedBy_Error).html(n.Settings.Messages.PleaseSelectedReceivedDepartment).show()):$(n.Settings.Controls.ReceivedBy_Error).html("").hide()),t==0},BindDateTimeControl:function(){var n=this;n.Settings.Grid2.CustomFields.FromField=function(n){jsGrid.Field.call(this,n)};n.Settings.Grid2.CustomFields.ToField=function(n){jsGrid.Field.call(this,n)};n.Settings.Grid2.CustomFields.FromField.prototype=new jsGrid.Field({sorter:function(n,t){return new Date(n)-new Date(t)},itemTemplate:function(n){return n},insertTemplate:function(){return this._insertPicker=$("<input>").datepicker({defaultDate:new Date,dateFormat:"dd/mm/yy"})},editTemplate:function(n){var t=Functions.parseVietNameseDate(n);return this._editPicker=$("<input>").datepicker({dateFormat:"dd/mm/yy"}).datepicker("setDate",t)},insertValue:function(){var n=this._insertPicker.datepicker("getDate");return n?Functions.parseVietnameseDateTimeToDDMMYYYY2(n):""},editValue:function(){var n=this._editPicker.datepicker("getDate");return n?Functions.parseVietnameseDateTimeToDDMMYYYY2(n):""}});n.Settings.Grid2.CustomFields.ToField.prototype=new jsGrid.Field({sorter:function(n,t){return new Date(n)-new Date(t)},itemTemplate:function(n){return n},insertTemplate:function(){return this._insertPicker=$("<input>").datepicker({defaultDate:new Date,dateFormat:"dd/mm/yy"})},editTemplate:function(n){var t=Functions.parseVietNameseDate(n);return this._editPicker=$("<input>").datepicker({dateFormat:"dd/mm/yy"}).datepicker("setDate",t)},insertValue:function(){var n=this._insertPicker.datepicker("getDate");return n?Functions.parseVietnameseDateTimeToDDMMYYYY2(n):""},editValue:function(){var n=this._editPicker.datepicker("getDate");return n?Functions.parseVietnameseDateTimeToDDMMYYYY2(n):""}})},BindOrderNumber:function(){var n=this;n.Settings.Grid1.CustomFields.NoField=function(n){jsGrid.Field.call(this,n)};n.Settings.Grid2.CustomFields.NoField=function(n){jsGrid.Field.call(this,n)};n.Settings.Grid3.CustomFields.NoField=function(n){jsGrid.Field.call(this,n)};n.Settings.Grid1.CustomFields.NoField.prototype=new jsGrid.Field({insertTemplate:function(){},editTemplate:function(){},insertValue:function(){var t=n.Settings.Grid1JsonArray.length;return t+1},editValue:function(){}});n.Settings.Grid2.CustomFields.NoField.prototype=new jsGrid.Field({insertTemplate:function(){},editTemplate:function(){},insertValue:function(){var t=n.Settings.Grid2JsonArray.length;return t+1},editValue:function(){}});n.Settings.Grid3.CustomFields.NoField.prototype=new jsGrid.Field({insertTemplate:function(){},editTemplate:function(){},insertValue:function(){var t=n.Settings.Grid3JsonArray.length;return t+1},editValue:function(){}})},DisbleDeleteButtonOnGrid:function(){$(".jsgrid-button.jsgrid-delete-button").prop("disabled",!0);$(".jsgrid-button.jsgrid-delete-button").css("opacity",.1)},PopulateRequestBuyDetailsGrid:function(){var n=this;n.BindRequestBuyDetailsGridColumns();$(n.Settings.Controls.GridDetail1ControlSelector).jsGrid({width:"100%",height:"200px",align:"center",inserting:n.Settings.IsFormEditable,editing:n.Settings.IsFormEditable,sorting:!1,autoload:!0,noDataContent:"",deleteConfirm:n.Settings.ConfirmDeleteMessage,data:n.Settings.Data,onDataLoaded:function(){n.Settings.IsFormEditable==!1?n.DisbleDeleteButtonOnGrid():n.EnableButtonControls()},controller:{loadData:function(){var r=$.Deferred(),u=$(n.Settings.Controls.hdRequestBuySelector).val(),t,i;if(u!=""){for(t=JSON.parse(u),n.Settings.OldGrid1JsonArray=JSON.parse(JSON.stringify(t)),i=0;i<t.length;i++)t[i].No=i+1;n.Settings.Grid1JsonArray=t}return r.resolve(n.Settings.Grid1JsonArray),r.promise()},insertItem:function(){},updateItem:function(){},deleteItem:function(){}},onItemInserting:function(t){var i=t.item.Quantity,r=t.item.Content,u=t.item.Reason;if(r==""&&!r){alert(n.Settings.Messages.PleaseInputContentData);t.cancel=!0;return}if(!u||u==""){alert(n.Settings.Messages.PleaseInputReasonData);t.cancel=!0;return}if(i!=""&&(!$.isNumeric(i)||i<=0)){alert(n.Settings.Messages.QuantityDataError);t.cancel=!0;return}},onItemInserted:function(){n.RebindHiddenBuyDetailsFields(n.Settings.Grid1JsonArray)},onItemEditing:function(){},onItemUpdated:function(){n.RebindHiddenBuyDetailsFields(n.Settings.Grid1JsonArray)},onItemUpdating:function(t){var i=t.item.Quantity,r=t.item.Content,u=t.item.Reason;if(r==""&&!r){alert(n.Settings.Messages.PleaseInputContentData);t.cancel=!0;return}if(!u||u==""){alert(n.Settings.Messages.PleaseInputReasonData);t.cancel=!0;return}if(i!=""&&(!$.isNumeric(i)||i<=0)){alert(n.Settings.Messages.QuantityDataError);t.cancel=!0;return}},onItemDeleted:function(){n.RebindHiddenBuyDetailsFields(n.Settings.Grid1JsonArray);for(var t=0;t<n.Settings.Grid1JsonArray.length;t++)n.Settings.Grid1JsonArray[t].No=t+1;n.Settings.Grid1JsonArray.length>1&&$(n.Settings.Controls.GridDetail1ControlSelector).jsGrid("loadData")},onItemEditCancelling:function(){},fields:n.Settings.Grid1.Fields})},RebindHiddenBuyDetailsFields:function(n){var t=this;n&&n.length>0&&$(t.Settings.Controls.hdRequestBuySelector).val(JSON.stringify(n))},BindRequestBuyDetailsGridColumns:function(){var n=this;n.BindOrderNumber();jsGrid.fields.custOrderField=n.Settings.Grid1.CustomFields.NoField;n.Settings.Grid1.Fields=[{name:"No",title:n.Settings.GridResources.GridOrderNumber,width:25,type:"custOrderField"},{name:"Content",title:n.Settings.GridResources.GridBuyDetail_Content,width:250,align:"left",type:"text"},{name:"Form",title:n.Settings.GridResources.GridBuyDetail_Form,width:100,align:"left",type:"text"},{name:"Unit",title:n.Settings.GridResources.GridBuyDetail_Unit,width:65,align:"left",type:"text"},{name:"Quantity",title:n.Settings.GridResources.GridBuyDetail_Quantity,width:90,align:"left",type:"text",maxLength:15},{name:"Reason",title:n.Settings.GridResources.GridBuyDetail_Reason,width:350,align:"left",type:"text"},{type:"control",editButton:!1,deleteButton:!n.Settings.IsViewMode,width:60,modeSwitchButton:!1}]},PopulateRequestRepairDetailsGrid:function(){var n=this;n.BindRequestRepairGridColumns();$(n.Settings.Controls.GridDetail2ControlSelector).jsGrid({width:"100%",height:"200px",align:"center",inserting:n.Settings.IsFormEditable,editing:n.Settings.IsFormEditable,sorting:!1,autoload:!0,noDataContent:"",deleteConfirm:n.Settings.ConfirmDeleteMessage,data:n.Settings.Data,onDataLoaded:function(){n.Settings.IsFormEditable==!1?n.DisbleDeleteButtonOnGrid():n.EnableButtonControls()},controller:{loadData:function(){var f=$.Deferred(),e=$(n.Settings.Controls.hdDetailsRepairSelector).val(),t,i,r,u;if(e!=""){for(t=JSON.parse(e),n.Settings.OldGrid2JsonArray=JSON.parse(JSON.stringify(t)),i=0;i<t.length;i++)t[i].From&&(r=RBVH.Stada.WebPages.Utilities.String.toJSDate(t[i].From),r&&(t[i].From=Functions.parseVietnameseDateTimeToDDMMYYYY2(r))),t[i].To&&(u=RBVH.Stada.WebPages.Utilities.String.toJSDate(t[i].To),u&&(t[i].To=Functions.parseVietnameseDateTimeToDDMMYYYY2(u))),t[i].No=i+1;n.Settings.Grid2JsonArray=t}return f.resolve(n.Settings.Grid2JsonArray),f.promise()},insertItem:function(){},updateItem:function(){},deleteItem:function(){}},onItemInserting:function(t){var i=t.item.Content,r=t.item.Reason;if(i==""&&!i){alert(n.Settings.Messages.PleaseInputContentData);t.cancel=!0;return}if(!r||r==""){alert(n.Settings.Messages.PleaseInputReasonData);t.cancel=!0;return}this.ValidateSelectedDate(t)},ValidateSelectedDate:function(t){var u=t.item.FromDateString,f=t.item.ToDateString;if(u!=""&&f!=""){var i=Functions.parseVietNameseDate(u),e=Functions.parseVietNameseDate(f),r=new Date,o=new Date(r.getFullYear(),r.getMonth(),r.getDate());if(i&&i<o){alert(n.Settings.Messages.SelectedDateMustGreaterThanCurrentDate);t.cancel=!0;return}if(i&&e&&i>e){alert(n.Settings.Messages.FromDateToDateError);t.cancel=!0;return}}},onItemInserted:function(){n.RebindHiddenRepairDetailsFields(n.Settings.Grid2JsonArray)},onItemEditing:function(){},onItemUpdating:function(t){var i=t.item.Content,r=t.item.Reason;if(i==""&&!i){alert(n.Settings.Messages.PleaseInputContentData);t.cancel=!0;return}if(!r||r==""){alert(n.Settings.Messages.PleaseInputReasonData);t.cancel=!0;return}this.ValidateSelectedDate(t)},onItemUpdated:function(){n.RebindHiddenRepairDetailsFields(n.Settings.Grid2JsonArray)},onItemDeleted:function(){n.RebindHiddenRepairDetailsFields(n.Settings.Grid2JsonArray);for(var t=0;t<n.Settings.Grid2JsonArray.length;t++)n.Settings.Grid2JsonArray[t].No=t+1;n.Settings.Grid2JsonArray.length>1&&$(n.Settings.Controls.GridDetail2ControlSelector).jsGrid("loadData")},onItemEditCancelling:function(){},fields:n.Settings.Grid2.Fields})},RebindHiddenRepairDetailsFields:function(n){var r=this,i,t;if(n&&n.length>0){for(i=new Date,t=0;t<n.length;t++)n[t].From=i,n[t].To=i;$(r.Settings.Controls.hdDetailsRepairSelector).val(JSON.stringify(n))}},BindRequestRepairGridColumns:function(){var n=this;n.BindOrderNumber();n.BindDateTimeControl();jsGrid.fields.custOrderField=n.Settings.Grid2.CustomFields.NoField;jsGrid.fields.custFromField=n.Settings.Grid2.CustomFields.FromField;jsGrid.fields.custToField=n.Settings.Grid2.CustomFields.ToField;n.Settings.Grid2.Fields=[{name:"No",title:n.Settings.GridResources.GridOrderNumber,width:25,headercss:"header-center",type:"custOrderField"},{name:"Content",title:n.Settings.GridResources.GridRepairDetail_Content,width:250,align:"left",type:"text"},{name:"Reason",title:n.Settings.GridResources.GridRepairDetail_Reason,width:250,align:"left",type:"text"},{name:"Place",title:n.Settings.GridResources.GridRepairDetail_Place,width:150,align:"left",type:"text"},{name:"FromDateString",title:n.Settings.GridResources.GridRepairDetail_FromDate,width:60,align:"left",type:"custFromField"},{name:"ToDateString",title:n.Settings.GridResources.GridRepairDetail_ToDate,width:60,align:"left",type:"custToField"},{type:"control",editButton:!1,deleteButton:!n.Settings.IsViewMode,width:60,modeSwitchButton:!1}]},PopulateRequestOtherGrid:function(){var n=this;n.BindRequestOthersGridColumns();$(n.Settings.Controls.GridDetail3ControlSelector).jsGrid({width:"100%",height:"200px",align:"center",inserting:n.Settings.IsFormEditable,editing:n.Settings.IsFormEditable,sorting:!1,autoload:!0,noDataContent:"",deleteConfirm:n.Settings.ConfirmDeleteMessage,data:n.Settings.Data,onDataLoaded:function(){n.Settings.IsFormEditable==!1?n.DisbleDeleteButtonOnGrid():n.EnableButtonControls()},controller:{loadData:function(){var r=$.Deferred(),u=$(n.Settings.Controls.hdDetailsOthersSelector).val(),t,i;if(u!=""){for(t=JSON.parse(u),n.Settings.OldGrid3JsonArray=JSON.parse(JSON.stringify(t)),i=0;i<t.length;i++)t[i].No=i+1;n.Settings.Grid3JsonArray=t}return r.resolve(n.Settings.Grid3JsonArray),r.promise()},insertItem:function(){},updateItem:function(){},deleteItem:function(){}},onItemInserting:function(t){var r=t.item.Content,u=t.item.Reason,i;if(r==""&&!r){alert(n.Settings.Messages.PleaseInputContentData);t.cancel=!0;return}if(!u||u==""){alert(n.Settings.Messages.PleaseInputReasonData);t.cancel=!0;return}if(i=t.item.Quantity,i!=""&&(!$.isNumeric(i)||i<=0)){alert(n.Settings.Messages.QuantityDataError);t.cancel=!0;return}},onItemInserted:function(){n.RebindHiddenOthersDetailsFields(n.Settings.Grid3JsonArray)},onItemEditing:function(){},onItemUpdated:function(){n.RebindHiddenOthersDetailsFields(n.Settings.Grid3JsonArray)},onItemUpdating:function(t){var r=t.item.Content,u=t.item.Reason,i;if(r==""&&!r){alert(n.Settings.Messages.PleaseInputContentData);t.cancel=!0;return}if(!u||u==""){alert(n.Settings.Messages.PleaseInputReasonData);t.cancel=!0;return}if(i=t.item.Quantity,i!=""&&(!$.isNumeric(i)||i<=0)){alert(n.Settings.Messages.QuantityDataError);t.cancel=!0;return}},onItemDeleted:function(){n.RebindHiddenOthersDetailsFields(n.Settings.Grid3JsonArray);for(var t=0;t<n.Settings.Grid3JsonArray.length;t++)n.Settings.Grid3JsonArray[t].No=t+1;n.Settings.Grid3JsonArray.length>1&&$(n.Settings.Controls.GridDetail3ControlSelector).jsGrid("loadData")},onItemEditCancelling:function(){},fields:n.Settings.Grid3.Fields})},RebindHiddenOthersDetailsFields:function(n){var t=this;n&&n.length>0&&$(t.Settings.Controls.hdDetailsOthersSelector).val(JSON.stringify(n))},BindRequestOthersGridColumns:function(){var n=this;n.BindOrderNumber();jsGrid.fields.custOrderField=n.Settings.Grid3.CustomFields.NoField;n.Settings.Grid3.Fields=[{name:"No",title:n.Settings.GridResources.GridOrderNumber,width:25,headercss:"header-center",type:"custOrderField"},{name:"Content",title:n.Settings.GridResources.GridOthersDetail_Content,width:250,align:"left",type:"text"},{name:"Unit",title:n.Settings.GridResources.GridOthersDetail_Unit,width:65,align:"left",type:"text"},{name:"Quantity",title:n.Settings.GridResources.GridOthersDetail_Quantity,width:90,align:"left",type:"text",maxLength:15},{name:"Reason",title:n.Settings.GridResources.GridOthersDetail_Reason,width:350,align:"left",type:"text"},{type:"control",editButton:!1,deleteButton:!n.Settings.IsViewMode,width:60,modeSwitchButton:!1}]},CheckToShowReceivedBy:function(){try{var n=this,i=n.Settings.Controls.hdIsShowReceivedBySelector,t=n.Settings.Controls.trReceivedBySelector;$(i).val()=="1"?$(t).show():$(t).hide()}catch(r){}},CheckToShowFinishDate:function(){try{var n=this,i=n.Settings.Controls.hdIsShowFinishDateSelector,t=n.Settings.Controls.trFinishDateSelector;$(i).val()=="1"?$(t).show():$(t).hide()}catch(r){}},CheckToShowRequiredApprovalByBOD:function(){try{var n=this,i=n.Settings.Controls.hdIsShowRequiredApprovalByBODSelector,t=n.Settings.Controls.trRequireBODdApproveSelector;$(i).val()=="1"?$(t).show():$(t).hide()}catch(r){}},CheckToShowDueDate:function(){try{var n=this,i=n.Settings.Controls.hdIsShowDueDateSelector,t=n.Settings.Controls.trDueDateSelector;$(i).val()=="1"?$(t).show():$(t).hide()}catch(r){}},FilterDepartmentAccordingToRequestType:function(){var f,n;try{var i=this,t=i.Settings.Controls.ddlReceivedBySelector,e=i.Settings.Controls.hdRequestTypeSelector,o=i.Settings.Controls.hdSelectedReceivedBySelector,s=$(e).val(),r=!1,u=!1;$(t).attr("disabled")=="disabled"&&(u=!0);f=$(o).val();n=parseInt(f);$(t).find("option").each(function(t,i){$(i).removeAttr("selected");var o=$(i).attr("request-type"),e=o.split(";"),f=!1;for(idx=0;idx<e.length;idx++)if(e[idx]==s){f=!0;break}f?$(i).showOption():$(i).hideOption();f==!0&&r==!1&&u==!1&&n==0&&(n=parseInt($(i).val()),r=!0)});n>=0?($(t).find('option[value="'+n.toString()+'"]').attr("selected","selected"),$(t).val(n).change()):$(t).empty()}catch(h){}},SetUrlReferTo:function(){var i,r,t,n,u,f;try{i=this;r=i.Settings.Controls.ddlReferToSelector;$(r).length>0&&(t=$(r).val(),n=i.Settings.Controls.linkReferToSelector,t!="0"&&t!=null&&t!="undefined"?(u=$(r).find("option:selected").text(),f=$(i.Settings.Controls.hdDisplayFormUrlSelector).val(),f+=t,$(n).attr("url",f),$(n).attr("title",u),$(n).text(u)):($(n).attr("url",""),$(n).attr("title",""),$(n).text("")))}catch(e){}},ShowErrorMessage:function(){try{var t=this,n=t.Settings.Controls.hdErrorMessageSelector;$(n).val()!=""&&alert($(n).val())}catch(i){}}};