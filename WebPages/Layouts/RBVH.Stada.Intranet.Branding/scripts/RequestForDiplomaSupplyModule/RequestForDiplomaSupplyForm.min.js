function ValidateBeforeSaveAndSubmit(){var n=requestForDiplomaSupplyFormInstance.ValidateForm(),t=supportingDocumentInstance.ValidateAttachments();return n==!0&&t==!0}RBVH.Stada.javascript.common.NamespaceManager.register("RBVH.Stada.WebPages.pages");RBVH.Stada.WebPages.pages.RequestForDiplomaSupplyForm=function(n){this.Protocol=window.location.protocol;this.Settings={Controls:{InputFileContainer:"#ctl00_PlaceHolderMain_RequestForDiplomaSuppliesForm_SupportingDocumentControl_GridSupportingDocument"},EmployeeID:"",FullName:"",LocationId:0,DepartmentId:0,ID:0,Grid:{CustomFields:{CurrentDiplomaField:null,GraduationYearField:null,NewDiplomaField:null,FacultyField:null,IssuedPlaceField:null,TrainingDurationField:null,RequestField:null}},Fields:[],Data:[],GridJsonArray:[],IsFormEditable:!1,SupportingDocuments:[]};$.extend(!0,this.Settings,n);this.Initialize()};RBVH.Stada.WebPages.pages.RequestForDiplomaSupplyForm.prototype={Initialize:function(){var n=this;$(document).ready(function(){SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){n.InitControls();n.EventsRegister();n.ShowErrorMessage()})})},InitControls:function(){var n=this,i=$(n.Settings.Controls.hdIsEditableSelector).val(),t;n.Settings.IsFormEditable=i=="True";n.LoadEmployeeInformation();n.PopulateGrid();$(n.Settings.Controls.dtFromDateSelector)&&$(n.Settings.Controls.dtFromDateSelector).attr("disabled")=="disabled"&&$(n.Settings.Controls.dtFromDateSelector).parent().next().hide();$(n.Settings.Controls.dtFromDateSelector).keydown(function(n){return n.preventDefault(),!1});n.Settings.IsFormEditable==!0&&($(n.Settings.Controls.ddlEmployeeSelector).select2(),n.Settings.SupportingDocuments=[],$(n.Settings.Controls.SupportingDocumentDeletedItemSelector).each(function(){n.Settings.SupportingDocuments.push($(this).attr("name"))}));n.SetCurrentValueForControls();t=$(n.Settings.Controls.ApprovalStatusValueSelector).val();!t||($(n.Settings.Controls.ApprovalStatusTdSelector).html(RBVH.Stada.WebPages.Utilities.GUI.generateItemStatus(t)),$(n.Settings.Controls.ApprovalStatusTrSelector).show())},SetCurrentValueForControls:function(){var n=this;n.SetAttributeValue(n.Settings.Controls.ddlEmployeeSelector,$(n.Settings.Controls.ddlEmployeeSelector+" option:selected").val());n.SetAttributeValue(n.Settings.Controls.txtPositionSelector,$(n.Settings.Controls.txtPositionSelector).val());n.SetAttributeValue(n.Settings.Controls.txtToTheDailyWorksSelector,$(n.Settings.Controls.txtToTheDailyWorksSelector).val());n.SetAttributeValue(n.Settings.Controls.txtNewSuggestionsSelector,$(n.Settings.Controls.txtNewSuggestionsSelector).val());n.SetAttributeValue(n.Settings.Controls.CommentSelector,$(n.Settings.Controls.CommentSelector).val());n.SetAttributeValue(n.Settings.Controls.InputFileContainer,$(n.Settings.Controls.InputFileContainer+" input[type='file']").length);n.SetAttributeValue(n.Settings.Controls.hdGridDetailsValueSelector,JSON.stringify(n.GetPureArray()))},GetPureArray:function(){for(var t,i=this,r=[],n=0;n<i.Settings.GridJsonArray.length;n++)t={},t.CurrentDiploma=i.Settings.GridJsonArray[n].CurrentDiploma,t.GraduationYear=i.Settings.GridJsonArray[n].GraduationYear,t.NewDiploma=i.Settings.GridJsonArray[n].NewDiploma,t.Faculty=i.Settings.GridJsonArray[n].Faculty,t.IssuedPlace=i.Settings.GridJsonArray[n].IssuedPlace,t.IssuedPlace=i.Settings.GridJsonArray[n].IssuedPlace,r.push(t);return r},SetAttributeValue:function(n,t){var i="current-value";n&&(t&&t!=""?$(n).attr(i,t):$(n).attr(i,""))},EventsRegister:function(){var n=this;$(n.Settings.Controls.ddlEmployeeSelector).change(function(){n.LoadEmployeeInformation()})},LoadEmployeeInformation:function(){var n=this,i=$(n.Settings.Controls.ddlEmployeeSelector+" option:selected").val(),t;i&&(i=="0"?($(n.Settings.Controls.txtEmployeeCodeSelector).val(""),$(n.Settings.Controls.lblDateOfEmpSelector).text("")):(t=$(n.Settings.Controls.ddlEmployeeSelector+" option[value='"+i+"']"),t&&($(n.Settings.Controls.txtEmployeeCodeSelector).val(t.attr("employeecode")),$(n.Settings.Controls.lblDateOfEmpSelector).text(t.attr("dateofemp")))))},DisbleDeleteButtonOnGrid:function(){$(".jsgrid-button.jsgrid-delete-button").prop("disabled",!0);$(".jsgrid-button.jsgrid-delete-button").css("opacity",.1)},PopulateGrid:function(){var n=this;n.BindGridColumns();$(n.Settings.Controls.GridDetailsSelector).jsGrid({width:"100%",height:"170px",align:"center",inserting:n.Settings.IsFormEditable,editing:n.Settings.IsFormEditable,sorting:!1,autoload:!0,noDataContent:"",deleteConfirm:n.Settings.ConfirmDeleteMessage,data:n.Settings.Data,onDataLoaded:function(){n.Settings.IsFormEditable==!1&&n.DisbleDeleteButtonOnGrid()},controller:{loadData:function(){var t=$.Deferred(),i=$(n.Settings.Controls.hdRequestDiplomaDetailsSelector).val(),r;return i!=""&&(r=JSON.parse(i),n.Settings.GridJsonArray=r),t.resolve(n.Settings.GridJsonArray),t.promise()},insertItem:function(){},updateItem:function(){},deleteItem:function(){}},onItemInserting:function(n){this.ValiateGridItem(n)==!1&&(n.cancel=!0)},onItemInserted:function(){n.RebindHiddenFields(n.Settings.GridJsonArray)},onItemEditing:function(){},onItemUpdated:function(){n.RebindHiddenFields(n.Settings.GridJsonArray)},onItemUpdating:function(n){this.ValiateGridItem(n)==!1&&(n.cancel=!0)},ValiateGridItem:function(t){var i=0;return i+=n.ValiateEmptyField(t.item.NewDiploma),i+=n.ValiateEmptyField(t.item.Faculty),i+=n.ValiateEmptyField(t.item.IssuedPlace),i+=n.ValiateEmptyField(t.item.TrainingDuration),i>0&&alert(n.Settings.ResourceText.ErrorMessage_PleaseInputData),i==0},onItemDeleted:function(){n.RebindHiddenFields(n.Settings.GridJsonArray)},onItemEditCancelling:function(){},fields:n.Settings.Grid.Fields})},RebindHiddenFields:function(n){var t=this;n&&$(t.Settings.Controls.hdRequestDiplomaDetailsSelector).val(JSON.stringify(n))},ValiateEmptyField:function(n){return!n||n==""?1:0},AppendInputFile:function(){var t=this,n=t.Settings.DocumentCount++;$(t.Settings.Controls.DocumentFilesDivSelector).append("<input type='file' name='supportingDocument"+n+"' style='display:inline'>  <span id='supportingDocument"+n+"' class='glyphicon glyphicon-trash span-remove'><\/span>  <span spanErrorName='supportingDocument"+n+"' class='ms-formvalidation ms-csrformvalidation'><\/span><br/>")},ValidateForm:function(){var n=this,i=n.ValidateRequiredField(),r=n.ValiateEmployee(),u=n.ValidateInputDate(),f=this.ValidateDetailGrid(),e=i==!0&&r==!0&&u==!0&&f==!0,t=!1;return e==!0&&(t=n.IsFormValueChanged()),t},ValidateRequiredField:function(){$("span[class='ms-formvalidation ms-csrformvalidation']").html("");var n=this,t=0;return t+=n.ValidateEmptyField($(n.Settings.Controls.txtPositionSelector).val(),n.Settings.Controls.txtPositionSelector_Error,n.Settings.ResourceText.CantLeaveTheBlank)==!0?0:1,t+=n.ValidateEmptyField($(n.Settings.Controls.txtToTheDailyWorksSelector).val(),n.Settings.Controls.txtToTheDailyWorksSelector_Error,n.Settings.ResourceText.CantLeaveTheBlank)==!0?0:1,t+=n.ValidateEmptyField($(n.Settings.Controls.txtNewSuggestionsSelector).val(),n.Settings.Controls.txtNewSuggestionsSelector_Error,n.Settings.ResourceText.CantLeaveTheBlank)==!0?0:1,t==0},ValiateEmployee:function(){var n=this,t=$(n.Settings.Controls.ddlEmployeeSelector+" option:selected").val();return t&&t!="0"?($(n.Settings.Controls.ddlFullNameSelector_Error).html(""),!0):($(n.Settings.Controls.ddlFullNameSelector_Error).html(n.Settings.ResourceText.PleaseSelectEmp),!1)},ValidateEmptyField:function(n,t,i){return n&&n!=""?($(t).hide(),!0):($(t).html(i),$(t).show(),!1)},ValidateInputDate:function(){var n=this,t=new Date,u=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=$(n.Settings.Controls.dtFromDateSelector).val(),r;return i&&i!=""?(r=Functions.parseVietNameseDate(i),r<u?($(n.Settings.Controls.dtFromDateSelector_Error).html(n.Settings.ResourceText.ErrorMessage_WrongFromDate),$(n.Settings.Controls.dtFromDateSelector_Error).show(),!1):($(n.Settings.Controls.dtFromDateSelector_Error).hide(),!0)):!0},ValidateDetailGrid:function(){var n=this;return!n.Settings.GridJsonArray||n.Settings.GridJsonArray.length==0?(alert(n.Settings.ResourceText.ErrorMessage_PleaseInputDetailGrid),!1):!0},BindGridColumns:function(){var n=this;n.Settings.Grid.Fields=[{name:"CurrentDiploma",title:n.Settings.ResourceText.DetailGrid_CurrentDiploma,width:100,type:"text",align:"left"},{name:"GraduationYear",title:n.Settings.ResourceText.DetailGrid_GraduationYear,width:40,align:"left",type:"text"},{name:"NewDiploma",title:n.Settings.ResourceText.DetailGrid_NewDiploma,width:100,align:"left",type:"text"},{name:"Faculty",title:n.Settings.ResourceText.DetailGrid_Faculty,width:80,align:"left",type:"text"},{name:"IssuedPlace",title:n.Settings.ResourceText.DetailGrid_IssuedPlace,width:60,align:"left",type:"text"},{name:"TrainingDuration",title:n.Settings.ResourceText.DetailGrid_TrainingDuration,width:80,align:"left",type:"text"},{type:"control",editButton:!1,deleteButton:!n.Settings.IsViewMode,width:30,modeSwitchButton:!1}]},ShowErrorMessage:function(){try{var t=this,n=t.Settings.Controls.hdErrorMessageSelector;$(n).val()!=""&&alert($(n).val())}catch(i){}},IsFormValueChanged:function(){var n=this,i="current-value",t=0,r;return t+=n.CheckIfValueChange($(n.Settings.Controls.ddlEmployeeSelector).attr(i),$(n.Settings.Controls.ddlEmployeeSelector+" option:selected").val()),t+=n.CheckIfValueChange($(n.Settings.Controls.txtPositionSelector).attr(i),$(n.Settings.Controls.txtPositionSelector).val()),t+=n.CheckIfValueChange($(n.Settings.Controls.txtToTheDailyWorksSelector).attr(i),$(n.Settings.Controls.txtToTheDailyWorksSelector).val()),t+=n.CheckIfValueChange($(n.Settings.Controls.txtNewSuggestionsSelector).attr(i),$(n.Settings.Controls.txtNewSuggestionsSelector).val()),t+=n.CheckIfValueChange($(n.Settings.Controls.CommentSelector).attr(i),$(n.Settings.Controls.CommentSelector).val()),t+=n.CheckIfValueChange($(n.Settings.Controls.hdGridDetailsValueSelector).attr(i),JSON.stringify(n.GetPureArray())),r=[],$(n.Settings.Controls.SupportingDocumentDeletedItemSelector).each(function(){r.push($(this).attr("name"))}),t+=$(n.Settings.SupportingDocuments).not(r).length===0&&$(r).not(n.Settings.SupportingDocuments).length===0?0:1,$(n.Settings.Controls.InputFileContainer+" input[type='file']").length!=$(n.Settings.Controls.InputFileContainer).attr(i)&&t++,t==0?(alert(n.Settings.ResourceText.DataMustBeDiffrent),!1):!0},CheckIfValueChange:function(n,t){return n&&t&&n!=t?1:0}};