function Calendar_OverrideFun(){return""}function Calendar_OnPostRender(n){JSRequest.EnsureSetup();var w=new Date,b=new Date,e,h,u,t,l,a=864e5,v="",f="",o=[],p=n.listUrlDir,s,c=[],i=[],y=["su","mo","tu","we","th","fr","sa"],r=[];(function(w){function nt(){w(c).each(function(n,t){if(t.RecurrenceID!==""){var u=new Date(t.RecurrenceID);u.setMinutes(u.getMinutes()+(new Date).getTimezoneOffset());r.push(b(t.UID,u));t.Title.indexOf("Deleted:")==-1&&t.Title.indexOf("Đã xóa:")==-1&&i.push(t)}});w(c).each(function(n,t){try{if(t.RecurrenceID==="")if(f=t.RecurrenceData,f!==""){f=f.replace(new RegExp("&lt;","g"),"<").replace(new RegExp("&gt;","g"),">").replace(new RegExp("&quot;","g"),"'");recurrenceXmlNode=w.parseXML(f);var o=recurrenceXmlNode.getElementsByTagName("daily"),s=recurrenceXmlNode.getElementsByTagName("weekly"),h=recurrenceXmlNode.getElementsByTagName("monthly"),r=recurrenceXmlNode.getElementsByTagName("repeatForever"),u=recurrenceXmlNode.getElementsByTagName("repeatInstances"),e=recurrenceXmlNode.getElementsByTagName("windowEnd");o.length>0?tt(t,o,r,u,e):s.length>0?it(t,s,r,u,e):h.length>0&&ut(t,h,r,u,e)}else i.push(t)}catch(c){}});w(i).each(function(n,i){var f,r;try{for(t=new Date(i.EventDate),l=new Date(i.EndDate),f=Math.floor(Math.abs((l.getTime()-t.getTime())/a)),v=i.Category,h=p+"/DispForm.aspx?ID="+i.ID,u=i["fAllDayEvent.value"]==="1"?"(All day event)":new Date(i.EventDate).getDate()==new Date(i.EndDate).getDate()?"("+moment(i.EventDate).format("LT")+" - "+moment(i.EndDate).format("LT")+")":"("+moment(i.EventDate).format("DD/MM/YYYY HH:mm")+" - "+moment(i.EndDate).format("DD/MM/YYYY HH:mm")+")",r=0;r<=f;r++)w("#divDatePickerOne .ui-datepicker-calendar a").first().parent("td").attr("data-year")==t.getFullYear()&&w(".ui-datepicker-calendar a").first().parent("td").attr("data-month")==t.getMonth()&&(dateToCheckText=moment(t).format("DD/MM"),dateIsExisted=et(dateToCheckText),dateIsExisted?(d(t,"Multi"),e='<li class="divCalendarLI1"><a class="anchCalLi" onclick=\'window.open(this.href)\'href="'+h+"&Source="+encodeURIComponent(window.location.href)+'">'+i.Title+"<\/a> "+u+"<\/li>",w("#"+t.getDate()+"_eventPopUp .divCalendarUL1").append(e)):(d(t,v),ot(t,u,h,i.Title),o.push(dateToCheckText))),t.setDate(t.getDate()+1)}catch(s){}});o=[];i=[]}function tt(n,t,u,f,e){var h,y,l,p;try{if(h=t[0].attributes.dayFrequency,h!=null){var v=parseInt(h.value),o=new Date(n.EventDate),c=new Date(n.EndDate),s=0;for(u.length>0?s=500:f.length>0?s=parseInt(f[0].innerHTML):e.length>0&&(y=Math.floor(Math.abs((c.getTime()-o.getTime())/a))+1,s=Math.ceil(Math.abs(y/v))),l=0;l<s;l++)p=b(n.UID,o),r.indexOf(p)==-1&&i.push({ID:b(n.ID,o),Title:n.Title,EventDate:new Date(o),EndDate:new Date(o.getFullYear(),o.getMonth(),o.getDate(),c.getHours(),c.getMinutes(),0,0),Category:n.Category,fAllDayEvent:n.fAllDayEvent}),o.setDate(o.getDate()+v)}}catch(w){}}function it(n,t,i,r,u){var e;try{if(e=t[0].attributes.weekFrequency,e!==null){var o=parseInt(e.value),s=new Date(n.EventDate),h=new Date(n.EndDate),f;i.length>0?(f=500,k(n,t,o,s,h,f)):r.length>0?(f=parseInt(r[0].innerHTML),k(n,t,o,s,h,f)):u.length>0&&rt(n,t,o,s,h)}}catch(c){}}function k(n,t,u,f,e,o){var c,h,a;for(s=0;s<o;){for(c=0;c<7&&s<o;c++){h=new Date(f);h.setDate(h.getDate()+c);var l=h.getDay(),v=y[l],p=t[0].attributes[v];p!=null&&(a=b(n.UID,h),r.indexOf(a)==-1&&i.push({ID:b(n.ID,h),Title:n.Title,EventDate:new Date(h),EndDate:new Date(h.getFullYear(),h.getMonth(),h.getDate(),e.getHours(),e.getMinutes(),0,0),Category:n.Category,fAllDayEvent:n.fAllDayEvent}),s++);l===6&&f.getDay()!==0&&(h.setDate(h.getDate()+1-7),f=new Date(h),c=7)}f.setDate(f.getDate()+u*7)}}function rt(n,t,u,f,e){for(var o=new Date(f),s,c;o<=e;){for(s=0;s<7;s++){o=new Date(f);o.setDate(o.getDate()+s);var h=o.getDay(),l=y[h],a=t[0].attributes[l];a!=null&&o<=e&&(c=b(n.UID,o),r.indexOf(c)==-1&&i.push({ID:b(n.ID,o),Title:n.Title,EventDate:new Date(o),EndDate:new Date(o.getFullYear(),o.getMonth(),o.getDate(),e.getHours(),e.getMinutes(),0,0),Category:n.Category,fAllDayEvent:n.fAllDayEvent}));h===6&&f.getDay()!==0&&(o.setDate(o.getDate()+1-7),f=new Date(o),s=7)}f.setDate(f.getDate()+u*7)}}function ut(n,t,u,f,e){var s,l,a,y;try{if(s=t[0].attributes.monthFrequency,s!=null){var v=parseInt(s.value),o=new Date(n.EventDate),h=new Date(n.EndDate),c=0;for(u.length>0?c=20:f.length>0?c=parseInt(f[0].innerHTML):e.length>0&&ft(n,t,v,o,h),l=parseInt(t[0].attributes.day.value),a=0;a<c;a++)y=b(n.UID,o),r.indexOf(y)==-1&&i.push({ID:b(n.ID,o),Title:n.Title,EventDate:new Date(o.getFullYear(),o.getMonth(),l,o.getHours(),o.getMinutes(),0,0),EndDate:new Date(o.getFullYear(),o.getMonth(),l,h.getHours(),h.getMinutes(),0,0),Category:n.Category,fAllDayEvent:n.fAllDayEvent}),o.setMonth(o.getMonth()+v)}}catch(p){}}function ft(n,t,u,f,e){for(var o=parseInt(t[0].attributes.day.value),s;f<=e;)s=b(n.UID,f),r.indexOf(s)==-1&&i.push({ID:b(n.ID,f),Title:n.Title,EventDate:new Date(f.getFullYear(),f.getMonth(),o,f.getHours(),f.getMinutes(),0,0),EndDate:new Date(f.getFullYear(),f.getMonth(),o,e.getHours(),e.getMinutes(),0,0),Category:n.Category,fAllDayEvent:n.fAllDayEvent}),f.setMonth(f.getMonth()+u)}function b(n,t){return n+".0."+moment(new Date(t.valueOf()+t.getTimezoneOffset()*6e4)).format("YYYY-MM-DDTHH:mm:ss")+"Z"}function et(){for(var n=0;n<o.length;n++)if(o[n]==dateToCheckText)return!0;return!1}function d(n,t){var i="",r="";if(n.format("dd/MM")!=(new Date).format("dd/MM"))switch(t){case"Meeting":i="#fff2cc";r="1px solid #bf8f00";break;case"Business":i="#bdd7ee";r="1px solid #2f75b5";break;case"Birthday":i="#fce4d6";r="1px solid #c65911";break;case"Holiday":i="#E2EFDA";r="1px solid #548235";break;case"Get-together":i="#8EA9DB";r="1px solid #305496";break;case"Gifts":i="#D6DCE4";r="1px solid #333F4F";break;case"Anniversary":i="#FDDBF7";r="1px solid #86086E";break;case"Weekend":i="#fc3424";r="1px solid #4A442A";break;case"Compensation Day-Off":i="#49DF5D";r="1px solid #49DF5D";break;case"On Leave":i="F5EB67";r="1px solid #49DF5D";break;case"Multi":i="";r="2px solid #2f75b5";break;default:i="";r="1px solid #2989d1"}w("#divDatePickerOne .ui-datepicker-calendar a").filter(function(){return w(this).text()==n.getDate()&&w(this).parent("td").attr("data-year")==n.getFullYear()&&w(this).parent("td").attr("data-month")==n.getMonth()}).css("border",r).css("background",i)}function ot(n,t,i,r){w("#"+n.getDate()+"_eventPopUp").html()!=null&&w("#"+n.getDate()+"_eventPopUp").empty();w("#divDatePickerOne .ui-datepicker-calendar a").filter(function(){return w(this).text()==n.getDate()&&w(this).parent("td").attr("data-year")==n.getFullYear()&&w(this).parent("td").attr("data-month")==n.getMonth()}).parent("td").append("<div class='eventPopUpDiv' id='"+n.getDate()+"_eventPopUp' style='display:none'><\/div> ");w("#divDatePickerOne .ui-datepicker-calendar a").filter(function(){return w(this).text()==n.getDate()&&w(this).parent("td").attr("data-year")==n.getFullYear()&&w(this).parent("td").attr("data-month")==n.getMonth()}).parent("td").mouseover(function(){document.getElementById(w(this).find("a").first().text()+"_eventPopUp").style.display="inline"});w("#divDatePickerOne .ui-datepicker-calendar a").filter(function(){return w(this).text()==n.getDate()&&w(this).parent("td").attr("data-year")==n.getFullYear()&&w(this).parent("td").attr("data-month")==n.getMonth()}).parent("td").mouseout(function(){document.getElementById(w(this).find("a").first().text()+"_eventPopUp").style.display="none"});e='<li class="divCalendarLI1" ><a class="anchCalLi" onclick=\'window.open(this.href)\' href="'+i+"&Source="+encodeURIComponent(window.location.href)+'">'+r+"<\/a> "+t+"<\/li>";w("#"+n.getDate()+"_eventPopUp").append("<h1 class='calHead'>"+moment(n).format("LL")+"<\/h1 >");w("#"+n.getDate()+"_eventPopUp").append("<ul class = 'divCalendarUL1'>");w("#"+n.getDate()+"_eventPopUp .divCalendarUL1").append(e)}var g=w.datepicker._updateDatepicker;w.datepicker._updateDatepicker=function(n){g.apply(this,[n]);nt()};c=n.ListData.Row;w("#divDatePickerOne").datepicker()})(jQuery)}(function(){var n={};n.Templates={};n.Templates.Header='<div id="divDatePickerOne">';n.OnPostRender=Calendar_OnPostRender;n.Templates.Item=Calendar_OverrideFun;n.Templates.Footer="<\/div>";n.BaseViewID=1;n.ListTemplateType=106;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(n)})();