function openDialogBox(n){var t={url:n,width:800,height:400,showClose:!0,allowMaximize:!1,title:ChangeShiftApprovalTaskConfig.ViewDetail};SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",t)}function PostRender(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){ChangeShiftApprovalTaskConfig.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(ChangeShiftApprovalTaskConfig.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+ChangeShiftApprovalTaskConfig.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(ChangeShiftApprovalTaskConfig.ListResourceFileName,"Res",OnListResourcesReady);SP.SOD.registerSod(ChangeShiftApprovalTaskConfig.PageResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+ChangeShiftApprovalTaskConfig.PageResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(ChangeShiftApprovalTaskConfig.PageResourceFileName,"Res",OnPageResourcesReady)},"strings.js");$(".approve-request").click(function(){$(this).prop("disabled",!0);DoApprove($(this).attr("data-id"))});$(".reject-request").click(function(){$(this).prop("disabled",!0);DoReject($(this).attr("data-id"))});$(".viewdetailapproval").click(function(){url=$(this).attr("data-url");openDialogBox(url)})}function OnListResourcesReady(){$("#requesterTH").text(Res.changeShiftList_Requester);$("#fromshift").text(Res.changeShiftList_FromShift);$("#toshift").text(Res.changeShiftList_ToShift);$("#from").text(Res.changeShiftList_FromDate);$("#to").text(Res.changeShiftList_ToDate);$("#created").text(Res.createdDate);$("#reason").text(Res.changeShiftManagement_Reason);$("#actionTH").text(Res.changeShiftManagement_ViewTitle);$("#comment").text(Res.commonComment);$(".label-success").text(Res.approvalStatus_Approved);$(".label-default").text(Res.approvalStatus_InProgress);$(".label-warning").text(Res.approvalStatus_Cancelled);$(".label-danger").text(Res.approvalStatus_Rejected);$(".cancel-request").text(Res.changeShiftManagement_CancelRequest)}function OnPageResourcesReady(){$(".approve-request").text(Res.approveButton);$(".reject-request").text(Res.rejectButton);ChangeShiftApprovalTaskConfig.ViewDetail=Res.viewDetail}function pad(n){return n<10?"0"+n:n}function CustomItem(n){var r="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",u="<td>"+n.CurrentItem.FromShift[0].lookupValue+"<\/td>",f="<td>"+n.CurrentItem.ToShift[0].lookupValue+"<\/td>",e="<td>"+n.CurrentItem.CommonFrom+"<\/td>",o="<td>"+n.CurrentItem.To+"<\/td>",s="<td>"+n.CurrentItem.Created+"<\/td>",h="<td>"+n.CurrentItem.Reason+"<\/td>",c='<td><input type="text" class="form-control comment'+n.CurrentItem.ID+'" ><\/input><\/td>',w=n.CurrentItem.ApprovalStatus,t=window.location.href.split("#")[0];t=Functions.removeParam("lang",t);t+="#tab2";t=encodeURIComponent(t);var l='<span><a data-url="/Lists/ChangeShiftManagement/DispForm.aspx?ID='+n.CurrentItem.ID+"&TextOnly=true&Source="+t+'"   class="table-action viewdetailapproval"><i class="fa fa-eye" aria-hidden="true"><\/i><\/a><\/span>',a="<td>"+l+"<\/td>",i="",v="<button type='button' class='btn btn-success btn-sm approve-request' data-approvalStatus='"+n.CurrentItem.ApprovalStatus+"'  data-id='"+n.CurrentItem.ID+"' data-emp-id='"+n.CurrentItem.Requester[0].lookupId+"' "+i+">Approve<\/button>",y="<button type='button' class='btn btn-default btn-sm reject-request'  data-id='"+n.CurrentItem.ID+"' "+i+">Reject<\/button>",p="<td>"+v+"   "+y+"<td>";return"<tr>"+r+u+f+e+o+s+h+a+c+p+"<\/tr>"}function pagingControl(n){return ViewUtilities.Paging.InstanceHtml(n)}function DoApprove(n){var t={},i;t.Id=n;t.Comment=$(".comment"+n).val();t.ApproverName=_rbvhContext.EmployeeInfo.FullName;t.ApproverId=_rbvhContext.EmployeeInfo.ADAccount.ID;i=RBVH.Stada.WebPages.Utilities.String.format(ChangeShiftApprovalTaskConfig.ApproveRequest,location.host);$.ajax({type:"POST",url:i,data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(n){n.Code===2&&alert(n.Message);Redirect()})}function DoReject(n){var t={},i;t.Id=n;t.Comment=$(".comment"+n).val();t.ApproverName=_rbvhContext.EmployeeInfo.FullName;t.ApproverId=_rbvhContext.EmployeeInfo.ADAccount.ID;i=RBVH.Stada.WebPages.Utilities.String.format(ChangeShiftApprovalTaskConfig.RejectRequest,location.host);$.ajax({type:"POST",url:i,data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(n){n.Code===3&&alert(n.Message);Redirect()})}function Redirect(){var n=Functions.getParameterByName("Source");n?Functions.redirectToSource():window.location.reload()}(function(){function t(n){return ViewUtilities.Paging.InstanceHtml(n)}function i(t){var i={url:t,width:800,height:400,showClose:!0,allowMaximize:!1,title:n.ViewDetail};SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",i)}function r(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",u);SP.SOD.registerSod(n.PageResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.PageResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.PageResourceFileName,"Res",f)},"strings.js");$(".viewdetaildepreq").click(function(){url=$(this).attr("data-url");i(url)})}function u(){$("#requesterTH_csrDept").text(Res.changeShiftList_Requester);$("#fromshift_csrDept").text(Res.changeShiftList_FromShift);$("#toshift_csrDept").text(Res.changeShiftList_ToShift);$("#from_csrDept").text(Res.changeShiftList_FromDate);$("#to_csrDept").text(Res.changeShiftList_ToDate);$("#created_csrDept").text(Res.createdDate);$("#reason_csrDept").text(Res.changeShiftManagement_Reason);$("#comment_csrDept").text(Res.commonComment);$("#approvalStatus_csrDept").text(Res.changeShiftManagement_ApprovalStatus);$("#action_csrDept").text(Res.changeShiftManagement_ViewTitle);$(".label-success").text(Res.approvalStatus_Approved);$(".label-default").text(Res.approvalStatus_InProgress);$(".label-warning").text(Res.approvalStatus_Cancelled);$(".label-danger").text(Res.approvalStatus_Rejected);$(".cancel-request").text(Res.changeShiftManagement_CancelRequest)}function f(){n.ViewDetail=Res.viewDetail}function e(n){var e="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",o="<td>"+n.CurrentItem.FromShift[0].lookupValue+"<\/td>",s="<td>"+n.CurrentItem.ToShift[0].lookupValue+"<\/td>",h="<td>"+n.CurrentItem.CommonFrom+"<\/td>",c="<td>"+n.CurrentItem.To+"<\/td>",l="<td>"+n.CurrentItem.Created+"<\/td>",a="<td>"+n.CurrentItem.Reason+"<\/td>",v="<td>"+n.CurrentItem.CommonComment+"<\/td>",i=n.CurrentItem.ApprovalStatus+"",t=window.location.href.split("#")[0],u,f,r;return t=Functions.removeParam("lang",t),t+="#tab3",t=encodeURIComponent(t),u='<span><a data-url="/Lists/ChangeShiftManagement/DispForm.aspx?ID='+n.CurrentItem.ID+"&TextOnly=true&Source="+t+'"   class="table-action viewdetaildepreq"><i class="fa fa-eye" aria-hidden="true"><\/i><\/a><\/span>',f="<td>"+u+"<\/td>",i=i.toLowerCase(),r="",r=i=="approved"?'<td><span class="label label-success">Approved<\/span><\/td>':i=="cancelled"?'<td><span class="label label-warning">Cancelled<\/span><\/td>':i=="rejected"?'<td><span class="label label-danger">Rejected<\/span><\/td>':'<td><span class="label label-default">In-Progress<\/span><\/td>',"<tr>"+e+o+s+h+c+l+a+v+r+f+"<\/tr>"}var n={ChangeShiftManagement_Requester:"Requester",ChangeShiftManagement_FromShift:"From Shift",ChangeShiftManagement_ToShift:"To Shift",ChangeShiftManagement_From:"From",ChangeShiftManagement_To:"To",ChangeShiftManagement_Created:"Created",Comment:"Comment",ChangeShiftManagement_Reason:"Reason",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",ViewDetail:"View item detail"};(function(){var i={};i.Templates={};i.Templates.Item=e;i.OnPreRender=function(){$(".ms-menutoolbar").hide()};i.ListTemplateType=10011;i.BaseViewID=1;i.OnPostRender=r;i.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='requesterTH_csrDept'>"+n.ChangeShiftManagement_Requester+"<\/th><th id='fromshift_csrDept'>"+n.ChangeShiftManagement_FromShift+"<\/th><th id='toshift_csrDept'>"+n.ChangeShiftManagement_ToShift+"<\/th><th id='from_csrDept'>"+n.ChangeShiftManagement_From+"<\/th><th id='to_csrDept'>"+n.ChangeShiftManagement_To+"<\/th><th id='created_csrDept'>"+n.ChangeShiftManagement_Created+"<\/th><th id='reason_csrDept'>"+n.ChangeShiftManagement_Reason+"<\/th><th id='comment_csrDept'>"+n.Comment+"<\/th><th id='approvalStatus_csrDept'>"+n.ChangeShiftManagement_ApprovalStatus+"<\/th><th id='action_csrDept'>"+n.ChangeShiftManagement_ViewTitle+"<\/th><th><\/th><\/tr><\/thead><tbody>";i.Templates.Footer=t;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(i)})()})(),function(){function t(t){var i={url:t,width:800,height:400,showClose:!0,allowMaximize:!1,title:n.ViewDetail};SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",i)}function i(){SP.SOD.executeOrDelayUntilScriptLoaded(function(){n.Locale=Strings.STS.L_CurrentUICulture_Name;SP.SOD.registerSod(n.ListResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.ListResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.ListResourceFileName,"Res",r);SP.SOD.registerSod(n.PageResourceFileName,"/_layouts/15/ScriptResx.ashx?name="+n.PageResourceFileName+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));SP.SOD.executeFunc(n.PageResourceFileName,"Res",u)},"strings.js");$(".cancel-request").click(function(){o($(this).attr("data-id"),$(this));$(this).attr("disabled","true")});$(".viewdetailmyrequest").click(function(){url=$(this).attr("data-url");t(url)})}function r(){$("#requesterTH_csRequest").text(Res.changeShiftList_Requester);$("#fromshift_csRequest").text(Res.changeShiftList_FromShift);$("#toshift_csRequest").text(Res.changeShiftList_ToShift);$("#from_csRequest").text(Res.changeShiftList_FromDate);$("#to_csRequest").text(Res.changeShiftList_ToDate);$("#created_csRequest").text(Res.createdDate);$("#reason_csRequest").text(Res.changeShiftManagement_Reason);$("#comment_csRequest").text(Res.commonComment);$("#approvalStatus_csRequest").text(Res.changeShiftManagement_ApprovalStatus);$("#action_csRequest").text(Res.changeShiftManagement_ViewTitle);$(".label-success").text(Res.approvalStatus_Approved);$(".label-default").text(Res.approvalStatus_InProgress);$(".label-warning").text(Res.approvalStatus_Cancelled);n.ApprovalStatus_Cancelled=Res.approvalStatus_Cancelled;$(".label-danger").text(Res.approvalStatus_Rejected);$(".cancel-request").text(Res.changeShiftManagement_CancelRequest)}function u(){n.RequestStatusApproved=Res.requestStatusApproved;n.RequestStatusCancelled=Res.requestStatusCancelled;n.RequestStatusRejected=Res.requestStatusRejected;n.ViewDetail=Res.viewDetail}function f(n){var f="<td>"+n.CurrentItem.Requester[0].lookupValue+"<\/td>",e="<td>"+n.CurrentItem.FromShift[0].lookupValue+"<\/td>",o="<td>"+n.CurrentItem.ToShift[0].lookupValue+"<\/td>",s="<td>"+n.CurrentItem.CommonFrom+"<\/td>",h="<td>"+n.CurrentItem.To+"<\/td>",c="<td>"+n.CurrentItem.Created+"<\/td>",l="<td>"+n.CurrentItem.Reason+"<\/td>",a="<td>"+n.CurrentItem.CommonComment+"<\/td>",r=n.CurrentItem.ApprovalStatus+"",t=window.location.href.split("#")[0],i;t=Functions.removeParam("lang",t);t+="#tab1";t=encodeURIComponent(t);var v='<span><a data-url="/Lists/ChangeShiftManagement/DispForm.aspx?ID='+n.CurrentItem.ID+"&TextOnly=true&Source="+t+'"   class="table-action viewdetailmyrequest"><i class="fa fa-eye" aria-hidden="true"><\/i><\/a><\/span>',y="<td>"+v+"<\/td>",u="<td><button type='button' class='btn btn-default btn-sm cancel-request' disabled  data-id='"+n.CurrentItem.ID+"'>Cancel Request<\/button><\/td>";return r=r.toLowerCase(),i="",r=="approved"?i='<td><span class="label label-success">Approved<\/span><\/td>':r=="cancelled"?i='<td><span class="label label-warning">Cancelled<\/span><\/td>':r=="rejected"?i='<td><span class="label label-danger">Rejected<\/span><\/td>':(i='<td><span class="label label-default">In-Progress<\/span><\/td>',u="<td><button type='button' class='btn btn-default btn-sm cancel-request'  data-id='"+n.CurrentItem.ID+"'>Cancel Request<\/button><\/td>"),"<tr>"+f+e+o+s+h+c+l+a+i+y+u+"<\/tr>"}function e(n){return ViewUtilities.Paging.InstanceHtml(n)}function o(t){if(s(t),n.ApprovalStatus&&n.ApprovalStatus.toLowerCase()==="approved")alert(n.RequestStatusApproved),location.reload();else if(n.ApprovalStatus&&n.ApprovalStatus.toLowerCase()==="cancelled")alert(n.RequestStatusCancelled),location.reload();else if(n.ApprovalStatus&&n.ApprovalStatus.toLowerCase()==="rejected")alert(n.RequestStatusRejected),location.reload();else{var u=_spPageContextInfo.webServerRelativeUrl,f=window.location.protocol+"//"+window.location.host+u,i=new SP.ClientContext(f),r=i.get_web().get_lists().getByTitle(String(n.ChangeShiftManagement_ListTitle));i.load(r);this.oListItem=r.getItemById(t);oListItem.set_item("ApprovalStatus","Cancelled");oListItem.update();i.executeQueryAsync(Function.createDelegate(this,function(){location.reload()}),Function.createDelegate(this,function(){}))}}function s(t){var r=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('"+String(n.ChangeShiftManagement_ListTitle)+"')/items("+t+")",i=$.Deferred();return $.ajax({url:r,method:"GET",async:!1,headers:{Accept:"application/json; odata=verbose"},success:function(t){n.ApprovalStatus=t.d.ApprovalStatus;i.resolve(t.d)},error:function(){status="failed"}}),i.promise()}var n={ChangeShiftManagement_Requester:"Requester",ChangeShiftManagement_FromShift:"From Shift",ChangeShiftManagement_ToShift:"To Shift",ChangeShiftManagement_From:"From",ChangeShiftManagement_To:"To",ChangeShiftManagement_Created:"Created",Comment:"Comment",ChangeShiftManagement_Reason:"Reason",ApprovalStatus:"",RequestStatusApproved:"",RequestStatusCancelled:"",RequestStatusRejected:"",ChangeShiftManagement_ApprovalStatus:"Approval Status",ChangeShiftManagement_ListTitle:"Change Shift Management",ChangeShiftManagement_ViewTitle:"View",ApprovalStatus_Cancelled:"Cancelled",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Locale:"",ViewDetail:"View item detail"};(function(){var t={};t.Templates={};t.Templates.Item=f;t.OnPreRender=function(){$(".ms-menutoolbar").hide()};t.ListTemplateType=10011;t.BaseViewID=2;t.OnPostRender=i;t.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='requesterTH_csRequest'>"+n.ChangeShiftManagement_Requester+"<\/th><th id='fromshift_csRequest'>"+n.ChangeShiftManagement_FromShift+"<\/th><th id='toshift_csRequest'>"+n.ChangeShiftManagement_ToShift+"<\/th><th id='from_csRequest'>"+n.ChangeShiftManagement_From+"<\/th><th id='to_csRequest'>"+n.ChangeShiftManagement_To+"<\/th><th id='created_csRequest'>"+n.ChangeShiftManagement_Created+"<\/th><th id='reason_csRequest'>"+n.ChangeShiftManagement_Reason+"<\/th><th id='comment_csRequest'>"+n.Comment+"<\/th><th id='approvalStatus_csRequest'>"+n.ChangeShiftManagement_ApprovalStatus+"<\/th><th id='action_csRequest'>"+n.ChangeShiftManagement_ViewTitle+"<\/th><th><\/th><\/tr><\/thead><tbody>";t.Templates.Footer=e;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(t)})()}();var ChangeShiftApprovalTaskConfig={ChangeShiftManagement_Requester:"Requester",ChangeShiftManagement_FromShift:"FromShift",ChangeShiftManagement_ToShift:"ToShift",ChangeShiftManagement_From:"From",ChangeShiftManagement_To:"To",ChangeShiftManagement_Created:"Created",ChangeShiftManagement_Reason:"Reason",Comment:"Comment",ItemID:"",ApprovalStatus:"",IsManager:!1,ChangeShiftManagement_ViewTitle:"View",ApproveRequest:"//{0}/_vti_bin/Services/ChangeShiftManagement/ChangeShiftManagementService.svc/Approve",RejectRequest:"//{0}/_vti_bin/Services/ChangeShiftManagement/ChangeShiftManagementService.svc/Reject",ListResourceFileName:"RBVHStadaLists",PageResourceFileName:"RBVHStadaWebpages",Locale:"",ViewDetail:"View item detail"};(function(){var n={};n.Templates={};n.Templates.Item=CustomItem;n.OnPreRender=function(){$(".ms-menutoolbar").hide()};n.BaseViewID=3;n.ListTemplateType=10011;n.OnPostRender=PostRender;n.Templates.Header="<div class='col-md-12'><table class='table'><thead><tr><th id='requesterTH'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_Requester+"<\/th><th id='fromshift'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_FromShift+"<\/th><th id='toshift'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_ToShift+"<\/th><th id='from'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_From+"<\/th><th id='to'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_To+"<\/th><th id='created'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_Created+"<\/th><th id='reason'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_Reason+"<\/th><th id='actionTH'>"+ChangeShiftApprovalTaskConfig.ChangeShiftManagement_ViewTitle+"<\/th><th id='comment'>"+ChangeShiftApprovalTaskConfig.Comment+"<\/th><th><\/th><\/tr><\/thead><tbody>";n.Templates.Footer=pagingControl;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(n)})();