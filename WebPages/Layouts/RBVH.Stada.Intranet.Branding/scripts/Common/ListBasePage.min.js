RBVH.Stada.javascript.common.NamespaceManager.register("RBVH.Stada.WebPages.pages");RBVH.Stada.WebPages.pages.ListBasePage=function(n){this.Settings={Controls:{}};$.extend(!0,this.Settings,n);this.Initialize()};RBVH.Stada.WebPages.pages.ListBasePage.prototype={Initialize:function(){var n=this;$(document).ready(function(){SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){n.InitControls();n.RegisterEvents()})})},InitControls:function(){var n=this,t=n.Settings.Controls.ActivedTabSelector,i=$(t).val();n.ActivaTab(i);$(n.Settings.Controls.MonthControlSelector).datepicker({viewMode:"months",minViewMode:"months",format:"mm/yyyy",autoclose:!0})},RegisterEvents:function(){var n=this;RBVH.Stada.WebPages.Utilities.RegisterTabChangeEvent();$(n.Settings.Controls.MonthControlSelector).on("changeDate",function(t){var i=t.date.getMonth()+1,r=t.date.getYear()+1900;$(".datepicker").hide();n.RefreshPageForDeptAndMonthChanging(i,r)});$(n.Settings.Controls.DepartmentSelector).change(function(){var i=$(n.Settings.Controls.MonthControlSelector).val(),t=moment(i,"MM/YYYY").toDate(),r=t.getMonth()+1,u=t.getYear()+1900;n.RefreshPageForDeptAndMonthChanging(r,u)});$(".linkAddNewItem").on("click",function(){$(".se-pre-con").fadeIn(0)})},ActivaTab:function(n){$('.nav-tabs a[href="#'+n+'"]').tab("show")},RefreshPageForDeptAndMonthChanging:function(n,t){var r=this,s=r.Settings.Controls.TabParamName,u=r.Settings.Controls.DepartmentParamName,o=r.Settings.Controls.DepartmentSelector,f=r.Settings.Controls.MonthParamname,e=r.Settings.Controls.YearParamName,i=$URI(window.location.href);i.removeQuery(u);i.removeQuery(f);i.removeQuery(e);i.addQuery(u,$(o).val());i.addQuery(f,n);i.addQuery(e,t);window.location.href=i.toString()}};