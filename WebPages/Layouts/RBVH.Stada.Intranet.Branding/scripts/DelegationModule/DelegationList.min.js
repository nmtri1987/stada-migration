RBVH.Stada.javascript.common.NamespaceManager.register("RBVH.Stada.WebPages.pages");RBVH.Stada.WebPages.pages.DelegationList=function(n){this.Settings={Controls:{}};$.extend(!0,this.Settings,n);this.Initialize()};RBVH.Stada.WebPages.pages.DelegationList.prototype={Initialize:function(){var n=this;$(document).ready(function(){SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){n.InitControls();n.RegisterEvents()})})},InitControls:function(){var n=this,r=n.Settings.Controls.ActivedTabSelector,u=$(r).val(),t,i;n.ActivaTab(u);t=$("span[class='select-task-delete'] input[type='checkbox']:checked");t&&t.length>0&&$(n.Settings.Controls.linkDeleteDelegationSeletor).removeAttr("disabled");i=$("span[class='select-task-delete'] input[type='checkbox']:checked");i&&i.length>0&&$(n.Settings.Controls.linkDeleteNewDelegationSelector).removeAttr("disabled");$(n.Settings.Controls.txtDelegateFromDateSelector).datepicker({viewMode:"days",minViewMode:"days",format:"dd/mm/yyyy",autoclose:!0});$(n.Settings.Controls.txtDelegateToDateSelector).datepicker({viewMode:"days",minViewMode:"days",format:"dd/mm/yyyy",autoclose:!0});$(n.Settings.Controls.txtDelegateNewTaskFromDateSelector).datepicker({viewMode:"days",minViewMode:"days",format:"dd/mm/yyyy",autoclose:!0});$(n.Settings.Controls.txtDelegateNewTaskToDateSelector).datepicker({viewMode:"days",minViewMode:"days",format:"dd/mm/yyyy",autoclose:!0})},RegisterEvents:function(){var n=this;$('a[data-toggle="tab"]').on("shown.bs.tab",function(t){var r=$(t.target).attr("href"),i=n.Settings.Controls.ActivedTabSelector;$(i).val($(this).attr("aria-controls"))});$(n.Settings.Controls.linkAddNewDelegationSelector).on("click",function(){$(".se-pre-con").fadeIn(0)});$(n.Settings.Controls.linkAddNewDelegationOfNewTaskSelector).on("click",function(){$(".se-pre-con").fadeIn(0)});$(".linkEdit").on("click",function(){$(".se-pre-con").fadeIn(0)});n.DeleteCheckboxItemEvent("select-all-task-delete","select-task-delete",n.Settings.Controls.linkDeleteDelegationSeletor);n.DeleteCheckboxItemEvent("select-all-newtask-delete","select-newtask-delete",n.Settings.Controls.linkDeleteNewDelegationSelector)},ActivaTab:function(n){$('.nav-tabs a[href="#'+n+'"]').tab("show")},ConfirmDeleteDelegation:function(n){var r=this,u=$(n).attr("confirmation-message"),t=confirm(u),i;return t&&($(".se-pre-con").fadeIn(0),i=Sys.WebForms.PageRequestManager.getInstance(),i.add_endRequest(function(){$(".se-pre-con").fadeOut(0);document.title=r.Settings.Resources.PageTitle})),t},DeleteCheckboxItemEvent:function(n,t,i){var f=this,u=$("span[class='"+n+"'] input[type='checkbox']"),r=$("span[class='"+t+"'] input[type='checkbox']");u.change(function(){u.is(":checked")==!0?r.length>0&&(r.prop("checked",!0),$(i).removeAttr("disabled")):(r.removeAttr("checked"),$(i).attr("disabled","true"))});r.change(function(){var t;u.removeAttr("checked");var n=0,f=0,e=r.length;if(r)for(t=0;t<e;t++)$(r[t]).is(":checked")==!0?n++:f++;n>0&&n===e&&u.prop("checked",!0);f>0&&f===e&&u.removeAttr("checked");n>0?$(i).removeAttr("disabled"):$(i).attr("disabled","true")})},ConfirmDeleteDelegationItems:function(){var t=this,n=!1,i=$(t.Settings.Controls.linkDeleteDelegationSeletor).attr("disabled"),r;return i==""||i=="disabled"||i=="true"?n=!1:(r=$("span[class='select-task-delete'] input[type='checkbox']:checked"),r&&r.length!=0?(n=confirm(t.Settings.Resources.ConfirmDeleteItems),n==!0&&$(".se-pre-con").fadeIn(0)):alert(t.Settings.Resources.SelectAtLeastOneItem)),n},ConfirmDeleteNewDelegationItems:function(){var t=this,n=!1,i=$(t.Settings.Controls.linkDeleteNewDelegationSelector).attr("disabled"),r;return i==""||i=="disabled"||i=="true"?n=!1:(r=$("span[class='select-newtask-delete'] input[type='checkbox']:checked"),r&&r.length!=0?(n=confirm(t.Settings.Resources.ConfirmDeleteItems),n==!0&&$(".se-pre-con").fadeIn(0)):alert(t.Settings.Resources.SelectAtLeastOneItem)),n},ValidateFilter:function(n,t,i,r){var u,f,h,c;$(i).html("");var e=!0,l=this,o=$(n).val(),s=$(t).val();return o&&o!=""&&s&&s!=""&&(u=Functions.parseVietNameseDate(o),f=Functions.parseVietNameseDate(s),u&&f&&(h=new Date(u.getFullYear(),u.getMonth(),u.getDate()),c=new Date(f.getFullYear(),f.getMonth(),f.getDate()),h<=c?(e=!0,$(i).html("").hide()):(e=!1,$(i).html(r).show()))),e},ValidateFilterMyDelegation:function(){var n=this,t=n.ValidateFilter(n.Settings.Controls.txtDelegateFromDateSelector,n.Settings.Controls.txtDelegateToDateSelector,n.Settings.Controls.txtDelegateToDateSelector_Error,n.Settings.Resources.ToDateGreaterThanFromDate);return t==!0&&$(".se-pre-con").fadeIn(0),t},ValidateFilterNewTaskDelegation:function(){var n=this,t=n.ValidateFilter(n.Settings.Controls.txtDelegateNewTaskFromDateSelector,n.Settings.Controls.txtDelegateNewTaskToDateSelector,n.Settings.Controls.txtDelegateNewTaskFromDateSelector_Error,n.Settings.Resources.ToDateGreaterThanFromDate);return t==!0&&$(".se-pre-con").fadeIn(0),t}};